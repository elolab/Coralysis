[{"path":"https://elolab.github.io/Coralysis/articles/01_Integration.html","id":"dataset","dir":"Articles","previous_headings":"","what":"Dataset","title":"Integration","text":"illustrate multi-level integration algorithm, use vignette two 10X PBMCs (Peripheral Blood Mononuclear Cells) 3’ assays: V1 V2. datasets downloaded 10X website. PBMC dataset V1 corresponds sample pbmc6k V2 pbmc8k: V1: pbmc6k V2: pbmc8k  Cells annotated using annotations provided Korsunsky et al., 2019 (Source Data Figure 4 file). overall data downsampled 2K cells (1K per assay) 2K highly variable genes selected scran R package. facilitate reproduction vignette, data distributed Zenodo SingleCellExperiment object, object (class) required functions Coralysis (see Chapter 4 SingleCellExperiment class - OSCA manual). SCE object provided comprises counts (raw count data), logcounts (log-normalized data) cell colData (includes batch cell labels, designated batch cell_type, respectively). Run code import R packages data required reproduce vignette.","code":"# Packages library(\"ggplot2\") library(\"Coralysis\") library(\"SingleCellExperiment\") # Import data from Zenodo data.url <- \"https://zenodo.org/records/14845751/files/pbmc_10Xassays.rds?download=1\" pbmc_10Xassays <- readRDS(file = url(data.url))"},{"path":"https://elolab.github.io/Coralysis/articles/01_Integration.html","id":"dimred-pre-integration","dir":"Articles","previous_headings":"","what":"DimRed: pre-integration","title":"Integration","text":"batch effect assays can inspected projecting data onto t-distributed Stochastic Neighbor Embedding (t-SNE). can achieved running sequentially Coralysis functions RunPCA RunTSNE. Provide seed running one functions ensure reproducibility. function RunPCA runs default PCA method implemented R package irlba (pca.method=\"irlba\"), requires seed ensure PCA result. addition, assay.name argument needs provided, otherwise uses default probabilities obtained integration (running RunParallelDivisiveICP). assay logcounts, corresponding log-normalized data, number principal components use p provided. case, data previously normalized, normalized using methods available Bioconductor (see Chapter 7 Normalization - OSCA manual). categorical variable available colData(pbmc_10Xassays), batch cell_type, can visualized low dimensional embedding stored reducedDimNames(pbmc_10Xassays) Coralysis function PlotDimRed.","code":"# Compute PCA & TSNE set.seed(123) pbmc_10Xassays <- RunPCA(object = pbmc_10Xassays,                           assay.name = \"logcounts\",                           p = 30, dimred.name = \"unintPCA\") set.seed(123) pbmc_10Xassays <- RunTSNE(pbmc_10Xassays,                            dimred.type = \"unintPCA\",                            dimred.name = \"unintTSNE\")  # Plot TSNE highlighting the batch & cell type unint.batch.plot <- PlotDimRed(object = pbmc_10Xassays,                                 color.by = \"batch\",                                 dimred = \"unintTSNE\",                                point.size = 0.01,                                 legend.nrow = 1,                                 seed.color = 1024) unint.cell.plot <- PlotDimRed(object = pbmc_10Xassays,                                color.by = \"cell_type\",                                dimred = \"unintTSNE\",                                point.size = 0.01,                                legend.nrow = 5,                                seed.color = 7) cowplot::plot_grid(unint.batch.plot, unint.cell.plot, ncol = 2, align = \"vh\")"},{"path":"https://elolab.github.io/Coralysis/articles/01_Integration.html","id":"multi-level-integration","dir":"Articles","previous_headings":"","what":"Multi-level integration","title":"Integration","text":"Integrate assays multi-level integration algorithm implemented Coralysis running function RunParallelDivisiveICP. arguments required function object batch.label. object requires SingleCellExperiment object assay logcounts. matrix logcounts sparse, .e., (logcounts(pbmc_10Xassays), \"dgCMatrix\") TRUE, contain non-expressing genes. ensured running PrepareData . batch.label argument requires label column name colData(pbmc_10Xassays) corresponding batch label used integration. absence batch, function, RunParallelDivisiveICP, can run without providing batch.label (.e., batch.label = NULL), case data modeled algorithm identify fine-grained populations required batch correction. higher number threads can provided speed computing time depending number cores available. example, algorithm run 10 times (L = 10), generally, number higher (default L = 50).","code":"# Prepare data for integration:  #remove non-expressing genes & logcounts is from `dgCMatrix` class pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) ## Data in `logcounts` slot already of `dgCMatrix` class... ## 2000/2000 features remain after filtering features with only zero values. # Perform integration with Coralysis set.seed(1024) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays,                                           batch.label = \"batch\",                                           L = 10, threads = 2) ##  ## Building training set... ## Training set successfully built. ##  ## Computing cluster seed. ##  ## Initializing divisive ICP clustering... ##   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%  |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%  |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100% ##  ## Divisive ICP clustering completed successfully. ##  ## Predicting cell cluster probabilities using ICP models... ## Prediction of cell cluster probabilities completed successfully. ##  ## Multi-level integration completed successfully."},{"path":"https://elolab.github.io/Coralysis/articles/01_Integration.html","id":"dimred-post-integration","dir":"Articles","previous_headings":"","what":"DimRed: post-integration","title":"Integration","text":"integration result can visually inspected running sequentially functions RunPCA RunTSNE. assay.name provided RunPCA must joint.probability (default), primary output integration Coralysis. probability matrices Coralysis (.e., joint.probability) can used obtain integrated embedding running RunPCA(..., assay.name = \"joint.probability\"). integrated PCA can, turn, used downstream clustering non-linear dimensional reduction techniques, RunTSNE. , integrated PCA named intPCA.","code":"# Compute PCA with joint cluster probabilities & TSNE set.seed(123) pbmc_10Xassays <- RunPCA(pbmc_10Xassays,                           assay.name = \"joint.probability\",                           dimred.name = \"intPCA\") ## Divisive ICP: selecting ICP tables multiple of 4 set.seed(123) pbmc_10Xassays <- RunTSNE(pbmc_10Xassays,                            dimred.type = \"intPCA\",                            dimred.name = \"intTSNE\")  # Plot TSNE highlighting the batch & cell type int.batch.plot <- PlotDimRed(object = pbmc_10Xassays,                               color.by = \"batch\",                               dimred = \"intTSNE\",                               point.size = 0.01,                               legend.nrow = 1,                               seed.color = 1024) int.cell.plot <- PlotDimRed(object = pbmc_10Xassays,                              color.by = \"cell_type\",                              dimred = \"intTSNE\",                              point.size = 0.01,                              legend.nrow = 5,                              seed.color = 7) cowplot::plot_grid(int.batch.plot, int.cell.plot,                     ncol = 2, align = \"vh\")"},{"path":"https://elolab.github.io/Coralysis/articles/01_Integration.html","id":"clustering","dir":"Articles","previous_headings":"","what":"Clustering","title":"Integration","text":"Run graph-based clustering scran function clusterCells (see Chapter 5 Clustering - OSCA manual).","code":"# Graph-based clustering on the integrated PCA w/ 'scran' package blusparams <- bluster::SNNGraphParam(k = 15, cluster.fun = \"louvain\") set.seed(123) pbmc_10Xassays$cluster <- scran::clusterCells(pbmc_10Xassays,                                                use.dimred = \"intPCA\",                                                BLUSPARAM = blusparams)  # Plot clustering clt.plot <- PlotDimRed(object = pbmc_10Xassays,                         color.by = \"cluster\",                         dimred = \"intTSNE\",                         point.size = 0.01,                         legend.nrow = 3,                         seed.color = 65) cowplot::plot_grid(int.batch.plot, int.cell.plot,                     clt.plot, ncol = 3, align = \"h\")"},{"path":"https://elolab.github.io/Coralysis/articles/01_Integration.html","id":"cluster-markers","dir":"Articles","previous_headings":"","what":"Cluster markers","title":"Integration","text":"Identify cluster markers running Coralysis function FindAllClusterMarkers. Provide clustering.label, case, label used , .e., cluster. top three positive markers per cluster retrieved plotted using Coralysis function HeatmapFeatures.","code":"# Cluster markers  cluster.markers <- FindAllClusterMarkers(object = pbmc_10Xassays, clustering.label = \"cluster\") ## ----------------------------------- ## testing cluster 1 ## 1128 features left after min.pct filtering ## 1128 features left after min.diff.pct filtering ## 215 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 2 ## 1203 features left after min.pct filtering ## 1203 features left after min.diff.pct filtering ## 287 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 3 ## 1167 features left after min.pct filtering ## 1167 features left after min.diff.pct filtering ## 427 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 4 ## 1171 features left after min.pct filtering ## 1171 features left after min.diff.pct filtering ## 443 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 5 ## 1194 features left after min.pct filtering ## 1194 features left after min.diff.pct filtering ## 283 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 6 ## 1130 features left after min.pct filtering ## 1130 features left after min.diff.pct filtering ## 289 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 7 ## 1199 features left after min.pct filtering ## 1199 features left after min.diff.pct filtering ## 189 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 8 ## 1154 features left after min.pct filtering ## 1154 features left after min.diff.pct filtering ## 392 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 9 ## 1239 features left after min.pct filtering ## 1239 features left after min.diff.pct filtering ## 363 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 10 ## 1473 features left after min.pct filtering ## 1473 features left after min.diff.pct filtering ## 359 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 11 ## 1138 features left after min.pct filtering ## 1138 features left after min.diff.pct filtering ## 280 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 12 ## 1208 features left after min.pct filtering ## 1208 features left after min.diff.pct filtering ## 344 features left after log2fc.threshold filtering ## ----------------------------------- # Select the top 3 positive markers per cluster  top3.markers <- lapply(X = split(x = cluster.markers, f = cluster.markers$cluster), FUN = function(x) {     head(x[order(x$log2FC, decreasing = TRUE),], n = 3) }) top3.markers <- do.call(rbind, top3.markers) top3.markers <- top3.markers[order(as.numeric(top3.markers$cluster)),]  # Heatmap of the top 3 positive markers per cluster HeatmapFeatures(object = pbmc_10Xassays,                  clustering.label = \"cluster\",                  features = top3.markers$marker,                  seed.color = 65)"},{"path":"https://elolab.github.io/Coralysis/articles/01_Integration.html","id":"dge","dir":"Articles","previous_headings":"","what":"DGE","title":"Integration","text":"Coralysis able separate CD8 effector T cells two clusters: 6 11. differential gene expression (DGE) analysis , clear cluster 11 cytotoxic similar NK cells (expressing GZMH GZMB) cluster 6.","code":"# DGE analysis: cluster 6 vs 11 dge.clt6vs11 <- FindClusterMarkers(pbmc_10Xassays,                                     clustering.label = \"cluster\",                                     clusters.1 = \"6\",                                     clusters.2 = \"11\") ## testing cluster group.1 ## 997 features left after min.pct filtering ## 997 features left after min.diff.pct filtering ## 303 features left after log2fc.threshold filtering head(dge.clt6vs11[order(abs(dge.clt6vs11$log2FC), decreasing = TRUE),]) ##           p.value  adj.p.value    log2FC      pct.1     pct.2  diff.pct marker ## NKG7 3.395687e-65 6.791373e-62 -4.087289 0.11403509 1.0000000 0.8859649   NKG7 ## CCL5 2.349768e-63 4.699536e-60 -3.838459 0.12573099 1.0000000 0.8742690   CCL5 ## GZMH 9.265926e-86 1.853185e-82 -3.170614 0.01461988 1.0000000 0.9853801   GZMH ## CST7 1.986018e-69 3.972037e-66 -2.447930 0.04970760 0.9436620 0.8939544   CST7 ## GZMA 3.278546e-66 6.557091e-63 -2.417989 0.05263158 0.9154930 0.8628614   GZMA ## LTB  2.631790e-33 5.263580e-30  2.325730 0.96491228 0.2253521 0.7395602    LTB top6.degs <- head(dge.clt6vs11[order(abs(dge.clt6vs11$log2FC),                                       decreasing = TRUE),\"marker\"]) exp.plots <- lapply(X = top6.degs, FUN = function(x) {     PlotExpression(object = pbmc_10Xassays, color.by = x,                    scale.values = TRUE, point.size = 0.5, point.stroke = 0.5) }) cowplot::plot_grid(plotlist = exp.plots, align = \"vh\", ncol = 3)"},{"path":"https://elolab.github.io/Coralysis/articles/01_Integration.html","id":"r-session","dir":"Articles","previous_headings":"","what":"R session","title":"Integration","text":"","code":"# R session sessionInfo() ## R version 4.4.2 (2024-10-31) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.1 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] SingleCellExperiment_1.28.1 SummarizedExperiment_1.36.0 ##  [3] Biobase_2.66.0              GenomicRanges_1.58.0        ##  [5] GenomeInfoDb_1.42.3         IRanges_2.40.1              ##  [7] S4Vectors_0.44.0            BiocGenerics_0.52.0         ##  [9] MatrixGenerics_1.18.1       matrixStats_1.5.0           ## [11] Coralysis_1.0.0             ggplot2_3.5.1               ##  ## loaded via a namespace (and not attached): ##   [1] rlang_1.1.5              magrittr_2.0.3           flexclust_1.4-2          ##   [4] compiler_4.4.2           systemfonts_1.2.1        vctrs_0.6.5              ##   [7] reshape2_1.4.4           stringr_1.5.1            pkgconfig_2.0.3          ##  [10] crayon_1.5.3             fastmap_1.2.0            XVector_0.46.0           ##  [13] labeling_0.4.3           scuttle_1.16.0           rmarkdown_2.29           ##  [16] ggbeeswarm_0.7.2         UCSC.utils_1.2.0         ragg_1.3.3               ##  [19] xfun_0.50                modeltools_0.2-23        bluster_1.16.0           ##  [22] zlibbioc_1.52.0          cachem_1.1.0             beachmat_2.22.0          ##  [25] jsonlite_1.8.9           DelayedArray_0.32.0      BiocParallel_1.40.0      ##  [28] irlba_2.3.5.1            parallel_4.4.2           aricode_1.0.3            ##  [31] cluster_2.1.6            R6_2.5.1                 bslib_0.9.0              ##  [34] stringi_1.8.4            RColorBrewer_1.1-3       limma_3.62.2             ##  [37] jquerylib_0.1.4          Rcpp_1.0.14              iterators_1.0.14         ##  [40] knitr_1.49               snow_0.4-4               Matrix_1.7-1             ##  [43] igraph_2.1.4             tidyselect_1.2.1         abind_1.4-8              ##  [46] yaml_2.3.10              codetools_0.2-20         doRNG_1.8.6.1            ##  [49] lattice_0.22-6           tibble_3.2.1             plyr_1.8.9               ##  [52] withr_3.0.2              ggrastr_1.0.2            Rtsne_0.17               ##  [55] evaluate_1.0.3           desc_1.4.3               pillar_1.10.1            ##  [58] rngtools_1.5.2           foreach_1.5.2            generics_0.1.3           ##  [61] sparseMatrixStats_1.18.0 munsell_0.5.1            scales_1.3.0             ##  [64] class_7.3-22             glue_1.8.0               metapod_1.14.0           ##  [67] pheatmap_1.0.12          LiblineaR_2.10-24        tools_4.4.2              ##  [70] BiocNeighbors_2.0.1      ScaledMatrix_1.14.0      SparseM_1.84-2           ##  [73] RSpectra_0.16-2          locfit_1.5-9.11          RANN_2.6.2               ##  [76] fs_1.6.5                 scran_1.34.0             Cairo_1.6-2              ##  [79] cowplot_1.1.3            grid_4.4.2               edgeR_4.4.2              ##  [82] colorspace_2.1-1         GenomeInfoDbData_1.2.13  beeswarm_0.4.0           ##  [85] BiocSingular_1.22.0      vipor_0.4.7              cli_3.6.3                ##  [88] rsvd_1.0.5               textshaping_1.0.0        viridisLite_0.4.2        ##  [91] S4Arrays_1.6.0           dplyr_1.1.4              doSNOW_1.0.20            ##  [94] gtable_0.3.6             sass_0.4.9               digest_0.6.37            ##  [97] SparseArray_1.6.1        dqrng_0.4.1              farver_2.1.2             ## [100] htmltools_0.5.8.1        pkgdown_2.1.1            lifecycle_1.0.4          ## [103] httr_1.4.7               statmod_1.5.0"},{"path":"https://elolab.github.io/Coralysis/articles/01_Integration.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Integration","text":"Amezquita R, Lun , Becht E, Carey V, Carpp L, Geistlinger L, Marini F, Rue-Albrecht K, Risso D, Soneson C, Waldron L, Pages H, Smith M, Huber W, Morgan M, Gottardo R, Hicks S (2020). “Orchestrating single-cell analysis Bioconductor.” Nature Methods, 17, 137-145. https://www.nature.com/articles/s41592-019-0654-x. Lun ATL, McCarthy DJ, Marioni JC (2016). “step--step workflow low-level analysis single-cell RNA-seq data Bioconductor.” F1000Res., 5, 2122. doi:10.12688/f1000research.9501.2. Sousa , Smolander J, Junttila S, Elo L (2025). “Coralysis enables sensitive identification imbalanced cell types states single-cell data via multi-level integration.” bioRxiv. doi:10.1101/2025.02.07.637023 Wickham H (2016). “ggplot2: Elegant Graphics Data Analysis.” Springer-Verlag New York.","code":""},{"path":"https://elolab.github.io/Coralysis/articles/02_RefMap.html","id":"dataset","dir":"Articles","previous_headings":"","what":"Dataset","title":"Reference-mapping","text":"illustrate Coralysis reference-mapping method, use vignette two 10X PBMCs (Peripheral Blood Mononuclear Cells) 3’ assays: V1 V2. assay V2 reference V1 query, .e., dataset mapped reference. datasets downloaded 10X website. PBMC dataset V1 corresponds sample pbmc6k V2 pbmc8k: V1: pbmc6k V2: pbmc8k  Cells annotated using annotations provided Korsunsky et al., 2019 (Source Data Figure 4 file). overall data downsampled 2K cells (1K per assay) 2K highly variable genes selected scran R package. facilitate reproduction vignette, data distributed Zenodo SingleCellExperiment object, object (class) required functions Coralysis (see Chapter 4 SingleCellExperiment class - OSCA manual). SCE object provided comprises counts (raw count data), logcounts (log-normalized data) cell colData (includes batch cell labels, designated batch cell_type, respectively). Run code import R packages data required reproduce vignette.","code":"# Packages library(\"ggplot2\") library(\"Coralysis\") library(\"SingleCellExperiment\") # Import data from Zenodo data.url <- \"https://zenodo.org/records/14845751/files/pbmc_10Xassays.rds?download=1\" pbmc_10Xassays <- readRDS(file = url(data.url))  # Split the SCE object by assay  ref <- pbmc_10Xassays[,pbmc_10Xassays$batch==\"V2\"] # let V2 assay batch be the reference data set query <- pbmc_10Xassays[,pbmc_10Xassays$batch==\"V1\"] # let V1 be the query (unknown annotations)"},{"path":"https://elolab.github.io/Coralysis/articles/02_RefMap.html","id":"train-reference","dir":"Articles","previous_headings":"","what":"Train reference","title":"Reference-mapping","text":"first step performing reference mapping Coralysis training dataset representative biological system study. example, ref query correspond SingleCellExperiment objects reference query PBMC samples, V2 V1 3’ assays, respectively. reference ref trained RunParallelDivisiveICP function without providing batch.label. case reference requires integration, batch.label provided. higher number threads can provided speed computing time depending number cores available. example, algorithm run 10 times (L = 10), generally, number higher (default L = 50). Next, run function RunPCA obtain main result required cell type prediction later . addition cell type prediction, query dataset(s) can projected onto UMAP. allow , argument return.model set TRUE functions RunPCA RunUMAP. UMAP plot reference sample cell type annotations. example, using annotations provided object. Ideally, sample annotated training performing clustering manual cluster annotation. resulting manual cell type annotations used prediction. simplicity, use annotations provided object.","code":"# Train the reference  set.seed(123) ref <- RunParallelDivisiveICP(object = ref, L = 10, threads = 2) # runs without 'batch.label' ## WARNING: Setting 'divisive.method' to 'cluster' as 'batch.label=NULL'.  ## If 'batch.label=NULL', 'divisive.method' can be one of: 'cluster', 'random'. ##  ## Building training set... ## Training set successfully built. ##  ## Computing cluster seed. ##  ## Initializing divisive ICP clustering... ##   |                                                                              |                                                                      |   0%  |                                                                              |========                                                              |  11%  |                                                                              |================                                                      |  22%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================                                       |  44%  |                                                                              |=======================================                               |  56%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================                |  78%  |                                                                              |==============================================================        |  89%  |                                                                              |======================================================================| 100% ##  ## Divisive ICP clustering completed successfully. ##  ## Predicting cell cluster probabilities using ICP models... ## Prediction of cell cluster probabilities completed successfully. ##  ## Multi-level integration completed successfully. # Compute reference PCA ref <- RunPCA(ref, return.model = TRUE, pca.method = \"stats\") ## Divisive ICP: selecting ICP tables multiple of 4 # Compute reference UMAP set.seed(123) ref <- RunUMAP(ref, return.model = TRUE) # Vizualize reference ref.celltype.plot <- PlotDimRed(object = ref,                                  color.by = \"cell_type\",                                  dimred = \"UMAP\",                                  point.size = 0.01,                                  legend.nrow = 6,                                  seed.color = 7) +      ggtitle(\"reference (ground-truth)\") ref.celltype.plot"},{"path":"https://elolab.github.io/Coralysis/articles/02_RefMap.html","id":"map-query","dir":"Articles","previous_headings":"","what":"Map query","title":"Reference-mapping","text":"Perform reference-mapping Coralysis running function ReferenceMapping. requires provide trained reference (ref) cell type annotations intended prediction (ref.label = \"cell_type\") query dataset (query). label reference aimed used prediction needs available colData(ref). case, providing cell type labels column cell_type available reference ref. Since want project query onto reference UMAP, set project.umap TRUE. argument dimred.name.prefix just sets name given prefix low dimensional embeddings stored reducedDimNames(map). SingleCellExperiment object map contain information query, predictions embeddings mapped onto reference. predictions consist coral_labels coral_probability stored colData(map). coral_labels correspond cell type predictions obtained reference. coral_probability represents proportion K neighbors winning class (k.nn equal 10 default); higher value, better.","code":"## Reference-mapping set.seed(1024) map <- ReferenceMapping(ref = ref, query = query, ref.label = \"cell_type\",                          project.umap = TRUE, dimred.name.prefix = \"ref\")"},{"path":"https://elolab.github.io/Coralysis/articles/02_RefMap.html","id":"prediction-accuracy","dir":"Articles","previous_headings":"","what":"Prediction accuracy","title":"Reference-mapping","text":"accuracy Coralysis reference-mapping method presented together confusion matrix predicted (rows) versus ground-truth cell type labels (columns).","code":""},{"path":"https://elolab.github.io/Coralysis/articles/02_RefMap.html","id":"confusion-matrix","dir":"Articles","previous_headings":"Prediction accuracy","what":"Confusion matrix","title":"Reference-mapping","text":"accuracy Coralysis reference-mapping method 84.2%.","code":"# Confusion matrix preds_x_truth <- table(map$coral_labels, map$cell_type) stopifnot(all(row.names(preds_x_truth)==colnames(preds_x_truth)))  # Accuracy acc <- sum(diag(preds_x_truth)) / sum(preds_x_truth) #print(paste0(\"Prediction accuracy: \", acc*100, \"%\"))  # Print confusion matrix preds_x_truth ##                  ##                  aDC B mem B naive CD4 mem CD4 naive CD8 eff CD8 T HSC ##   aDC             14     0       0       0         0       0     0   0 ##   B mem            0    40      15       0         0       0     0   3 ##   B naive          0     4      69       0         0       0     0   0 ##   CD4 mem          0     0       0     108        39       3     6   0 ##   CD4 naive        0     0       0      14       153       0    12   2 ##   CD8 eff          0     1       0       2         0      93     2   0 ##   CD8 T            0     0       1       3         4      11    62   0 ##   HSC              0     0       0       0         0       0     0   0 ##   Megakaryocyte    0     0       0       0         0       0     0   0 ##   Monocyte         1     0       0       0         0       0     0   0 ##   CD16+ monocyte   0     0       0       0         0       0     0   0 ##   NK               0     0       0       0         0       1     0   0 ##   pDC              0     0       0       0         0       0     0   0 ##   Treg             0     0       0       1         0       0     0   0 ##                  ##                  Megakaryocyte Monocyte CD16+ monocyte  NK pDC Treg ##   aDC                        0        0              0   0   0    0 ##   B mem                      0        0              0   0   0    0 ##   B naive                    0        0              0   0   1    0 ##   CD4 mem                    0        0              0   0   0    8 ##   CD4 naive                  0        0              0   0   0    7 ##   CD8 eff                    1        0              0   1   0    0 ##   CD8 T                      1        0              0   0   0    0 ##   HSC                        0        0              0   0   0    0 ##   Megakaryocyte              0        0              0   0   0    0 ##   Monocyte                   3      173              4   1   0    0 ##   CD16+ monocyte             1        5             72   0   0    0 ##   NK                         0        0              0  55   0    0 ##   pDC                        0        0              0   0   3    0 ##   Treg                       0        0              0   0   0    0"},{"path":"https://elolab.github.io/Coralysis/articles/02_RefMap.html","id":"dimred","dir":"Articles","previous_headings":"Prediction accuracy","what":"DimRed","title":"Reference-mapping","text":"Visualize query cells projected onto reference UMAP well predictions match query ground-truth. coral_probability prediction confidence score. Predictions low scores (<0.5) carefully inspected.","code":"# Plot query and reference UMAP side-by-side  #with ground-truth & predicted cell labels use.color <- c(\"aDC\" = \"#E6F5C9\",                 \"B mem\" = \"#CCEBC5\",                 \"B naive\" = \"#FB8072\",                 \"CD4 mem\" = \"#A6761D\",                 \"CD4 naive\" = \"#666666\",                 \"CD8 eff\" = \"#80B1D3\",                \"CD8 T\" = \"#CBD5E8\",                 \"HSC\" = \"#E31A1C\",                 \"Megakaryocyte\" = \"#377EB8\",                 \"Monocyte\" = \"#FCCDE5\",                 \"CD16+ monocyte\" = \"#A6D854\",                 \"NK\" = \"#6A3D9A\",                \"pDC\" = \"#E7298A\",                 \"Treg\" = \"#FFFF33\") query.ground_truth.plot <- PlotDimRed(object = map,                                        color.by = \"cell_type\",                                        dimred = \"refUMAP\",                                        point.size = 0.01,                                        legend.nrow = 6,                                        seed.color = 7) +      ggtitle(\"query (ground-truth)\") query.predicted.plot <-PlotDimRed(object = map,                                    color.by = \"coral_labels\",                                    dimred = \"refUMAP\", point.size = 0.01,                                    legend.nrow = 6,                                    use.color = use.color) +      ggtitle(\"query (predicted)\") query.confidence.plot <- PlotExpression(object = map,                                          color.by = \"coral_probability\",                                          dimred = \"refUMAP\",                                          point.size = 0.01,                                          color.scale = \"viridis\") +      ggtitle(\"query (confidence)\") cowplot::plot_grid(ref.celltype.plot, query.ground_truth.plot,                     query.predicted.plot, query.confidence.plot,                     ncol = 2, align = \"vh\")"},{"path":"https://elolab.github.io/Coralysis/articles/02_RefMap.html","id":"r-session","dir":"Articles","previous_headings":"","what":"R session","title":"Reference-mapping","text":"","code":"# R session sessionInfo() ## R version 4.4.2 (2024-10-31) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.1 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] SingleCellExperiment_1.28.1 SummarizedExperiment_1.36.0 ##  [3] Biobase_2.66.0              GenomicRanges_1.58.0        ##  [5] GenomeInfoDb_1.42.3         IRanges_2.40.1              ##  [7] S4Vectors_0.44.0            BiocGenerics_0.52.0         ##  [9] MatrixGenerics_1.18.1       matrixStats_1.5.0           ## [11] Coralysis_1.0.0             ggplot2_3.5.1               ##  ## loaded via a namespace (and not attached): ##   [1] rlang_1.1.5              magrittr_2.0.3           flexclust_1.4-2          ##   [4] compiler_4.4.2           png_0.1-8                systemfonts_1.2.1        ##   [7] vctrs_0.6.5              reshape2_1.4.4           stringr_1.5.1            ##  [10] pkgconfig_2.0.3          crayon_1.5.3             fastmap_1.2.0            ##  [13] XVector_0.46.0           labeling_0.4.3           scuttle_1.16.0           ##  [16] rmarkdown_2.29           ggbeeswarm_0.7.2         UCSC.utils_1.2.0         ##  [19] ragg_1.3.3               xfun_0.50                modeltools_0.2-23        ##  [22] bluster_1.16.0           zlibbioc_1.52.0          cachem_1.1.0             ##  [25] beachmat_2.22.0          jsonlite_1.8.9           DelayedArray_0.32.0      ##  [28] BiocParallel_1.40.0      irlba_2.3.5.1            parallel_4.4.2           ##  [31] aricode_1.0.3            cluster_2.1.6            R6_2.5.1                 ##  [34] bslib_0.9.0              stringi_1.8.4            RColorBrewer_1.1-3       ##  [37] reticulate_1.40.0        limma_3.62.2             jquerylib_0.1.4          ##  [40] Rcpp_1.0.14              iterators_1.0.14         knitr_1.49               ##  [43] snow_0.4-4               Matrix_1.7-1             igraph_2.1.4             ##  [46] tidyselect_1.2.1         abind_1.4-8              yaml_2.3.10              ##  [49] codetools_0.2-20         doRNG_1.8.6.1            lattice_0.22-6           ##  [52] tibble_3.2.1             plyr_1.8.9               withr_3.0.2              ##  [55] askpass_1.2.1            ggrastr_1.0.2            evaluate_1.0.3           ##  [58] desc_1.4.3               pillar_1.10.1            rngtools_1.5.2           ##  [61] foreach_1.5.2            generics_0.1.3           sparseMatrixStats_1.18.0 ##  [64] munsell_0.5.1            scales_1.3.0             class_7.3-22             ##  [67] glue_1.8.0               metapod_1.14.0           pheatmap_1.0.12          ##  [70] LiblineaR_2.10-24        tools_4.4.2              BiocNeighbors_2.0.1      ##  [73] ScaledMatrix_1.14.0      SparseM_1.84-2           RSpectra_0.16-2          ##  [76] locfit_1.5-9.11          RANN_2.6.2               fs_1.6.5                 ##  [79] scran_1.34.0             Cairo_1.6-2              cowplot_1.1.3            ##  [82] grid_4.4.2               umap_0.2.10.0            edgeR_4.4.2              ##  [85] colorspace_2.1-1         GenomeInfoDbData_1.2.13  beeswarm_0.4.0           ##  [88] BiocSingular_1.22.0      vipor_0.4.7              cli_3.6.3                ##  [91] rsvd_1.0.5               textshaping_1.0.0        viridisLite_0.4.2        ##  [94] S4Arrays_1.6.0           dplyr_1.1.4              doSNOW_1.0.20            ##  [97] gtable_0.3.6             sass_0.4.9               digest_0.6.37            ## [100] SparseArray_1.6.1        dqrng_0.4.1              farver_2.1.2             ## [103] htmltools_0.5.8.1        pkgdown_2.1.1            lifecycle_1.0.4          ## [106] httr_1.4.7               statmod_1.5.0            openssl_2.3.2"},{"path":"https://elolab.github.io/Coralysis/articles/02_RefMap.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Reference-mapping","text":"Amezquita R, Lun , Becht E, Carey V, Carpp L, Geistlinger L, Marini F, Rue-Albrecht K, Risso D, Soneson C, Waldron L, Pages H, Smith M, Huber W, Morgan M, Gottardo R, Hicks S (2020). “Orchestrating single-cell analysis Bioconductor.” Nature Methods, 17, 137-145. https://www.nature.com/articles/s41592-019-0654-x. Sousa , Smolander J, Junttila S, Elo L (2025). “Coralysis enables sensitive identification imbalanced cell types states single-cell data via multi-level integration.” bioRxiv. doi:10.1101/2025.02.07.637023 Wickham H (2016). “ggplot2: Elegant Graphics Data Analysis.” Springer-Verlag New York.","code":""},{"path":"https://elolab.github.io/Coralysis/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"António Sousa. Maintainer, author. Johannes Smolander. Contributor, author. Sini Junttila. Author. Laura L Elo. Author.","code":""},{"path":"https://elolab.github.io/Coralysis/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sousa , Smolander J, Junttila S, Elo L (2025). “Coralysis enables sensitive identification imbalanced cell types states single-cell data via multi-level integration.” bioRxiv. doi:10.1101/2025.02.07.637023, R package version 1.0.0.","code":"@Article{,   author = {António G.G. Sousa and Johannes Smolander and Sini Junttila and Laura L. Elo},   title = {Coralysis enables sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration},   year = {2025},   doi = {10.1101/2025.02.07.637023},   publisher = {Cold Spring Harbor Laboratory},   journal = {bioRxiv},   note = {R package version 1.0.0}, }"},{"path":[]},{"path":"https://elolab.github.io/Coralysis/index.html","id":"coralysis-is-an-r-package-featuring-a-multi-level-integration-algorithm-for-sensitive-integration-reference-mapping-and-cell-state-identification-in-single-cell-data-described-in-the-paper-coralysis-enables-sensitive-identification-of-imbalanced-cell-types-and-states-in-single-cell-data-via-multi-level-integration","dir":"","previous_headings":"","what":"Coralysis is an R package featuring a multi-level integration algorithm for sensitive integration, reference-mapping, and cell state identification in single-cell data, described in the paper: Coralysis enables sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration.","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"Coralysis integration flowchart. () input heterogeneous scRNA-seq datasets overclustered batch wise training set modelled Iterative Clustering Projection (ICP) algorithm order predict cell cluster probabilities obtain integrated embedding. Adaptations original ICP algorithm (Smolander et al., 2021): (B) batch wise cluster assignment start, dependent cell distribution across Principal Component 1 (median cutoff); (C) training cells selected batch k nearest neighbours cell highest probability every batch per cluster; , (D) upon ICP clustering convergence, cluster divided two next clustering round, dependent batch wise cluster probability distribution (median cutoff). (E) Multi-level integration achieved multiple divisive clustering rounds, blending batch effect highlighting biological signal incrementally. Shapes represent cell types colours batches.","code":""},{"path":"https://elolab.github.io/Coralysis/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"latest version Coralysis can downloaded GitHub using devtools R package.","code":"devtools::install_github(\"elolab/Coralysis\")"},{"path":"https://elolab.github.io/Coralysis/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick-start","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"run Coralysis, follow instructions :","code":"# Packages library(\"SingleCellExperiment\") library(\"Coralysis\")  # Prepare data: checks 'logcounts' format & removes non-expressed genes pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays)  # Multi-level integration set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", threads = 4)   # Compute integrated PCA from joint probability set.seed(125) pbmc_10Xassays <- RunPCA(object = pbmc_10Xassays)  # Run UMAP set.seed(1204) pbmc_10Xassays <- RunUMAP(object = pbmc_10Xassays, umap.method = \"uwot\", n_neighbors = 20, min_dist = 0.3)  # Visualize integrated data  vars <- c(\"batch\", \"cell_type\") plots <- lapply(X = vars, FUN = function(x) {     PlotDimRed(object = pbmc_10Xassays, color.by = x, point.size = 0.5, point.stroke = 0.5, legend.nrow = 3) })  cowplot::plot_grid(plotlist = plots, ncol = 2, align = \"vh\") # join plots together"},{"path":"https://elolab.github.io/Coralysis/index.html","id":"contact-information","dir":"","previous_headings":"","what":"Contact information","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"questions related Coralysis, please contact us .","code":""},{"path":"https://elolab.github.io/Coralysis/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"Sousa , Smolander J, Junttila S, Elo L (2025). Coralysis enables sensitive identification imbalanced cell types states single-cell data via multi-level integration. bioRxiv. doi:10.1101/2025.02.07.637023","code":""},{"path":"https://elolab.github.io/Coralysis/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"Johannes Smolander, Sini Junttila, Mikko S Venäläinen, Laura L Elo. “ILoReg: tool high-resolution cell population identification single-cell RNA-seq data”. Bioinformatics, Volume 37, Issue 8, 15 April 2021, Pages 1107–1114, https://doi.org/10.1093/bioinformatics/btaa919.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/AggregateClusterExpression.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregates cell feature expression by clusters — AggregateClusterExpression","title":"Aggregates cell feature expression by clusters — AggregateClusterExpression","text":"function aggregates cell feature expression clusters provided.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/AggregateClusterExpression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregates cell feature expression by clusters — AggregateClusterExpression","text":"","code":"AggregateClusterExpression(mtx, cluster, select.features = NULL, fun = \"mean\")"},{"path":"https://elolab.github.io/Coralysis/reference/AggregateClusterExpression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregates cell feature expression by clusters — AggregateClusterExpression","text":"mtx Matrix features vs cells (rows vs cols) feature expression aggregate. cluster Cluster identities vector corresponding cells mtx. select.features features selected. default NULL, features used. fun Character specifying feature expression aggregated mean sum. default \"mean\".","code":""},{"path":"https://elolab.github.io/Coralysis/reference/AggregateClusterExpression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregates cell feature expression by clusters — AggregateClusterExpression","text":"Matrix feature expressed aggregated clusters.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/AggregateDataByBatch.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"function aggregates feature expression cell clusters, per batch provided.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/AggregateDataByBatch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"","code":"AggregateDataByBatch.SingleCellExperiment(object, batch.label, nhvg, p, ...)  # S4 method for class 'SingleCellExperiment' AggregateDataByBatch(object, batch.label, nhvg = 2000L, p = 30L, ...)"},{"path":"https://elolab.github.io/Coralysis/reference/AggregateDataByBatch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"object object SingleCellExperiment class. batch.label Cluster identities vector corresponding cells mtx. nhvg Integer number highly variable features select. default 2000. p Integer. default 30. ... Parameters passed ClusterCells() function.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/AggregateDataByBatch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"SingleCellExperiment object feature expression aggregated clusters.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/AggregateDataByBatch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"","code":"# Run with a batch set.seed(1204) sce <- AggregateDataByBatch(object = pbmc_10Xassays, batch.label = \"batch\") logcounts(sce)[1:10,1:10] #> Error in logcounts(sce): could not find function \"logcounts\" head(metadata(sce)$clusters) #> Error in metadata(sce): could not find function \"metadata\"  # Run without a batch set.seed(1204) sce <- AggregateDataByBatch(object = pbmc_10Xassays, batch.label = NULL) logcounts(sce)[1:10,1:10] #> Error in logcounts(sce): could not find function \"logcounts\" head(metadata(sce)$clusters) #> Error in metadata(sce): could not find function \"metadata\""},{"path":"https://elolab.github.io/Coralysis/reference/BinCellClusterProbability.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin cell cluster probability — BinCellClusterProbability","title":"Bin cell cluster probability — BinCellClusterProbability","text":"Bin cell cluster probability given cell label.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/BinCellClusterProbability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin cell cluster probability — BinCellClusterProbability","text":"","code":"BinCellClusterProbability.SingleCellExperiment(   object,   label,   icp.run,   icp.round,   funs,   bins,   aggregate.bins.by,   use.assay )  # S4 method for class 'SingleCellExperiment' BinCellClusterProbability(   object,   label,   icp.run = NULL,   icp.round = NULL,   funs = \"mean\",   bins = 20,   aggregate.bins.by = \"mean\",   use.assay = \"logcounts\" )"},{"path":"https://elolab.github.io/Coralysis/reference/BinCellClusterProbability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin cell cluster probability — BinCellClusterProbability","text":"object object SingleCellExperiment class ICP cell cluster probability tables saved metadata(object)$coralysis$joint.probability. running one RunParallelICP RunParallelDivisiveICP. label Label interest available colData(object) group bins cell cluster probability. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability. default NULL, .e., retrieved. Specify numeric vector retrieve specific set tables. icp.round ICP round(s) retrieve metadata(object)$coralysis$joint.probability. default NULL, .e., retrieved. relevant probabilities obtained function RunParallelDivisiveICP, .e., divisive ICP performed. Otherwise ignored internally assumed icp.round = 1, .e., one round. funs One function summarise ICP cell cluster probability. One \"mean\" \"median\". default \"mean\". bins Number bins bin cell cluster probability cell label given. default 20. aggregate.bins.One function aggregate One \"mean\" \"median\". default \"mean\". use.assay Name assay used obtain average expression features across cell label probability bins.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/BinCellClusterProbability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin cell cluster probability — BinCellClusterProbability","text":"SingleCellExperiment class object feature average expression cell label probability bins.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/BinCellClusterProbability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bin cell cluster probability — BinCellClusterProbability","text":"","code":"# Packages library(\"SingleCellExperiment\") #> Loading required package: SummarizedExperiment #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: ‘MatrixGenerics’ #> The following objects are masked from ‘package:matrixStats’: #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: ‘BiocGenerics’ #> The following objects are masked from ‘package:stats’: #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from ‘package:base’: #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append, #>     as.data.frame, basename, cbind, colnames, dirname, do.call, #>     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted, #>     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin, #>     pmin.int, rank, rbind, rownames, sapply, saveRDS, setdiff, table, #>     tapply, union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: ‘S4Vectors’ #> The following object is masked from ‘package:utils’: #>  #>     findMatches #> The following objects are masked from ‘package:base’: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #>  #> Attaching package: ‘Biobase’ #> The following object is masked from ‘package:MatrixGenerics’: #>  #>     rowMedians #> The following objects are masked from ‘package:matrixStats’: #>  #>     anyMissing, rowMedians  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1) #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Cell states SCE object for a given cell type annotation or clustering cellstate.sce <- BinCellClusterProbability(object = pbmc_10Xassays, label = \"cell_type\", icp.round = 4, bins = 20)  cellstate.sce #> class: SingleCellExperiment  #> dim: 2000 245  #> metadata(1): coralysis #> assays(1): logcounts #> rownames(2000): LYZ S100A9 ... IGSF8 KIR2DL1 #> rowData names(0): #> colnames(245): B mem_bin1 B mem_bin10 ... pDC_bin8 pDC_bin9 #> colData names(4): label probability_bins aggregated_probability_bins #>   aggregated_label_bins #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):"},{"path":"https://elolab.github.io/Coralysis/reference/CellBinsFeatureCorrelation.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell bins feature correlation — CellBinsFeatureCorrelation","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"Correlation cell bins given labels features.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/CellBinsFeatureCorrelation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"","code":"CellBinsFeatureCorrelation.SingleCellExperiment(object, labels, method)  # S4 method for class 'SingleCellExperiment' CellBinsFeatureCorrelation(object, labels = NULL, method = \"pearson\")"},{"path":"https://elolab.github.io/Coralysis/reference/CellBinsFeatureCorrelation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"object object SingleCellExperiment class obtained function BinCellClusterProbability(). labels Character label(s) label provided function BinCellClusterProbability(). default NULL, .e., labels used. method Character specifying correlation method use. One \"pearson\", \"kendall\" \"spearman\". default \"pearson\" used.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/CellBinsFeatureCorrelation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"data frame correlation coefficient feature (rows) across labels (columns).","code":""},{"path":"https://elolab.github.io/Coralysis/reference/CellBinsFeatureCorrelation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"","code":"# Packages library(\"SingleCellExperiment\")  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1) #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Cell states SCE object for a given cell type annotation or clustering cellstate.sce <- BinCellClusterProbability(object = pbmc_10Xassays, label = \"cell_type\", icp.round = 4, bins = 20)  cellstate.sce #> class: SingleCellExperiment  #> dim: 2000 245  #> metadata(1): coralysis #> assays(1): logcounts #> rownames(2000): LYZ S100A9 ... IGSF8 KIR2DL1 #> rowData names(0): #> colnames(245): B mem_bin1 B mem_bin10 ... pDC_bin8 pDC_bin9 #> colData names(4): label probability_bins aggregated_probability_bins #>   aggregated_label_bins #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):  # Pearson correlated features with \"Monocyte\" cor.features.mono <- CellBinsFeatureCorrelation(object = cellstate.sce, labels = \"Monocyte\")"},{"path":"https://elolab.github.io/Coralysis/reference/CellClusterProbabilityDistribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell cluster probability distribution — CellClusterProbabilityDistribution","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"Plot cell cluster probability distribution per label group.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/CellClusterProbabilityDistribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"","code":"CellClusterProbabilityDistribution.SingleCellExperiment(   object,   label,   group,   probability )  # S4 method for class 'SingleCellExperiment' CellClusterProbabilityDistribution(   object,   label,   group,   probability = \"scaled_mean_probs\" )"},{"path":"https://elolab.github.io/Coralysis/reference/CellClusterProbabilityDistribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"object object SingleCellExperiment class aggregated cell cluster probability available colData(object), can obtained running SummariseCellClusterProbability(). label Character specifying colData variable use cell type/cluster label. group Character specifying colData variable use categorical group variable. probability Character specifying aggregated cell cluster probability variable available colData, used plot distribution. One \"mean_probs\", \"scaled_mean_probs\", \"median_probs\", \"scaled_median_probs\". availability variables colData depends parameters given function SummariseCellClusterProbability() beforehand. default assumes \"scaled_mean_probs\" available colData, true SummariseCellClusterProbability() function run funs = \"mean\" scale.funs = TRUE.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/CellClusterProbabilityDistribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"plot class ggplot.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/CellClusterProbabilityDistribution.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"","code":"# Packages library(\"SingleCellExperiment\")  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1) #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Summarise cell cluster probability pbmc_10Xassays <- SummariseCellClusterProbability(object = pbmc_10Xassays, icp.round = 4) # save result in 'colData'  # Search for differences in probabilities across group(s)  # give an interesting variable to the \"group\" parameter instead \"batch\" - given for illustrative purposes only prob.dist <- CellClusterProbabilityDistribution(object = pbmc_10Xassays, label = \"cell_type\", group = \"batch\", probability = \"scaled_mean_probs\") prob.dist # print plot"},{"path":"https://elolab.github.io/Coralysis/reference/ClusterCells.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster cells — ClusterCells","title":"Cluster cells — ClusterCells","text":"function clusters cells K-means++ algorithm","code":""},{"path":"https://elolab.github.io/Coralysis/reference/ClusterCells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster cells — ClusterCells","text":"","code":"ClusterCells(object, nclusters = 500, use.emb = TRUE, emb.name = \"PCA\")"},{"path":"https://elolab.github.io/Coralysis/reference/ClusterCells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster cells — ClusterCells","text":"object object SingleCellExperiment class. nclusters Cluster cells n clusters. Ignored number cells object lower equal nclusters. use.emb embedding used cluster log-transformed data. default TRUE. emb.name embedding use. default \"PCA\".","code":""},{"path":"https://elolab.github.io/Coralysis/reference/ClusterCells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster cells — ClusterCells","text":"SingleCellExperiment object clusters.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/DownOverSampleEvenlyBatches.html","id":null,"dir":"Reference","previous_headings":"","what":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","title":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","text":"function - -samples cluster cells evenly batch.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/DownOverSampleEvenlyBatches.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","text":"","code":"DownOverSampleEvenlyBatches(x, batch, n = 50)"},{"path":"https://elolab.github.io/Coralysis/reference/DownOverSampleEvenlyBatches.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","text":"x character numeric vector data -oversample. batch character vector batch labels corresponding x. n many cells include per cluster.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/DownOverSampleEvenlyBatches.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","text":"list containing output LiblineaR prediction","code":""},{"path":"https://elolab.github.io/Coralysis/reference/DownOverSampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Down- and oversample data — DownOverSampling","title":"Down- and oversample data — DownOverSampling","text":"function implements script - oversamples data include n cells.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/DownOverSampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Down- and oversample data — DownOverSampling","text":"","code":"DownOverSampling(x, n = 50)"},{"path":"https://elolab.github.io/Coralysis/reference/DownOverSampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Down- and oversample data — DownOverSampling","text":"x character numeric vector data -oversample. n many cells include per cluster.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/DownOverSampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Down- and oversample data — DownOverSampling","text":"list containing output LiblineaR prediction","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindAllClusterMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of feature markers for all clusters — FindAllClusterMarkers","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"FindAllClusterMarkers enables identifying feature markers clusters . done differential expresission analysis cells one cluster compared cells rest clusters. Feature cell filters can applied accelerate analysis, might lead missing weak signals.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindAllClusterMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"","code":"FindAllClusterMarkers.SingleCellExperiment(   object,   clustering.label,   test,   log2fc.threshold,   min.pct,   min.diff.pct,   min.cells.group,   max.cells.per.cluster,   return.thresh,   only.pos )  # S4 method for class 'SingleCellExperiment' FindAllClusterMarkers(   object,   clustering.label,   test = \"wilcox\",   log2fc.threshold = 0.25,   min.pct = 0.1,   min.diff.pct = NULL,   min.cells.group = 3,   max.cells.per.cluster = NULL,   return.thresh = 0.01,   only.pos = FALSE )"},{"path":"https://elolab.github.io/Coralysis/reference/FindAllClusterMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"object SingleCellExperiment object. clustering.label variable name (class character) available cell metadata colData(object) clustering labels (character factor) use. test test use. \"wilcox\" (Wilcoxon rank-sum test, AKA Mann-Whitney U test) supported moment. log2fc.threshold Filters features log2 fold-change averaged feature expression values threshold. Default 0.25. min.pct Filters features dropout rate (fraction cells expressing feature) threshold comparison groups. Default 0.1. min.diff.pct Filters features minimum difference dropout rates (fraction cells expressing feature) two comparison groups. Default NULL. min.cells.group minimum number cells two comparison groups perform DE analysis. number cells threshold, DE analysis cluster skipped. Default 3. max.cells.per.cluster maximum number cells per cluster downsampling performed speed DE analysis. Default NULL, .e., downsampling. return.thresh .pos=TRUE, return features adjusted p-value (adjusted Bonferroni method) equal threshold. Default 0.01. .pos Whether return features adjusted p-value (adjusted Bonferroni method) equal threshold. Default FALSE.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindAllClusterMarkers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"data frame results positive results found, else NULL.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindAllClusterMarkers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Perform differential expression on a given clustering or cell type annotations ## Clustering # Perform clustering on the integrated PCA with your favorite algorithm, e.g., graph-based clustering with 'scran' #set .seed(123) #pbmc_10Xassays$cluster <- scran::clusterCells(pbmc_10Xassays, use.dimred=\"PCA\", BLUSPARAM = bluster::SNNGraphParam(k = 15, cluster.fun = \"louvain\")) #markers <- FindAllClusterMarkers(pbmc_10Xassays, clustering.label = \"cluster\")  ## Cell type annotations or other pre-existing annotations  markers <- FindAllClusterMarkers(pbmc_10Xassays, clustering.label = \"cell_type\") #> ----------------------------------- #> testing cluster aDC #> 1470 features left after min.pct filtering #> 1470 features left after min.diff.pct filtering #> 362 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster B mem #> 1302 features left after min.pct filtering #> 1302 features left after min.diff.pct filtering #> 266 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster B naive #> 1198 features left after min.pct filtering #> 1198 features left after min.diff.pct filtering #> 352 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD4 mem #> 1140 features left after min.pct filtering #> 1140 features left after min.diff.pct filtering #> 210 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD4 naive #> 1132 features left after min.pct filtering #> 1132 features left after min.diff.pct filtering #> 306 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD8 eff #> 1147 features left after min.pct filtering #> 1147 features left after min.diff.pct filtering #> 225 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD8 T #> 1185 features left after min.pct filtering #> 1185 features left after min.diff.pct filtering #> 270 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster HSC #> 1520 features left after min.pct filtering #> 1520 features left after min.diff.pct filtering #> 378 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster Megakaryocyte #> 1289 features left after min.pct filtering #> 1289 features left after min.diff.pct filtering #> 495 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster Monocyte #> 1191 features left after min.pct filtering #> 1191 features left after min.diff.pct filtering #> 482 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD16+ monocyte #> 1146 features left after min.pct filtering #> 1146 features left after min.diff.pct filtering #> 391 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster NK #> 1256 features left after min.pct filtering #> 1256 features left after min.diff.pct filtering #> 353 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster pDC #> 1442 features left after min.pct filtering #> 1442 features left after min.diff.pct filtering #> 498 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster Treg #> 1236 features left after min.pct filtering #> 1236 features left after min.diff.pct filtering #> 256 features left after log2fc.threshold filtering #> -----------------------------------"},{"path":"https://elolab.github.io/Coralysis/reference/FindBatchKNN.html","id":null,"dir":"Reference","previous_headings":"","what":"Find batch k nearest neighbors — FindBatchKNN","title":"Find batch k nearest neighbors — FindBatchKNN","text":"function finds batch k nearest neighbors cell highest probability every batch.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindBatchKNN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find batch k nearest neighbors — FindBatchKNN","text":"","code":"FindBatchKNN(idx, group, prob, k = 10)"},{"path":"https://elolab.github.io/Coralysis/reference/FindBatchKNN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find batch k nearest neighbors — FindBatchKNN","text":"idx numeric vector cell ids retrieve data set. group character vector batch labels corresponding idx. prob numeric vector cell probabilities corresponding idx. k number nearest neighbors search . Default 10.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindBatchKNN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find batch k nearest neighbors — FindBatchKNN","text":"list containing k nearest neighbors every cell queried","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindClusterBatchKNN.html","id":null,"dir":"Reference","previous_headings":"","what":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","title":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","text":"function finds batch k nearest neighbors cell highest probability every batch per cluster.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindClusterBatchKNN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","text":"","code":"FindClusterBatchKNN(preds, probs, batch, k = 10, k.prop = NULL)"},{"path":"https://elolab.github.io/Coralysis/reference/FindClusterBatchKNN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","text":"preds numeric vector cell cluster predictions. probs numeric matrix cell cluster probabilities. batch character batch labels. k number nearest neighbors search . Default 10. k.prop numeric (higher 0 lower 1) corresponding fraction cells per cluster use k nearest neighbors. Default NULL meaning number k nearest neighbors equal k. given, k parameter ignored k calculated based k.prop.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindClusterBatchKNN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","text":"list containing k nearest neighbors every cluster","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindClusterMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"Differential expression between cell clusters — FindClusterMarkers","title":"Differential expression between cell clusters — FindClusterMarkers","text":"FindClusterMarkers enables identifying feature markers one cluster two arbitrary combinations clusters, e.g. 1_2 vs. 3_4_5. Feature cell filters can applied accelerate analysis, might lead missing weak signals.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindClusterMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Differential expression between cell clusters — FindClusterMarkers","text":"","code":"FindClusterMarkers.SingleCellExperiment(   object,   clustering.label,   clusters.1,   clusters.2,   test,   log2fc.threshold,   min.pct,   min.diff.pct,   min.cells.group,   max.cells.per.cluster,   return.thresh,   only.pos )  # S4 method for class 'SingleCellExperiment' FindClusterMarkers(   object,   clustering.label,   clusters.1 = NULL,   clusters.2 = NULL,   test = \"wilcox\",   log2fc.threshold = 0.25,   min.pct = 0.1,   min.diff.pct = NULL,   min.cells.group = 3,   max.cells.per.cluster = NULL,   return.thresh = 0.01,   only.pos = FALSE )"},{"path":"https://elolab.github.io/Coralysis/reference/FindClusterMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Differential expression between cell clusters — FindClusterMarkers","text":"object SingleCellExperiment object. #' @param clustering.label variable name (class character) available cell metadata colData(object) clustering labels (character factor) use. clusters.1 character numeric vector denoting clusters use first group (named group.1 results) clusters.2 character numeric vector denoting clusters use second group (named group.2 results) test test use. \"wilcoxon\" (Wilcoxon rank-sum test, AKA Mann-Whitney U test) supported moment. log2fc.threshold Filters features log2 fold-change averaged feature expression values threshold. Default 0.25. min.pct Filters features dropout rate (fraction cells expressing feature) threshold comparison groups Default 0.1. min.diff.pct Filters features minimum difference dropout rates (fraction cells expressing feature) two comparison groups. Default NULL. min.cells.group minimum number cells two comparison groups perform DE analysis. number cells threshold, DE analysis performed. Default 3. max.cells.per.cluster maximun number cells per cluster downsampling performed speed DE analysis. Default NULL, .e. downsampling. return.thresh .pos=TRUE, return features adjusted p-value (adjusted Bonferroni method) equal threshold.  Default 0.01. .pos Whether return features adjusted p-value (adjusted Bonferroni method) equal threshold. Default FALSE.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindClusterMarkers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Differential expression between cell clusters — FindClusterMarkers","text":"data frame results positive results found, else NULL","code":""},{"path":"https://elolab.github.io/Coralysis/reference/FindClusterMarkers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Differential expression between cell clusters — FindClusterMarkers","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Perform differential expression on a given clustering or cell type annotations ## Clustering # Perform clustering on the integrated PCA with your favorite algorithm, e.g., graph-based clustering with 'scran' #set .seed(123) #pbmc_10Xassays$cluster <- scran::clusterCells(pbmc_10Xassays, use.dimred=\"PCA\", BLUSPARAM = bluster::SNNGraphParam(k = 15, cluster.fun = \"louvain\")) #cluster_markers_1 <- FindClusterMarkers(pbmc_10Xassays, clustering.label = \"cluster\", clusters.1 = \"1\")  #cluster_markers_1_vs_2 <- FindClusterMarkers(pbmc_10Xassays, clustering.label = \"cluster\", clusters.1 = \"1\", clusters.1 = \"2\")   ## Cell type annotations or other pre-existing annotations   gene_markers_Bmem <- FindClusterMarkers(pbmc_10Xassays, clustering.label = \"cell_type\", clusters.1 = \"B mem\") #> testing cluster group.1 #> 1302 features left after min.pct filtering #> 1302 features left after min.diff.pct filtering #> 266 features left after log2fc.threshold filtering gene_markers_Bmem_vs_Bnaive <- FindClusterMarkers(pbmc_10Xassays, clustering.label = \"cell_type\", clusters.1 = \"B mem\", clusters.2 = \"B naive\")  #> testing cluster group.1 #> 1151 features left after min.pct filtering #> 1151 features left after min.diff.pct filtering #> 103 features left after log2fc.threshold filtering"},{"path":"https://elolab.github.io/Coralysis/reference/GetCellClusterProbability.html","id":null,"dir":"Reference","previous_headings":"","what":"Get ICP cell cluster probability — GetCellClusterProbability","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"Get ICP cell cluster probability table(s)","code":""},{"path":"https://elolab.github.io/Coralysis/reference/GetCellClusterProbability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"","code":"GetCellClusterProbability.SingleCellExperiment(   object,   icp.run,   icp.round,   concatenate )  # S4 method for class 'SingleCellExperiment' GetCellClusterProbability(   object,   icp.run = NULL,   icp.round = NULL,   concatenate = TRUE )"},{"path":"https://elolab.github.io/Coralysis/reference/GetCellClusterProbability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"object object SingleCellExperiment class ICP cell cluster probability tables saved metadata(object)$coralysis$joint.probability. running RunParallelDivisiveICP. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability. default NULL, .e., retrieved. Specify numeric vector retrieve specific set tables. icp.round ICP round(s) retrieve metadata(object)$coralysis$joint.probability. default NULL, .e., retrieved. concatenate Concatenate list ICP cell cluster probability tables retrieved. default TRUE, .e., list ICP cell cluster probability tables concatenated.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/GetCellClusterProbability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"list ICP cell cluster probability tables matrix concatenated tables.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/GetCellClusterProbability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"","code":"#' # Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Get cluster probability for all ICP runs for the last 4th round  probs <- GetCellClusterProbability(object = pbmc_10Xassays, icp.round = 4, concatenate = TRUE) # matrix 2,000 cells x 56 cell clusters"},{"path":"https://elolab.github.io/Coralysis/reference/GetFeatureCoefficients.html","id":null,"dir":"Reference","previous_headings":"","what":"Get feature coefficients — GetFeatureCoefficients","title":"Get feature coefficients — GetFeatureCoefficients","text":"Get feature coefficients ICP models.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/GetFeatureCoefficients.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get feature coefficients — GetFeatureCoefficients","text":"","code":"GetFeatureCoefficients.SingleCellExperiment(   object,   icp.run = NULL,   icp.round = NULL )  # S4 method for class 'SingleCellExperiment' GetFeatureCoefficients(object, icp.run = NULL, icp.round = NULL)"},{"path":"https://elolab.github.io/Coralysis/reference/GetFeatureCoefficients.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get feature coefficients — GetFeatureCoefficients","text":"object object SingleCellExperiment class ICP cell cluster probability tables saved metadata(object)$coralysis$joint.probability. running RunParallelDivisiveICP. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability. default NULL, .e., retrieved. Specify numeric vector retrieve specific set tables. icp.round ICP round(s) retrieve metadata(object)$coralysis$joint.probability. default NULL, .e., retrieved.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/GetFeatureCoefficients.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get feature coefficients — GetFeatureCoefficients","text":"list feature coefficient weights per cluster per ICP run/round.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/GetFeatureCoefficients.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get feature coefficients — GetFeatureCoefficients","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # GetFeatureCoefficients gene_coefficients_icp_2_4 <- GetFeatureCoefficients(object = pbmc_10Xassays, icp.run = 2, icp.round = 4) #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result head(gene_coefficients_icp_2_4$icp_8) #>   feature   coeff_clt1  coeff_clt2 coeff_clt3  coeff_clt4  coeff_clt5 #> 1    ACTB -0.004184851 -0.06293994          0 -0.06956605  0.00000000 #> 2   ACTG1  0.000000000  0.00000000          0 -0.24787687 -0.01334432 #> 3     AES  0.000000000  0.00000000          0  0.00000000  0.00000000 #> 4    AIF1  0.000000000  0.00000000          0  0.00000000  0.00000000 #> 5   ANXA1  0.000000000  0.00000000          0  0.00000000  0.01184417 #> 6   ANXA2  0.000000000  0.00000000          0  0.00000000  0.00000000 #>    coeff_clt6  coeff_clt7   coeff_clt8  coeff_clt9 coeff_clt10 coeff_clt11 #> 1 -0.06963084 -0.02897566  0.000000000 -0.02435799           0 -0.13570917 #> 2  0.00000000  0.00000000 -0.002275189  0.00000000           0 -0.02901604 #> 3  0.00000000  0.00000000  0.000000000  0.00000000           0  0.00000000 #> 4  0.00000000  0.00000000  0.109828517  0.00000000           0  0.00000000 #> 5 -0.03669285  0.00000000  0.000000000  0.00000000           0  0.00000000 #> 6 -0.01498772  0.00000000  0.000000000  0.00000000           0  0.00000000 #>   coeff_clt12 coeff_clt13 coeff_clt14 coeff_clt15 coeff_clt16 #> 1           0 -0.02006254  0.00000000  -0.2122190  0.00000000 #> 2           0  0.00000000  0.00000000   0.0000000  0.00000000 #> 3           0  0.00000000  0.00000000   0.3221343 -0.09116642 #> 4           0  0.00000000  0.00000000  -0.3816792  0.00000000 #> 5           0 -0.13381680  0.08291472   0.0000000  0.00000000 #> 6           0 -0.14173409  0.00000000   0.0000000  0.00000000"},{"path":"https://elolab.github.io/Coralysis/reference/HeatmapFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"HeatmapFeatures function draws heatmap features cluster identity.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/HeatmapFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"","code":"HeatmapFeatures.SingleCellExperiment(   object,   clustering.label,   features,   use.color,   seed.color,   ... )  # S4 method for class 'SingleCellExperiment' HeatmapFeatures(   object,   clustering.label,   features,   use.color = NULL,   seed.color = 123,   ... )"},{"path":"https://elolab.github.io/Coralysis/reference/HeatmapFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"object SingleCellExperiment class clustering.label variable name (class character) available cell metadata colData(object) clustering labels (character factor) use. features Feature names plot cluster (character) matching row.names(object). use.color Character specifying colors clusters. default NULL, .e., colors randomly chosen based seed given seed.color. overwritten case argument annotation_colors provided. seed.color Seed randomly select colors clusters. default 123. overwritten case argument annotation_colors provided. ... Parameters pass pheatmap::pheatmap function.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/HeatmapFeatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"nothing","code":""},{"path":"https://elolab.github.io/Coralysis/reference/HeatmapFeatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Plot features by cell type (give a clustering instead) genes <- c(\"CD8A\", \"CCR7\", \"GZMA\", \"MS4A1\", \"CD27\") HeatmapFeatures(object = pbmc_10Xassays, clustering.label = \"cell_type\", features = genes) # log-normalized  HeatmapFeatures(object = pbmc_10Xassays, clustering.label = \"cell_type\", features = genes, scale = \"row\") # scale genes"},{"path":"https://elolab.github.io/Coralysis/reference/LogisticRegression.html","id":null,"dir":"Reference","previous_headings":"","what":"Clustering projection using logistic regression from the LiblineaR R package — LogisticRegression","title":"Clustering projection using logistic regression from the LiblineaR R package — LogisticRegression","text":"function implements script downsamples data dataset, trains logistic regression classifier model projects clustering onto using trained L1-regularized logistic regression model.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/LogisticRegression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clustering projection using logistic regression from the LiblineaR R package — LogisticRegression","text":"","code":"LogisticRegression(   training.sparse.matrix = NULL,   training.ident = NULL,   C = 0.3,   reg.type = \"L1\",   test.sparse.matrix = NULL,   d = 0.3,   batch.label = NULL,   training_ident_subset = NULL )"},{"path":"https://elolab.github.io/Coralysis/reference/LogisticRegression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clustering projection using logistic regression from the LiblineaR R package — LogisticRegression","text":"training.sparse.matrix sparse matrix (dgCMatrix) containing training sample's feature expression data features rows cells columns. Default NULL. training.ident named factor containing sample's cluster labels cell training.sparse.matrix. Default NULL. C Cost constraints violation L1-regularized logistic regression (C). Default 0.3. reg.type \"L1\" LASSO \"L2\" Ridge. Default \"L1\". test.sparse.matrix sparse matrix (dgCMatrix) containing test sample's feature expression data features rows cells columns. Default NULL. d numeric smaller 1 greater 0 determines many cells per cluster - oversampled (d N/k*d), N total number cells k number clusters. Default 0.3. batch.label character vector batch labels corresponding cells given training.ident. character batch labels need named cells names given training.ident. default NULL, .e., cells sampled evenly regardless batch. training_ident_subset character numeric vector cell ids use train set. default NULL. given, - oversampled parameters ignored.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/LogisticRegression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clustering projection using logistic regression from the LiblineaR R package — LogisticRegression","text":"list containing output LiblineaR prediction","code":""},{"path":"https://elolab.github.io/Coralysis/reference/MajorityVotingFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Majority voting features by label — MajorityVotingFeatures","title":"Majority voting features by label — MajorityVotingFeatures","text":"Get ICP feature coefficients label interest majority voting label across ICP clusters.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/MajorityVotingFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Majority voting features by label — MajorityVotingFeatures","text":"","code":"MajorityVotingFeatures.SingleCellExperiment(object, label)  # S4 method for class 'SingleCellExperiment' MajorityVotingFeatures(object, label)"},{"path":"https://elolab.github.io/Coralysis/reference/MajorityVotingFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Majority voting features by label — MajorityVotingFeatures","text":"object object SingleCellExperiment class ICP cell cluster probability tables saved metadata(object)$coralysis$joint.probability. running RunParallelDivisiveICP. label Label interest available colData(object).","code":""},{"path":"https://elolab.github.io/Coralysis/reference/MajorityVotingFeatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Majority voting features by label — MajorityVotingFeatures","text":"list list data frames feature weights per label data frame summary label.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/MajorityVotingFeatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Majority voting features by label — MajorityVotingFeatures","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Get gene coefficients by majority voting for a given clustering or cell type annotations gene_coeff <- MajorityVotingFeatures(object = pbmc_10Xassays, label = \"cell_type\") #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result gene_coeff$summary #>             label icp_run icp_round cluster     score #> 1             aDC       4         4       5 0.5515528 #> 2           B mem       3         4       2 0.7636311 #> 3         B naive       3         4       4 0.9017341 #> 4         CD4 mem       4         4      16 0.7577793 #> 5       CD4 naive       1         3       8 0.7098450 #> 6         CD8 eff       4         3       5 0.7750024 #> 7           CD8 T       1         4      12 0.7892398 #> 8             HSC       1         4       2 0.6123724 #> 9   Megakaryocyte       4         4      13 0.2500000 #> 10       Monocyte       1         4       5 0.9560361 #> 11 CD16+ monocyte       3         4       5 0.9427315 #> 12             NK       1         4      10 0.8581919 #> 13            pDC       4         3       1 0.7698004 #> 14           Treg       1         3       8 0.2059631 head(gene_coeff$feature_coeff$Monocyte[order(gene_coeff$feature_coeff$Monocyte$coeff_clt4, decreasing = TRUE), ], n = 15) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': argument 1 is not a vector PlotExpression(object = pbmc_10Xassays, color.by = \"LGALS2\")"},{"path":"https://elolab.github.io/Coralysis/reference/PCAElbowPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"Draw elbow plot standard deviations principal components deduce appropriate value p.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PCAElbowPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"","code":"PCAElbowPlot.SingleCellExperiment(object, dimred.name, return.plot)  # S4 method for class 'SingleCellExperiment' PCAElbowPlot(object, dimred.name = \"PCA\", return.plot = FALSE)"},{"path":"https://elolab.github.io/Coralysis/reference/PCAElbowPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"object SingleCellExperiment object obtained running RunParallelDivisiveICP. dimred.name Dimensional reduction name PCA select reducedDimNames(object). default \"PCA\". return.plot logical indicating ggplot2 object returned. default FALSE.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PCAElbowPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"ggplot2 object, return.plot=TRUE.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PCAElbowPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Plot Elbow PCAElbowPlot(pbmc_10Xassays)"},{"path":"https://elolab.github.io/Coralysis/reference/PlotClusterTree.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot cluster tree — PlotClusterTree","title":"Plot cluster tree — PlotClusterTree","text":"Plot cluster tree cluster probability categorical variable.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PlotClusterTree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot cluster tree — PlotClusterTree","text":"","code":"PlotClusterTree.SingleCellExperiment(   object,   icp.run,   color.by,   use.color,   seed.color,   legend.title,   return.data )  # S4 method for class 'SingleCellExperiment' PlotClusterTree(   object,   icp.run,   color.by = NULL,   use.color = NULL,   seed.color = 123,   legend.title = color.by,   return.data = FALSE )"},{"path":"https://elolab.github.io/Coralysis/reference/PlotClusterTree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot cluster tree — PlotClusterTree","text":"object object SingleCellExperiment class. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability. default NULL, .e., retrieved. Specify numeric vector retrieve specific set tables. color.Categorical variable available colData(object) plot. NULL cluster probability represented instead. default NULL. use.color Character specifying colors. default NULL, .e., colors randomly chosen based seed given seed.color. seed.color Seed randomly select colors. default 123. legend.title Legend title. default given color.. Ignored color.NULL. return.data Return data frame used plot. Logical. default FALSE, .e., plot returned.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PlotClusterTree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot cluster tree — PlotClusterTree","text":"plot class ggplot list plot class ggplot data frame.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PlotClusterTree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot cluster tree — PlotClusterTree","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Plot probability PlotClusterTree(object = pbmc_10Xassays, icp.run = 2)   # Plot batch label distribution PlotClusterTree(object = pbmc_10Xassays, icp.run = 2, color.by = \"batch\") #> Error in loadNamespace(x): there is no package called ‘tidyr’  # Plot cell type label distribution PlotClusterTree(object = pbmc_10Xassays, icp.run = 2, color.by = \"cell_type\") #> Error in loadNamespace(x): there is no package called ‘tidyr’"},{"path":"https://elolab.github.io/Coralysis/reference/PlotDimRed.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot dimensional reduction categorical variables — PlotDimRed","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"Plot categorical variables dimensional reduction.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PlotDimRed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"","code":"PlotDimRed.SingleCellExperiment(   object,   color.by,   dimred,   dims,   use.color,   point.size,   point.stroke,   legend.nrow,   seed.color,   label,   plot.theme,   rasterise,   rasterise.dpi,   legend.justification,   legend.size,   legend.title )  # S4 method for class 'SingleCellExperiment' PlotDimRed(   object,   color.by,   dimred = tail(reducedDimNames(object), n = 1),   dims = 1:2,   use.color = NULL,   point.size = 1,   point.stroke = 1,   legend.nrow = 2,   seed.color = 123,   label = FALSE,   plot.theme = theme_classic(),   rasterise = (ncol(object) <= 30000),   rasterise.dpi = 300,   legend.justification = \"center\",   legend.size = 10,   legend.title = color.by )"},{"path":"https://elolab.github.io/Coralysis/reference/PlotDimRed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"object object SingleCellExperiment class. color.Categorical variable available colData(object) plot. dimred Dimensional reduction available ReducedDimNames(object) plot. default last dimensional reduction object used. dims Dimensions dimensional reduction embedding plot. use.color Character specifying colors. default NULL, .e., colors randomly chosen based seed given seed.color. point.size Size points. default 1. point.stroke Size stroke. default 1. legend.nrow Display legend items number rows. default 2. seed.color Seed randomly select colors. default 123. label Logical add categorical labels centroid categories. default FALSE, .e., labels added. plot.theme Plot theme available ggplot2. default theme_classic(). rasterise Logical specifying points rasterised . default TRUE, 3e4 cells, otherwise FALSE. rasterise.dpi case rasterise = TRUE, DPI use. default 300. legend.justification Legend justification. default \"center\". legend.size Legend size. default 10 legend.title Legend title. default given color..","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PlotDimRed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"plot class ggplot.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PlotDimRed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Run UMAP set.seed(123) pbmc_10Xassays <- RunUMAP(pbmc_10Xassays, dimred.type = \"PCA\")  # Plot batch  PlotDimRed(object = pbmc_10Xassays, color.by = \"batch\", dimred = \"UMAP\")   # Plot cell type annotations PlotDimRed(object = pbmc_10Xassays, color.by = \"cell_type\", legend.nrow = 3, dimred = \"UMAP\", label = TRUE) #> Warning: Removed 1986 rows containing missing values or values outside the scale range #> (`geom_text_repel()`)."},{"path":"https://elolab.github.io/Coralysis/reference/PlotExpression.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot dimensional reduction feature expression — PlotExpression","title":"Plot dimensional reduction feature expression — PlotExpression","text":"Plot feature expression dimensional reduction.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PlotExpression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot dimensional reduction feature expression — PlotExpression","text":"","code":"PlotExpression.SingleCellExperiment(   object,   color.by,   dimred,   scale.values,   color.scale,   plot.theme,   legend.title,   point.size,   point.stroke )  # S4 method for class 'SingleCellExperiment' PlotExpression(   object,   color.by,   dimred = tail(reducedDimNames(object), n = 1),   scale.values = FALSE,   color.scale = \"inferno\",   plot.theme = theme_classic(),   legend.title = color.by,   point.size = 1,   point.stroke = 1 )"},{"path":"https://elolab.github.io/Coralysis/reference/PlotExpression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot dimensional reduction feature expression — PlotExpression","text":"object object SingleCellExperiment class. color.Categorical variable available colData(object) plot. dimred Dimensional reduction available ReducedDimNames(object) plot. default last dimensional reduction object used. color.scale Character color scale palette passed ggplot2::scale_color_viridis_c. default inferno. palettes also available viridis. plot.theme Plot theme available ggplot2. default theme_classic(). legend.title Legend title. default given color.. point.size Size points. default 1. point.stroke Size stroke. default 1.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PlotExpression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot dimensional reduction feature expression — PlotExpression","text":"plot class ggplot.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PlotExpression.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot dimensional reduction feature expression — PlotExpression","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Run UMAP set.seed(123) pbmc_10Xassays <- RunUMAP(pbmc_10Xassays, dimred.type = \"PCA\")  # Plot cell cluster probabilities - mean # possible options: \"mean_probs\", \"median_probs\", \"scaled_median_probs\"  pbmc_10Xassays <- SummariseCellClusterProbability(object = pbmc_10Xassays, icp.round = 4, scale.funs = TRUE, save.in.sce = TRUE) # save result in 'colData' PlotExpression(object = pbmc_10Xassays, color.by = \"scaled_mean_probs\", dimred = \"UMAP\", color.scale = \"viridis\", legend.title = \"Scaled mean prob.\\n(min-max)\")    # Plot expression level of one or more features ## one  PlotExpression(object = pbmc_10Xassays, color.by = \"LGALS2\", dimred = \"UMAP\")   ## more than one genes <- c(\"CD8A\", \"CCR7\", \"GZMA\", \"MS4A1\", \"CD27\") exp.plots <- lapply(X = genes, FUN = function(x) {     PlotExpression(object = pbmc_10Xassays, color.by = x, dimred = \"UMAP\", scale.values = TRUE, point.size = 0.25, point.stroke = 0.25) }) cowplot::plot_grid(plotlist = exp.plots, ncol = 5, align = \"vh\")"},{"path":"https://elolab.github.io/Coralysis/reference/PrepareData.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare SingleCellExperiment object for analysis — PrepareData","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"function prepares SingleCellExperiment object analysis. required input object class SingleCellExperiment least data logcounts slot.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PrepareData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"","code":"PrepareData.SingleCellExperiment(object)  # S4 method for class 'SingleCellExperiment' PrepareData(object)"},{"path":"https://elolab.github.io/Coralysis/reference/PrepareData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"object object SingleCellExperiment class.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PrepareData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"object SingleCellExperiment class.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/PrepareData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Run function pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values."},{"path":"https://elolab.github.io/Coralysis/reference/RandomlyDivisiveClustering.html","id":null,"dir":"Reference","previous_headings":"","what":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","title":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","text":"Splits randomly every cluster given k clusters","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RandomlyDivisiveClustering.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","text":"","code":"RandomlyDivisiveClustering(cluster, k, cluster.names = NULL)"},{"path":"https://elolab.github.io/Coralysis/reference/RandomlyDivisiveClustering.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","text":"cluster clustering result cluster divided randomly k clusters. k number clusters cluster given cluster randomly divided . cluster.names Names name cluster result given. default NULL.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RandomlyDivisiveClustering.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","text":"clustering result every cluster given split randomly k clusters.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/ReferenceMapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Reference mapping — ReferenceMapping","title":"Reference mapping — ReferenceMapping","text":"function allows project new query data sets onto reference built Coralysis well transfer cell labels reference queries.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/ReferenceMapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reference mapping — ReferenceMapping","text":"","code":"ReferenceMapping.SingleCellExperiment(   ref,   query,   ref.label,   scale.query.by,   project.umap,   select.icp.models,   k.nn,   dimred.name.prefix )  # S4 method for class 'SingleCellExperiment,SingleCellExperiment' ReferenceMapping(   ref,   query,   ref.label,   scale.query.by = NULL,   project.umap = FALSE,   select.icp.models = metadata(ref)$coralysis$pca.params$select.icp.tables,   k.nn = 10,   dimred.name.prefix = \"\" )"},{"path":"https://elolab.github.io/Coralysis/reference/ReferenceMapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reference mapping — ReferenceMapping","text":"ref object SingleCellExperiment class trained Coralysis running RunPCA(..., return.model = TRUE) function. query object SingleCellExperiment class project onto ref. ref.label character cell metadata column name ref object transfer queries. scale.query.query data scaled cell feature. default NULL, .e., scaled. Scale reference scaled. project.umap Project query data onto reference UMAP (logical). default FALSE. TRUE, ref object needs UMAP embedding obtained RunUMAP(..., return.model = TRUE) function. k.nn number k nearest neighbors use classification KNN algorithm used transfer labels reference queries (integer). default 10. dimred.name.prefix Dimensional reduction name prefix add computed PCA UMAP. default nothing added, .e., dimred.name.prefix = \"\". selecte.icp.models Select reference ICP models use query cluster probability prediction. default metadata(ref)$coralysis$pca.params$select.icp.tables, .e., models selected compute reference PCA selected. NULL used. Otherwise numeric vector given select ICP models interest.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/ReferenceMapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reference mapping — ReferenceMapping","text":"object SingleCellExperiment class.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/ReferenceMapping.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reference mapping — ReferenceMapping","text":"","code":"## Reference-mapping # Split the SCE object by 'batch' ref <- pbmc_10Xassays[,pbmc_10Xassays$batch==\"V2\"] # let V2 assay batch be the reference data set query <- pbmc_10Xassays[,pbmc_10Xassays$batch==\"V1\"] # let V1 be the query (unknown annotations)  # 1) Train the reference - 'L = 4' just for highlighting purposes; use 'L=50' (default) or greater set.seed(123) ref <- RunParallelDivisiveICP(object = ref, L = 4, divisive.method = \"cluster\", threads = 1) # runs without 'batch.label' as it represents 1 sample only #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 500 2 #> EPOCH: 1 #> current clustering = 250 250 #> projected clustering = 244 256 #> ARI=0.860905413892533 #> probability matrix dimensions = 500 2 #> EPOCH: 2 #> current clustering = 244 256 #> projected clustering = 249 251 #> ARI=0.913763282439273 #> probability matrix dimensions = 500 2 #> EPOCH: 3 #> current clustering = 249 251 #> projected clustering = 249 251 #> ARI=0.952480774125568 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 249 251 #> projected clustering = 256 244 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 249 251 #> projected clustering = 253 247 #> ARI=0.952480786241631 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 253 247 #> projected clustering = 254 246 #> ARI=0.960320512330166 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 254 246 #> projected clustering = 253 247 #> ARI=0.976096114700718 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 252 248 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 249 251 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 250 250 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 256 244 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 255 245 #> probability matrix dimensions = 500 4 #> EPOCH: 1 #> current clustering = 124 123 127 126 #> projected clustering = 113 128 132 127 #> ARI=0.54068280765863 #> probability matrix dimensions = 500 4 #> EPOCH: 2 #> current clustering = 113 128 132 127 #> projected clustering = 113 130 130 127 #> ARI=0.756503050272598 #> probability matrix dimensions = 500 4 #> EPOCH: 3 #> current clustering = 113 130 130 127 #> projected clustering = 113 128 132 127 #> ARI=0.851546098899705 #> probability matrix dimensions = 500 4 #> EPOCH: 4 #> current clustering = 113 128 132 127 #> projected clustering = 111 136 125 128 #> probability matrix dimensions = 500 4 #> EPOCH: 4 #> current clustering = 113 128 132 127 #> projected clustering = 98 139 136 127 #> ARI=0.854439118323419 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 98 139 136 127 #> projected clustering = 99 142 132 127 #> ARI=0.935978277338942 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 99 142 132 127 #> projected clustering = 102 136 135 127 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 99 142 132 127 #> projected clustering = 119 130 122 129 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 99 142 132 127 #> projected clustering = 100 133 140 127 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 99 142 132 127 #> projected clustering = 105 129 139 127 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 99 142 132 127 #> projected clustering = 104 137 131 128 #> probability matrix dimensions = 500 8 #> EPOCH: 1 #> current clustering = 50 49 66 66 64 63 71 71 #> projected clustering = 38 68 50 90 44 83 45 82 #> ARI=0.53288324427006 #> probability matrix dimensions = 500 8 #> EPOCH: 2 #> current clustering = 38 68 50 90 44 83 45 82 #> projected clustering = 43 76 44 98 42 85 39 73 #> ARI=0.710931948656894 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 43 76 44 98 42 85 39 73 #> projected clustering = 52 69 45 99 42 84 39 70 #> ARI=0.837897960017352 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 52 69 45 99 42 84 39 70 #> projected clustering = 49 73 47 96 48 78 44 65 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 52 69 45 99 42 84 39 70 #> projected clustering = 49 72 47 96 40 87 43 66 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 52 69 45 99 42 84 39 70 #> projected clustering = 47 79 51 97 41 84 35 66 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 52 69 45 99 42 84 39 70 #> projected clustering = 55 69 47 98 45 82 38 66 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 52 69 45 99 42 84 39 70 #> projected clustering = 42 82 48 97 41 86 36 68 #> probability matrix dimensions = 500 16 #> EPOCH: 1 #> current clustering = 35 34 23 22 21 21 26 26 50 49 35 35 20 19 42 42 #> projected clustering = 41 40 20 28 18 20 20 19 31 65 28 37 14 30 51 38 #> ARI=0.467479816147333 #> probability matrix dimensions = 500 16 #> EPOCH: 2 #> current clustering = 41 40 20 28 18 20 20 19 31 65 28 37 14 30 51 38 #> projected clustering = 29 61 19 30 28 19 18 19 33 61 26 38 14 25 38 42 #> ARI=0.574805421986085 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 29 61 19 30 28 19 18 19 33 61 26 38 14 25 38 42 #> projected clustering = 28 61 22 27 21 25 27 20 35 55 19 36 16 27 41 40 #> ARI=0.656355858516036 #> probability matrix dimensions = 500 16 #> EPOCH: 4 #> current clustering = 28 61 22 27 21 25 27 20 35 55 19 36 16 27 41 40 #> projected clustering = 28 61 18 33 36 23 23 15 46 45 25 35 15 31 37 29 #> ARI=0.695996650729343 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 28 61 18 33 36 23 23 15 46 45 25 35 15 31 37 29 #> projected clustering = 32 51 17 33 29 26 24 18 49 44 22 36 17 32 42 28 #> ARI=0.737841514204607 #> probability matrix dimensions = 500 16 #> EPOCH: 6 #> current clustering = 32 51 17 33 29 26 24 18 49 44 22 36 17 32 42 28 #> projected clustering = 27 48 20 29 26 35 29 18 50 44 20 36 20 34 42 22 #> ARI=0.746191345037651 #> probability matrix dimensions = 500 16 #> EPOCH: 7 #> current clustering = 27 48 20 29 26 35 29 18 50 44 20 36 20 34 42 22 #> projected clustering = 24 59 22 27 25 36 21 20 53 41 19 34 22 31 44 22 #> probability matrix dimensions = 500 16 #> EPOCH: 7 #> current clustering = 27 48 20 29 26 35 29 18 50 44 20 36 20 34 42 22 #> projected clustering = 44 38 22 27 32 32 26 14 55 38 19 35 22 34 45 17 #> probability matrix dimensions = 500 16 #> EPOCH: 7 #> current clustering = 27 48 20 29 26 35 29 18 50 44 20 36 20 34 42 22 #> projected clustering = 35 43 22 26 28 36 28 16 49 44 19 35 20 37 41 21 #> ARI=0.782069010822919 #> probability matrix dimensions = 500 16 #> EPOCH: 8 #> current clustering = 35 43 22 26 28 36 28 16 49 44 19 35 20 37 41 21 #> projected clustering = 35 42 25 25 25 43 31 13 42 50 18 36 18 38 36 23 #> probability matrix dimensions = 500 16 #> EPOCH: 8 #> current clustering = 35 43 22 26 28 36 28 16 49 44 19 35 20 37 41 21 #> projected clustering = 37 40 19 29 26 37 30 15 49 44 19 35 23 34 40 23 #> probability matrix dimensions = 500 16 #> EPOCH: 8 #> current clustering = 35 43 22 26 28 36 28 16 49 44 19 35 20 37 41 21 #> projected clustering = 31 51 21 27 28 27 16 26 45 48 22 29 25 32 31 41 #> probability matrix dimensions = 500 16 #> EPOCH: 8 #> current clustering = 35 43 22 26 28 36 28 16 49 44 19 35 20 37 41 21 #> projected clustering = 26 52 24 21 44 27 40 16 43 50 19 32 23 27 37 19 #> probability matrix dimensions = 500 16 #> EPOCH: 8 #> current clustering = 35 43 22 26 28 36 28 16 49 44 19 35 20 37 41 21 #> projected clustering = 33 47 20 29 26 41 29 17 42 51 17 37 21 32 31 27 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.782069010822919. #> ICP run: 2 #> probability matrix dimensions = 500 2 #> EPOCH: 1 #> current clustering = 250 250 #> projected clustering = 251 249 #> ARI=0.868360197000476 #> probability matrix dimensions = 500 2 #> EPOCH: 2 #> current clustering = 251 249 #> projected clustering = 245 255 #> ARI=0.936897594475247 #> probability matrix dimensions = 500 2 #> EPOCH: 3 #> current clustering = 245 255 #> projected clustering = 253 247 #> ARI=0.936897607450507 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 253 247 #> projected clustering = 254 246 #> ARI=0.976096114700718 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 254 246 #> projected clustering = 254 246 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 254 246 #> projected clustering = 253 247 #> ARI=0.991999974001112 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 253 247 #> projected clustering = 253 247 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 253 247 #> projected clustering = 248 252 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 253 247 #> projected clustering = 253 247 #> ARI=1 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 249 251 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 258 242 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 252 248 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 255 245 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 253 247 #> projected clustering = 254 246 #> probability matrix dimensions = 500 4 #> EPOCH: 1 #> current clustering = 124 123 127 126 #> projected clustering = 122 115 135 128 #> ARI=0.553659855090899 #> probability matrix dimensions = 500 4 #> EPOCH: 2 #> current clustering = 122 115 135 128 #> projected clustering = 102 133 137 128 #> ARI=0.725803255330205 #> probability matrix dimensions = 500 4 #> EPOCH: 3 #> current clustering = 102 133 137 128 #> projected clustering = 107 125 141 127 #> ARI=0.883923474090111 #> probability matrix dimensions = 500 4 #> EPOCH: 4 #> current clustering = 107 125 141 127 #> projected clustering = 125 106 142 127 #> ARI=0.900710010389371 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 125 106 142 127 #> projected clustering = 129 107 136 128 #> ARI=0.930836807718945 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 129 107 136 128 #> projected clustering = 132 112 128 128 #> ARI=0.94400292843619 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 132 112 128 128 #> projected clustering = 131 109 132 128 #> ARI=0.968998872881955 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 131 109 132 128 #> projected clustering = 132 107 134 127 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 131 109 132 128 #> projected clustering = 134 116 122 128 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 131 109 132 128 #> projected clustering = 130 106 137 127 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 131 109 132 128 #> projected clustering = 132 110 131 127 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 131 109 132 128 #> projected clustering = 132 116 125 127 #> probability matrix dimensions = 500 8 #> EPOCH: 1 #> current clustering = 66 65 66 66 64 64 55 54 #> projected clustering = 44 84 41 95 51 78 57 50 #> ARI=0.554148391024381 #> probability matrix dimensions = 500 8 #> EPOCH: 2 #> current clustering = 44 84 41 95 51 78 57 50 #> projected clustering = 56 75 46 97 36 91 49 50 #> ARI=0.735349930931027 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 56 75 46 97 36 91 49 50 #> projected clustering = 53 78 45 98 27 101 48 50 #> ARI=0.795744827023885 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 53 78 45 98 27 101 48 50 #> projected clustering = 33 99 46 96 23 106 48 49 #> ARI=0.86127283933337 #> probability matrix dimensions = 500 8 #> EPOCH: 5 #> current clustering = 33 99 46 96 23 106 48 49 #> projected clustering = 34 96 46 98 25 104 55 42 #> ARI=0.910390119908751 #> probability matrix dimensions = 500 8 #> EPOCH: 6 #> current clustering = 34 96 46 98 25 104 55 42 #> projected clustering = 26 105 46 96 25 105 58 39 #> ARI=0.920639888328548 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 26 105 46 96 25 105 58 39 #> projected clustering = 35 95 45 99 29 100 53 44 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 26 105 46 96 25 105 58 39 #> projected clustering = 31 102 46 98 32 99 53 39 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 26 105 46 96 25 105 58 39 #> projected clustering = 38 93 45 97 24 107 55 41 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 26 105 46 96 25 105 58 39 #> projected clustering = 28 104 45 97 26 104 57 39 #> ARI=0.945156486477193 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 28 104 45 97 26 104 57 39 #> projected clustering = 36 94 44 97 35 96 56 42 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 28 104 45 97 26 104 57 39 #> projected clustering = 41 92 45 98 28 102 54 40 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 28 104 45 97 26 104 57 39 #> projected clustering = 33 98 46 98 32 98 54 41 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 28 104 45 97 26 104 57 39 #> projected clustering = 46 83 45 97 26 103 61 39 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 28 104 45 97 26 104 57 39 #> projected clustering = 35 97 45 97 29 101 57 39 #> probability matrix dimensions = 500 16 #> EPOCH: 1 #> current clustering = 52 52 23 22 52 52 49 48 29 28 20 19 14 14 13 13 #> projected clustering = 43 48 18 26 26 76 36 57 18 38 28 17 28 13 12 16 #> ARI=0.482638813087485 #> probability matrix dimensions = 500 16 #> EPOCH: 2 #> current clustering = 43 48 18 26 26 76 36 57 18 38 28 17 28 13 12 16 #> projected clustering = 31 61 21 23 23 79 42 51 22 29 23 22 31 14 13 15 #> ARI=0.637387065359217 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 31 61 21 23 23 79 42 51 22 29 23 22 31 14 13 15 #> projected clustering = 27 58 21 25 25 76 35 59 29 21 25 22 29 18 12 18 #> ARI=0.687694938631591 #> probability matrix dimensions = 500 16 #> EPOCH: 4 #> current clustering = 27 58 21 25 25 76 35 59 29 21 25 22 29 18 12 18 #> projected clustering = 40 47 16 30 38 64 25 70 26 27 20 27 27 15 11 17 #> probability matrix dimensions = 500 16 #> EPOCH: 4 #> current clustering = 27 58 21 25 25 76 35 59 29 21 25 22 29 18 12 18 #> projected clustering = 30 52 21 25 36 65 40 53 21 24 31 22 33 18 11 18 #> ARI=0.691849059657159 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 30 52 21 25 36 65 40 53 21 24 31 22 33 18 11 18 #> projected clustering = 35 46 17 29 39 52 38 55 20 26 27 29 31 17 11 28 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 30 52 21 25 36 65 40 53 21 24 31 22 33 18 11 18 #> projected clustering = 21 53 18 29 30 69 34 59 17 26 30 25 36 21 11 21 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 30 52 21 25 36 65 40 53 21 24 31 22 33 18 11 18 #> projected clustering = 31 50 14 30 44 57 43 51 25 25 25 25 29 21 11 19 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 30 52 21 25 36 65 40 53 21 24 31 22 33 18 11 18 #> projected clustering = 36 50 16 30 41 57 46 47 23 28 23 26 29 15 12 21 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 30 52 21 25 36 65 40 53 21 24 31 22 33 18 11 18 #> projected clustering = 40 45 22 25 39 60 40 52 21 24 24 29 28 21 11 19 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.691849059657159. #> ICP run: 3 #> probability matrix dimensions = 500 2 #> EPOCH: 1 #> current clustering = 250 250 #> projected clustering = 250 250 #> ARI=0.84609156626506 #> probability matrix dimensions = 500 2 #> EPOCH: 2 #> current clustering = 250 250 #> projected clustering = 262 238 #> ARI=0.890917902259344 #> probability matrix dimensions = 500 2 #> EPOCH: 3 #> current clustering = 262 238 #> projected clustering = 259 241 #> ARI=0.97609619752109 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 259 241 #> projected clustering = 263 237 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 259 241 #> projected clustering = 255 245 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 259 241 #> projected clustering = 261 239 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 259 241 #> projected clustering = 255 245 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 259 241 #> projected clustering = 258 242 #> probability matrix dimensions = 500 4 #> EPOCH: 1 #> current clustering = 121 120 130 129 #> projected clustering = 96 147 118 139 #> ARI=0.500341997551534 #> probability matrix dimensions = 500 4 #> EPOCH: 2 #> current clustering = 96 147 118 139 #> projected clustering = 96 148 127 129 #> ARI=0.664052960506769 #> probability matrix dimensions = 500 4 #> EPOCH: 3 #> current clustering = 96 148 127 129 #> projected clustering = 113 134 126 127 #> ARI=0.688633924701096 #> probability matrix dimensions = 500 4 #> EPOCH: 4 #> current clustering = 113 134 126 127 #> projected clustering = 113 140 118 129 #> ARI=0.8678779191565 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 113 140 118 129 #> projected clustering = 116 146 110 128 #> ARI=0.876202678459898 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 116 146 110 128 #> projected clustering = 129 142 100 129 #> ARI=0.899252160617905 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 129 142 100 129 #> projected clustering = 123 147 99 131 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 129 142 100 129 #> projected clustering = 122 149 99 130 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 129 142 100 129 #> projected clustering = 132 140 99 129 #> ARI=0.908859915523874 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 132 140 99 129 #> projected clustering = 136 137 99 128 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 132 140 99 129 #> projected clustering = 126 145 100 129 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 132 140 99 129 #> projected clustering = 129 144 97 130 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 132 140 99 129 #> projected clustering = 122 150 100 128 #> ARI=0.918579235817529 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 122 150 100 128 #> projected clustering = 123 147 100 130 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 122 150 100 128 #> projected clustering = 124 149 97 130 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 122 150 100 128 #> projected clustering = 130 144 97 129 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 122 150 100 128 #> projected clustering = 123 148 98 131 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 122 150 100 128 #> projected clustering = 123 148 101 128 #> ARI=0.940005413311393 #> probability matrix dimensions = 500 4 #> EPOCH: 10 #> current clustering = 123 148 101 128 #> projected clustering = 122 150 100 128 #> ARI=0.961621265809584 #> probability matrix dimensions = 500 4 #> EPOCH: 11 #> current clustering = 122 150 100 128 #> projected clustering = 124 149 99 128 #> ARI=0.967028830914731 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 124 149 99 128 #> projected clustering = 131 144 97 128 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 124 149 99 128 #> projected clustering = 122 153 95 130 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 124 149 99 128 #> projected clustering = 125 148 99 128 #> ARI=0.978648486140703 #> probability matrix dimensions = 500 4 #> EPOCH: 13 #> current clustering = 125 148 99 128 #> projected clustering = 130 145 98 127 #> probability matrix dimensions = 500 4 #> EPOCH: 13 #> current clustering = 125 148 99 128 #> projected clustering = 123 150 99 128 #> probability matrix dimensions = 500 4 #> EPOCH: 13 #> current clustering = 125 148 99 128 #> projected clustering = 125 148 99 128 #> ARI=1 #> probability matrix dimensions = 500 4 #> EPOCH: 14 #> current clustering = 125 148 99 128 #> projected clustering = 125 147 100 128 #> probability matrix dimensions = 500 4 #> EPOCH: 14 #> current clustering = 125 148 99 128 #> projected clustering = 129 146 98 127 #> probability matrix dimensions = 500 4 #> EPOCH: 14 #> current clustering = 125 148 99 128 #> projected clustering = 123 150 99 128 #> probability matrix dimensions = 500 4 #> EPOCH: 14 #> current clustering = 125 148 99 128 #> projected clustering = 125 148 99 128 #> probability matrix dimensions = 500 4 #> EPOCH: 14 #> current clustering = 125 148 99 128 #> projected clustering = 128 145 99 128 #> probability matrix dimensions = 500 8 #> EPOCH: 1 #> current clustering = 74 74 63 62 64 64 50 49 #> projected clustering = 36 110 55 70 53 75 43 58 #> ARI=0.572407431101838 #> probability matrix dimensions = 500 8 #> EPOCH: 2 #> current clustering = 36 110 55 70 53 75 43 58 #> projected clustering = 41 104 67 62 45 82 49 50 #> ARI=0.742361262727057 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 41 104 67 62 45 82 49 50 #> projected clustering = 32 113 70 60 45 80 43 57 #> ARI=0.792346930293855 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 32 113 70 60 45 80 43 57 #> projected clustering = 33 115 67 62 43 82 41 57 #> ARI=0.830107233044497 #> probability matrix dimensions = 500 8 #> EPOCH: 5 #> current clustering = 33 115 67 62 43 82 41 57 #> projected clustering = 34 115 63 64 36 89 40 59 #> ARI=0.846952612144897 #> probability matrix dimensions = 500 8 #> EPOCH: 6 #> current clustering = 34 115 63 64 36 89 40 59 #> projected clustering = 34 115 65 61 28 98 37 62 #> ARI=0.879422774081456 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 34 115 65 61 28 98 37 62 #> projected clustering = 40 108 68 60 48 77 37 62 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 34 115 65 61 28 98 37 62 #> projected clustering = 40 111 62 62 40 85 34 66 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 34 115 65 61 28 98 37 62 #> projected clustering = 31 120 67 57 38 89 38 60 #> ARI=0.879683026407296 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 31 120 67 57 38 89 38 60 #> projected clustering = 44 107 65 57 38 90 31 68 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 31 120 67 57 38 89 38 60 #> projected clustering = 39 112 63 62 33 93 38 60 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 31 120 67 57 38 89 38 60 #> projected clustering = 34 117 72 54 41 85 34 63 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 31 120 67 57 38 89 38 60 #> projected clustering = 33 123 66 53 41 85 33 66 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 31 120 67 57 38 89 38 60 #> projected clustering = 28 123 62 59 45 81 40 62 #> ARI=0.883566499104225 #> probability matrix dimensions = 500 8 #> EPOCH: 9 #> current clustering = 28 123 62 59 45 81 40 62 #> projected clustering = 34 122 63 56 45 80 38 62 #> ARI=0.896074481290736 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 34 122 63 56 45 80 38 62 #> projected clustering = 38 121 66 50 47 78 40 60 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 34 122 63 56 45 80 38 62 #> projected clustering = 38 115 60 62 45 81 33 66 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 34 122 63 56 45 80 38 62 #> projected clustering = 29 125 68 53 48 77 38 62 #> ARI=0.942576336509811 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 29 125 68 53 48 77 38 62 #> projected clustering = 32 119 66 56 52 74 37 64 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 29 125 68 53 48 77 38 62 #> projected clustering = 27 125 77 45 48 77 39 62 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 29 125 68 53 48 77 38 62 #> projected clustering = 31 126 61 56 46 79 37 64 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 29 125 68 53 48 77 38 62 #> projected clustering = 32 125 63 56 47 77 35 65 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 29 125 68 53 48 77 38 62 #> projected clustering = 36 121 65 50 53 74 39 62 #> probability matrix dimensions = 500 16 #> EPOCH: 1 #> current clustering = 63 62 27 26 39 38 31 31 19 19 15 14 34 34 24 24 #> projected clustering = 47 74 15 37 28 43 30 30 18 23 16 16 18 52 23 30 #> ARI=0.45948713735848 #> probability matrix dimensions = 500 16 #> EPOCH: 2 #> current clustering = 47 74 15 37 28 43 30 30 18 23 16 16 18 52 23 30 #> projected clustering = 21 90 15 42 34 39 37 26 21 18 21 23 13 48 22 30 #> ARI=0.591166893295404 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 21 90 15 42 34 39 37 26 21 18 21 23 13 48 22 30 #> projected clustering = 30 72 21 37 34 24 34 25 17 25 30 23 14 47 32 35 #> ARI=0.605981034542905 #> probability matrix dimensions = 500 16 #> EPOCH: 4 #> current clustering = 30 72 21 37 34 24 34 25 17 25 30 23 14 47 32 35 #> projected clustering = 28 78 18 41 43 23 24 30 23 24 25 20 13 48 31 31 #> ARI=0.685320634494923 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 28 78 18 41 43 23 24 30 23 24 25 20 13 48 31 31 #> projected clustering = 26 77 19 39 49 15 25 30 22 24 25 17 18 52 38 24 #> ARI=0.709636350612721 #> probability matrix dimensions = 500 16 #> EPOCH: 6 #> current clustering = 26 77 19 39 49 15 25 30 22 24 25 17 18 52 38 24 #> projected clustering = 25 77 20 34 42 20 19 33 27 24 24 22 15 54 34 30 #> ARI=0.761841683176744 #> probability matrix dimensions = 500 16 #> EPOCH: 7 #> current clustering = 25 77 20 34 42 20 19 33 27 24 24 22 15 54 34 30 #> projected clustering = 22 81 26 27 43 24 17 25 32 28 25 19 13 58 33 27 #> ARI=0.771289006286334 #> probability matrix dimensions = 500 16 #> EPOCH: 8 #> current clustering = 22 81 26 27 43 24 17 25 32 28 25 19 13 58 33 27 #> projected clustering = 30 75 26 25 43 18 18 26 34 25 24 21 12 56 41 26 #> ARI=0.792424241130767 #> probability matrix dimensions = 500 16 #> EPOCH: 9 #> current clustering = 30 75 26 25 43 18 18 26 34 25 24 21 12 56 41 26 #> projected clustering = 31 71 28 30 39 23 19 32 32 22 24 18 16 49 36 30 #> probability matrix dimensions = 500 16 #> EPOCH: 9 #> current clustering = 30 75 26 25 43 18 18 26 34 25 24 21 12 56 41 26 #> projected clustering = 36 68 22 28 45 15 22 26 33 22 26 19 15 56 42 25 #> ARI=0.811046532390255 #> probability matrix dimensions = 500 16 #> EPOCH: 10 #> current clustering = 36 68 22 28 45 15 22 26 33 22 26 19 15 56 42 25 #> projected clustering = 33 71 29 25 51 15 26 30 32 15 23 23 14 51 37 25 #> probability matrix dimensions = 500 16 #> EPOCH: 10 #> current clustering = 36 68 22 28 45 15 22 26 33 22 26 19 15 56 42 25 #> projected clustering = 32 71 26 26 44 14 21 34 29 19 24 19 19 53 48 21 #> probability matrix dimensions = 500 16 #> EPOCH: 10 #> current clustering = 36 68 22 28 45 15 22 26 33 22 26 19 15 56 42 25 #> projected clustering = 32 68 22 28 47 20 26 28 31 17 26 19 14 62 32 28 #> probability matrix dimensions = 500 16 #> EPOCH: 10 #> current clustering = 36 68 22 28 45 15 22 26 33 22 26 19 15 56 42 25 #> projected clustering = 30 73 25 29 42 16 22 27 33 20 23 23 15 53 39 30 #> ARI=0.830918787052101 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 30 73 25 29 42 16 22 27 33 20 23 23 15 53 39 30 #> projected clustering = 41 64 24 29 35 29 22 23 34 21 30 14 18 51 38 27 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 30 73 25 29 42 16 22 27 33 20 23 23 15 53 39 30 #> projected clustering = 34 68 27 28 45 17 18 31 32 20 28 23 20 43 33 33 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 30 73 25 29 42 16 22 27 33 20 23 23 15 53 39 30 #> projected clustering = 33 69 25 31 41 22 21 29 35 18 24 21 18 46 38 29 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 30 73 25 29 42 16 22 27 33 20 23 23 15 53 39 30 #> projected clustering = 37 72 31 28 42 17 25 24 33 19 21 23 14 44 33 37 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 30 73 25 29 42 16 22 27 33 20 23 23 15 53 39 30 #> projected clustering = 33 64 24 35 38 24 21 31 28 23 31 20 13 52 34 29 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.830918787052101. #> ICP run: 4 #> probability matrix dimensions = 500 2 #> EPOCH: 1 #> current clustering = 250 250 #> projected clustering = 243 257 #> ARI=0.838733073159178 #> probability matrix dimensions = 500 2 #> EPOCH: 2 #> current clustering = 243 257 #> projected clustering = 247 253 #> ARI=0.906116019728455 #> probability matrix dimensions = 500 2 #> EPOCH: 3 #> current clustering = 247 253 #> projected clustering = 234 266 #> probability matrix dimensions = 500 2 #> EPOCH: 3 #> current clustering = 247 253 #> projected clustering = 237 263 #> ARI=0.906116355627711 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 237 263 #> projected clustering = 230 270 #> ARI=0.913763258855457 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 230 270 #> projected clustering = 229 271 #> ARI=0.929152726197092 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 229 271 #> projected clustering = 229 271 #> ARI=1 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 229 271 #> projected clustering = 229 271 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 229 271 #> projected clustering = 229 271 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 229 271 #> projected clustering = 228 272 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 229 271 #> projected clustering = 226 274 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 229 271 #> projected clustering = 227 273 #> probability matrix dimensions = 500 4 #> EPOCH: 1 #> current clustering = 136 135 115 114 #> projected clustering = 125 146 110 119 #> ARI=0.547906298581332 #> probability matrix dimensions = 500 4 #> EPOCH: 2 #> current clustering = 125 146 110 119 #> projected clustering = 139 134 96 131 #> ARI=0.549437446273372 #> probability matrix dimensions = 500 4 #> EPOCH: 3 #> current clustering = 139 134 96 131 #> projected clustering = 141 128 100 131 #> ARI=0.698123810252216 #> probability matrix dimensions = 500 4 #> EPOCH: 4 #> current clustering = 141 128 100 131 #> projected clustering = 139 131 101 129 #> ARI=0.884265998470723 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 139 131 101 129 #> projected clustering = 142 128 101 129 #> ARI=0.971821294900963 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 142 128 101 129 #> projected clustering = 142 131 100 127 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 142 128 101 129 #> projected clustering = 143 126 103 128 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 142 128 101 129 #> projected clustering = 141 130 98 131 #> ARI=0.97977753803617 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 141 130 98 131 #> projected clustering = 140 133 97 130 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 141 130 98 131 #> projected clustering = 141 134 96 129 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 141 130 98 131 #> projected clustering = 148 123 99 130 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 141 130 98 131 #> projected clustering = 139 134 100 127 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 141 130 98 131 #> projected clustering = 136 134 102 128 #> probability matrix dimensions = 500 8 #> EPOCH: 1 #> current clustering = 71 70 65 65 66 65 49 49 #> projected clustering = 43 102 61 68 58 71 47 50 #> ARI=0.503454161655723 #> probability matrix dimensions = 500 8 #> EPOCH: 2 #> current clustering = 43 102 61 68 58 71 47 50 #> projected clustering = 42 106 60 68 57 70 40 57 #> ARI=0.727553082864517 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 42 106 60 68 57 70 40 57 #> projected clustering = 39 104 72 59 64 63 45 54 #> ARI=0.734959448295588 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 39 104 72 59 64 63 45 54 #> projected clustering = 56 88 71 59 65 62 43 56 #> ARI=0.77721746147178 #> probability matrix dimensions = 500 8 #> EPOCH: 5 #> current clustering = 56 88 71 59 65 62 43 56 #> projected clustering = 50 93 73 59 57 69 43 56 #> ARI=0.822698616399041 #> probability matrix dimensions = 500 8 #> EPOCH: 6 #> current clustering = 50 93 73 59 57 69 43 56 #> projected clustering = 54 93 68 61 71 55 44 54 #> ARI=0.876640439779276 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 54 93 68 61 71 55 44 54 #> projected clustering = 50 98 68 61 72 54 43 54 #> ARI=0.88138811235916 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 50 98 68 61 72 54 43 54 #> projected clustering = 44 100 69 63 69 58 43 54 #> ARI=0.895793640431056 #> probability matrix dimensions = 500 8 #> EPOCH: 9 #> current clustering = 44 100 69 63 69 58 43 54 #> projected clustering = 44 103 65 64 75 51 44 54 #> ARI=0.913112993361468 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 44 103 65 64 75 51 44 54 #> projected clustering = 46 100 68 64 68 58 41 55 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 44 103 65 64 75 51 44 54 #> projected clustering = 46 100 70 60 70 56 44 54 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 44 103 65 64 75 51 44 54 #> projected clustering = 48 95 65 66 79 48 40 59 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 44 103 65 64 75 51 44 54 #> projected clustering = 48 97 66 63 74 54 41 57 #> ARI=0.930706563065716 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 48 97 66 63 74 54 41 57 #> projected clustering = 49 98 62 63 81 48 42 57 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 48 97 66 63 74 54 41 57 #> projected clustering = 48 96 68 63 68 58 41 58 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 48 97 66 63 74 54 41 57 #> projected clustering = 50 99 65 61 78 49 38 60 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 48 97 66 63 74 54 41 57 #> projected clustering = 47 97 69 61 75 53 44 54 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 48 97 66 63 74 54 41 57 #> projected clustering = 47 98 67 63 82 45 42 56 #> probability matrix dimensions = 500 16 #> EPOCH: 1 #> current clustering = 49 48 32 31 27 27 24 24 21 20 33 33 29 28 37 37 #> projected clustering = 18 80 24 38 30 29 28 22 25 20 18 47 21 33 28 39 #> ARI=0.562965303051387 #> probability matrix dimensions = 500 16 #> EPOCH: 2 #> current clustering = 18 80 24 38 30 29 28 22 25 20 18 47 21 33 28 39 #> projected clustering = 15 81 23 38 34 23 28 28 26 22 29 32 21 31 33 36 #> ARI=0.754901730972879 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 15 81 23 38 34 23 28 28 26 22 29 32 21 31 33 36 #> projected clustering = 37 60 19 43 34 26 30 24 28 24 26 36 19 27 26 41 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 15 81 23 38 34 23 28 28 26 22 29 32 21 31 33 36 #> projected clustering = 22 73 25 37 34 26 29 29 23 24 25 35 20 30 31 37 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 15 81 23 38 34 23 28 28 26 22 29 32 21 31 33 36 #> projected clustering = 18 76 26 41 41 20 33 26 24 23 28 28 26 24 31 35 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 15 81 23 38 34 23 28 28 26 22 29 32 21 31 33 36 #> projected clustering = 25 61 25 34 35 15 36 30 26 27 17 46 14 32 44 33 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 15 81 23 38 34 23 28 28 26 22 29 32 21 31 33 36 #> projected clustering = 17 75 23 33 33 24 24 36 24 24 39 26 28 25 32 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.754901730972879. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # 2) Compute reference PCA & UMAP ref <- RunPCA(ref, return.model = TRUE, pca.method = \"stats\") #> Divisive ICP: selecting ICP tables multiple of 4 set.seed(123) ref <- RunUMAP(ref, return.model = TRUE)  # 3) Project & predict query cell labels  set.seed(1024) map <- ReferenceMapping(ref = ref, query = query, ref.label = \"cell_type\", scale.query.by = NULL, project.umap = TRUE)  # Calculate accuracy preds_x_truth <- table(map$coral_labels, map$cell_type) preds_x_truth #>                  #>                  aDC B mem B naive CD4 mem CD4 naive CD8 eff CD8 T HSC #>   aDC             14     0       0       0         0       0     0   0 #>   B mem            0    35      11       0         0       1     0   1 #>   B naive          0     8      74       0         0       0     0   0 #>   CD4 mem          0     0       0      54        20       3     1   0 #>   CD4 naive        0     1       0      69       169       0    18   4 #>   CD8 eff          0     1       0       2         1      96     1   0 #>   CD8 T            0     0       0       3         6       8    62   0 #>   HSC              0     0       0       0         0       0     0   0 #>   Megakaryocyte    0     0       0       0         0       0     0   0 #>   Monocyte         1     0       0       0         0       0     0   0 #>   CD16+ monocyte   0     0       0       0         0       0     0   0 #>   NK               0     0       0       0         0       0     0   0 #>   pDC              0     0       0       0         0       0     0   0 #>   Treg             0     0       0       0         0       0     0   0 #>                  #>                  Megakaryocyte Monocyte CD16+ monocyte  NK pDC Treg #>   aDC                        0        0              0   0   0    0 #>   B mem                      0        0              0   0   0    0 #>   B naive                    0        0              0   0   0    0 #>   CD4 mem                    0        0              0   0   0    3 #>   CD4 naive                  0        0              0   0   0   12 #>   CD8 eff                    1        0              0   2   0    0 #>   CD8 T                      1        0              0   0   0    0 #>   HSC                        0        0              0   0   0    0 #>   Megakaryocyte              0        0              0   0   0    0 #>   Monocyte                   3      177             18   1   0    0 #>   CD16+ monocyte             1        1             58   0   0    0 #>   NK                         0        0              0  54   0    0 #>   pDC                        0        0              0   0   4    0 #>   Treg                       0        0              0   0   0    0 sum(diag(preds_x_truth)) / sum(preds_x_truth) # 0.806 : 81% #> [1] 0.797"},{"path":"https://elolab.github.io/Coralysis/reference/RunDivisiveICP.html","id":null,"dir":"Reference","previous_headings":"","what":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","title":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","text":"function implements divisive Iterative Clustering Projection (ICP) clustering: supervised learning-based clustering, maximizes clustering similarity clustering projection logistic regression, divisive clustering manner.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunDivisiveICP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","text":"","code":"RunDivisiveICP(   normalized.data = NULL,   batch.label = NULL,   k = 16,   d = 0.3,   r = 5,   C = 5,   reg.type = \"L1\",   max.iter = 200,   icp.batch.size = Inf,   train.with.bnn = TRUE,   train.k.nn = 10,   train.k.nn.prop = NULL,   cluster.seed = NULL,   divisive.method = \"random\",   allow.free.k = FALSE,   ari.cutoff = 0.5 )"},{"path":"https://elolab.github.io/Coralysis/reference/RunDivisiveICP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","text":"normalized.data sparse matrix (dgCMatrix) containing normalized feature expression data cells rows features columns. Default NULL. batch.label character vector batch labels corresponding cells given normalized.data. character batch labels need named cells names given rows normalized.data. default NULL, .e., cells sampled evenly regardless batch. k positive integer power two, .e., 2**n, n>0, specifying number clusters last Iterative Clustering Projection (ICP) round. Decreasing k leads smaller cell populations diversity vice versa. Default 16, .e., divisive clustering 2 -> 4 -> 8 -> 16 performed. d numeric defines many cells per cluster - oversampled (d ceiling(N/k*d)), stratified.downsampling=FALSE, fraction downsampled stratified approach ,stratified.downsampling=TRUE. Default 0.3. r positive integer denotes number reiterations performed algorithm stops. Default 5. C Cost constraints violation (C) L1-regulatization. Default 0.3. reg.type \"L1\" LASSO \"L2\" Ridge. Default \"L1\". max.iter positive integer denotes maximum number iterations performed algorithm ends. Default 200. icp.batch.size positive integer specifies many cells randomly select ICP run complete data set. new feature intended speed process larger data sets. Default Inf, means using cells. train..bnn Train data batch nearest neighbors. Default TRUE. used batch.label given. train.k.nn Train data batch nearest neighbors using k nearest neighbors. Default 10. used train..bnn TRUE. train.k.nn.prop numeric (higher 0 lower 1) corresponding fraction cells per cluster use train.k.nn nearest neighbors. Default NULL meaning number train.k.nn nearest neighbors equal train.k.nn. given, train.k.nn parameter ignored train.k.nn calculated based train.k.nn.prop. vector different proportions different divisive clustering rounds can given, otherwise value given . cluster.seed cluster seed start guide clustering reproducible clusterings across runs (factor). Default NULL. Otherwise, random clustering takes place start divisive clustering ICP. divisive.method Divisive method (character). One \"random\" (randomly sample two clusters every cluster previously found), \"cluster\" \"cluster.batch\" (sample two clusters every cluster previously found based cluster probability distribution across batches per batch). default \"random\". allow.free.k Allow free k (logical). Allow ICP algorithm decrease k given case find k target clusters. default FALSE. ari.cutoff Include ICP models probability tables Adjusted Rand Index higher ari.cutoff (numeric). default 0.5. value can range 0 (include ) lower 1.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunDivisiveICP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","text":"list includes probability matrix clustering similarity measures: ARI, NMI, etc.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunPCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Principal Component Analysis — RunPCA","title":"Principal Component Analysis — RunPCA","text":"Perform principal component analysis using assays joint probability matrix input.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunPCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Principal Component Analysis — RunPCA","text":"","code":"RunPCA.SingleCellExperiment(   object,   assay.name,   p,   scale,   center,   threshold,   pca.method,   return.model,   select.icp.tables,   features,   dimred.name )  # S4 method for class 'SingleCellExperiment' RunPCA(   object,   assay.name = \"joint.probability\",   p = 50,   scale = TRUE,   center = TRUE,   threshold = 0,   pca.method = \"irlba\",   return.model = FALSE,   select.icp.tables = NULL,   features = NULL,   dimred.name = \"PCA\" )"},{"path":"https://elolab.github.io/Coralysis/reference/RunPCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Principal Component Analysis — RunPCA","text":"object SingleCellExperiment object. assay.name Name assay compute PCA. One assayNames(object) joint.probability. default joint.probability used. Use joint.probability obtain integrated embedding running RunParallelDivisiveICP. One assays assayNames(object) can provided performing integration assess data requires integration. p positive integer denoting number principal components calculate select. Default 50. scale logical specifying whether probabilities standardized unit-variance running PCA. Default TRUE. center logical specifying whether probabilities centered running PCA. Default TRUE. threshold threshold filtering ICP runs PCA lower terminal projection accuracy threshold. Default 0. pca.method character specifying PCA method. One \"irlba\" (default), \"RSpectra\" \"stats\". Set seed , method \"irlba\" ensure reproducibility. return.model logical specifying PCA model retrieved. default FALSE. implemented pca.method = \"stats\". TRUE, pca.method coerced \"stats\". select.icp.tables Select ICP cluster probability tables perform PCA. default NULL, .e., used, except ICP tables obtained function RunParallelDivisiveICP, ICP tables correspond last round divisive clustering every epoch. vector integers given otherwise. features character feature names matching row.names(object) select computing PCA. used assay.name one assays assayNames(object), otherwise ignored. dimred.name Dimensional reduction name given returned PCA. default \"PCA\".","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunPCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Principal Component Analysis — RunPCA","text":"object SingleCellExperiment class","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunPCA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Principal Component Analysis — RunPCA","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, assay.name = \"joint.probability\", p = 10, dimred.name = \"PCA\") #> Divisive ICP: selecting ICP tables multiple of 4"},{"path":"https://elolab.github.io/Coralysis/reference/RunParallelDivisiveICP.html","id":null,"dir":"Reference","previous_headings":"","what":"Multi-level integration — RunParallelDivisiveICP","title":"Multi-level integration — RunParallelDivisiveICP","text":"Run divisive ICP clustering parallel order perform multi-level integration.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunParallelDivisiveICP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multi-level integration — RunParallelDivisiveICP","text":"","code":"RunParallelDivisiveICP.SingleCellExperiment(   object,   batch.label,   k,   d,   L,   r,   C,   reg.type,   max.iter,   threads,   icp.batch.size,   train.with.bnn,   train.k.nn,   train.k.nn.prop,   build.train.set,   build.train.params,   scale.by,   use.cluster.seed,   divisive.method,   allow.free.k,   ari.cutoff,   verbose )  # S4 method for class 'SingleCellExperiment' RunParallelDivisiveICP(   object,   batch.label = NULL,   k = 16,   d = 0.3,   L = 50,   r = 5,   C = 0.3,   reg.type = \"L1\",   max.iter = 200,   threads = 0,   icp.batch.size = Inf,   train.with.bnn = TRUE,   train.k.nn = 10,   train.k.nn.prop = 0.3,   build.train.set = TRUE,   build.train.params = list(),   scale.by = NULL,   use.cluster.seed = TRUE,   divisive.method = \"cluster.batch\",   allow.free.k = TRUE,   ari.cutoff = 0.3,   verbose = FALSE )"},{"path":"https://elolab.github.io/Coralysis/reference/RunParallelDivisiveICP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multi-level integration — RunParallelDivisiveICP","text":"object object SingleCellExperiment class. batch.label variable name (class character) available cell metadata colData(object) batch labels (character factor) use. variable provided must contain NAs. default NULL, .e., cells sampled evenly regardless batch. k positive integer power two, .e., 2**n, n>0, specifying number clusters last Iterative Clustering Projection (ICP) round. Decreasing k leads smaller cell populations diversity vice versa. Default 16, .e., divisive clustering 2 -> 4 -> 8 -> 16 performed. d numeric greater 0 smaller 1 determines many cells n - oversampled cluster training data (n=N/k*d), N total number cells, k number clusters ICP. Increasing 0.3 leads greadually smaller cell populations diversity. Default 0.3. L positive integer greater 1 denoting number ICP runs run. Default 50. Increasing recommended significantly larger sample size (tens thousands cells). Default 200. r positive integer denotes number reiterations performed ICP algorithm stops. Increasing recommended significantly larger sample size (tens thousands cells). Default 5. C positive real number denoting cost constraints violation L1-regularized logistic regression model LIBLINEAR library. Decreasing leads stringent feature selection, .e. less features selected used build projection classifier. Decreasing low value (~ 0.01) can lead failure identify central cell populations. Default 0.3. reg.type \"L1\" \"L2\". L2-regularization investigated manuscript, leads conventional outcome (less subpopulations). Default \"L1\". max.iter positive integer denotes maximum number iterations performed ICP stops. parameter useful situations ICP converges extremely slowly, preventing algorithm run long. cases, reaching number reiterations (r=5) terminates algorithm. Default 200. threads positive integer specifies many logical processors (threads) use parallel computation. Set 1 disable parallelism altogether 0 use available threas except one. Default 0. icp.batch.size positive integer specifies many cells randomly select. behaves differently depending build.train.set. build.train.set=FALSE, randomly samples cells ICP run complete dataset. build.train.set=TRUE, randomly samples cells , building training set sampled cells (per batch batch.label different NULL). Default Inf, means using cells. train..bnn Train data batch nearest neighbors. Default TRUE. used batch.label given. train.k.nn Train data batch nearest neighbors using k nearest neighbors. Default 10. used train..bnn TRUE train.k.nn.prop NULL. train.k.nn.prop numeric (higher 0 lower 1) corresponding fraction cells per cluster use train.k.nn nearest neighbors. NULL number train.k.nn nearest neighbors equal train.k.nn. given, train.k.nn parameter ignored train.k.nn calculated based train.k.nn.prop. default 0.3 meaning 30 proportions different divisive clustering rounds can given, otherwise value given . build.train.set Logical specifying training set built data whole data used training. default TRUE. build.train.params list parameters passed function AggregateDataByBatch(). provided build.train.set TRUE. scale.character specifying data scaled cell feature training. Default NULL, .e., data scaled training. use.cluster.seed starting clustering result provided ensure reproducible results (logical). FALSE, ICP run starts total random clustering , thus, independent clustering. default TRUE, .e., clustering result provided based PCA density sampling. batch.label different NULL, PCA density sampling performed batch wise manner. divisive.method Divisive method (character). One \"random\" (randomly sample two clusters every cluster previously found), \"cluster\" \"cluster.batch\" (sample two clusters every cluster previously found based cluster probability distribution across batches per batch). default \"cluster.batch\". batch.label NULL, automatically set cluster. can set random explicitly provided. allow.free.k Allow free k (logical). Allow ICP algorithm decrease k given case find k target clusters. default TRUE. ari.cutoff Include ICP models probability tables Adjusted Rand Index higher ari.cutoff (numeric). default 0.3. value can range 0 (include ) lower 1. verbose logical value print verbose ICP run case parallelization, .e., 'threads' different 1. Default 'FALSE'.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunParallelDivisiveICP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multi-level integration — RunParallelDivisiveICP","text":"SingleCellExperiment object.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunParallelDivisiveICP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multi-level integration — RunParallelDivisiveICP","text":"","code":"# Packages library(\"SingleCellExperiment\")  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Integrated PCA set.seed(125) pbmc_10Xassays <- RunPCA(object = pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4"},{"path":"https://elolab.github.io/Coralysis/reference/RunTSNE.html","id":null,"dir":"Reference","previous_headings":"","what":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding (t-SNE) — RunTSNE","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding (t-SNE) — RunTSNE","text":"Run nonlinear dimensionality reduction using t-SNE PCA-transformed consensus matrix input.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunTSNE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding (t-SNE) — RunTSNE","text":"","code":"RunTSNE.SingleCellExperiment(   object,   dims,   dimred.type,   perplexity,   dimred.name,   ... )  # S4 method for class 'SingleCellExperiment' RunTSNE(   object,   dims = NULL,   dimred.type = \"PCA\",   perplexity = 30,   dimred.name = \"TSNE\",   ... )"},{"path":"https://elolab.github.io/Coralysis/reference/RunTSNE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding (t-SNE) — RunTSNE","text":"object Object SingleCellExperiment class. dims Dimensions select dimred.type. default NULL, .e., dimensions selected. Provide numeric vector select specific range, e.g., dims = 1:10 select first 10 dimensions. dimred.type Dimensional reduction type use. default \"PCA\". perplexity Perplexity t-SNE. dimred.name Dimensional reduction name given returned t-SNE. default \"TSNE\". ... Parameters passed Rtsne function. parameters given match parameters accepted Rtsne function. Check possible parameters ?Rtsne::Rtsne.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunTSNE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding (t-SNE) — RunTSNE","text":"SingleCellExperiment object.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunTSNE.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding (t-SNE) — RunTSNE","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Run t-SNE set.seed(123) pbmc_10Xassays <- RunTSNE(pbmc_10Xassays, dimred.type = \"PCA\")"},{"path":"https://elolab.github.io/Coralysis/reference/RunUMAP.html","id":null,"dir":"Reference","previous_headings":"","what":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"Run nonlinear dimensionality reduction using UMAP dimensional reduction input.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunUMAP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"","code":"RunUMAP.SingleCellExperiment(   object,   dims,   dimred.type,   return.model,   umap.method,   dimred.name,   ... )  # S4 method for class 'SingleCellExperiment' RunUMAP(   object,   dims = NULL,   dimred.type = \"PCA\",   return.model = FALSE,   umap.method = \"umap\",   dimred.name = \"UMAP\",   ... )"},{"path":"https://elolab.github.io/Coralysis/reference/RunUMAP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"object object SingleCellExperiment class. dims Dimensions select dimred.type. default NULL, .e., dimensions selected. Provide numeric vector select specific range, e.g., dims = 1:10 select first 10 dimensions. dimred.type Dimensional reduction type use. default \"PCA\". return.model Return UMAP model. default FALSE. umap.method UMAP method use: \"umap\" \"uwot\". default \"umap\". dimred.name Dimensional reduction name given returned UMAP. default \"UMAP\". ... Parameters passed umap function. parameters given match parameters accepted umap function depending umap.method given. Check possible parameters ?umap::umap ?uwot::umap depending umap.method \"umap\" \"uwot\".","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunUMAP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"SingleCellExperiment object.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/RunUMAP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Run UMAP set.seed(123) pbmc_10Xassays <- RunUMAP(pbmc_10Xassays, dimred.type = \"PCA\")"},{"path":"https://elolab.github.io/Coralysis/reference/SampleClusterBatchProbs.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","title":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","text":"Samples cells based cluster probabilities distribution batch wise","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SampleClusterBatchProbs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","text":"","code":"SampleClusterBatchProbs(cluster, probs, batch, q.split = 0.5)"},{"path":"https://elolab.github.io/Coralysis/reference/SampleClusterBatchProbs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","text":"cluster Clustering cell labels predicted ICP (factor). probs Clustering probabilities predicted ICP (matrix). batch Batch labels corresponding clusters (character factor). q.split Split (cell) batch principal component distribution quantile (numeric). default 0.5, .e., median.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SampleClusterBatchProbs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","text":"factor cell cluster identities.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SampleClusterProbs.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","title":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","text":"Samples cells based cluster probabilities distribution","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SampleClusterProbs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","text":"","code":"SampleClusterProbs(cluster, probs, q.split = 0.5)"},{"path":"https://elolab.github.io/Coralysis/reference/SampleClusterProbs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","text":"cluster Clustering cell labels predicted ICP (factor). probs Clustering probabilities predicted ICP (matrix). q.split Split (cell) batch principal component distribution quantile (numeric). default 0.5, .e., median.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SampleClusterProbs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","text":"factor cell cluster identities.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SamplePCACells.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cells based on principal components distribution — SamplePCACells","title":"Sample cells based on principal components distribution — SamplePCACells","text":"Samples cells based distributions along one principal component","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SamplePCACells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cells based on principal components distribution — SamplePCACells","text":"","code":"SamplePCACells(   data,   batch = NULL,   q.split = 0.5,   p = 30,   use.pc = \"PC1\",   center = TRUE,   scale. = TRUE )"},{"path":"https://elolab.github.io/Coralysis/reference/SamplePCACells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cells based on principal components distribution — SamplePCACells","text":"data Data compute PCA sample cells . Rows columns represent cells features, respectively. batch Batch cell label identity (character) matching cells giving data. Use NULL absence batches. batch given cells sampled batch wise manner, otherwise cells sampled without grouping factor. default NULL. q.split Split (cell) batch principal component distribution quantile (numeric). default 0.5, .e., median. p Number principal components compute (integer). default 30. use.pc principal component used sampling cells per batch. default \"PC1\", .e., first principal component used. center features given data centered performing PCA (logical). default TRUE. scale. features given data scaled performing PCA (logical). default TRUE.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SamplePCACells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cells based on principal components distribution — SamplePCACells","text":"factor cell cluster identities (two clusters).","code":""},{"path":"https://elolab.github.io/Coralysis/reference/Scale.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale a sparse matrix by row or column — Scale","title":"Scale a sparse matrix by row or column — Scale","text":"Faster implementation scale function. diverges scale function performing root-mean-square scale=TRUE center=FALSE. case divides values standard deviation column row used (depending scale.).","code":""},{"path":"https://elolab.github.io/Coralysis/reference/Scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale a sparse matrix by row or column — Scale","text":"","code":"Scale(x, center = TRUE, scale = TRUE, scale.by = \"col\")"},{"path":"https://elolab.github.io/Coralysis/reference/Scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale a sparse matrix by row or column — Scale","text":"x matrix class `dgCMatrix`. center logical. default TRUE. Subtract values row column mean depending `scale.` parameter. scale logical. default TRUE. Divide values row column standard deviation depending `scale.` parameter scale.Scale `row` `col` (=column), .e., use row column mean /standard deviations center /scale data. Default col.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/Scale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale a sparse matrix by row or column — Scale","text":"matrix class `dgCMatrix`.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/ScaleByBatch.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale sparse matrix by features (column) by batch — ScaleByBatch","title":"Scale sparse matrix by features (column) by batch — ScaleByBatch","text":"Scales features batch","code":""},{"path":"https://elolab.github.io/Coralysis/reference/ScaleByBatch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale sparse matrix by features (column) by batch — ScaleByBatch","text":"","code":"ScaleByBatch(x, batch)"},{"path":"https://elolab.github.io/Coralysis/reference/ScaleByBatch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale sparse matrix by features (column) by batch — ScaleByBatch","text":"x matrix class `dgCMatrix`. Cells features (rows x columns). batch character vector batch labels corresponding cells given x. character batch labels need named cells names given rows x.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/ScaleByBatch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale sparse matrix by features (column) by batch — ScaleByBatch","text":"scaled matrix class `dgCMatrix`.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SummariseCellClusterProbability.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"Summarise ICP cell cluster probability table(s)","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SummariseCellClusterProbability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"","code":"SummariseCellClusterProbability.SingleCellExperiment(   object,   icp.run,   icp.round,   funs,   scale.funs,   save.in.sce )  # S4 method for class 'SingleCellExperiment' SummariseCellClusterProbability(   object,   icp.run = NULL,   icp.round = NULL,   funs = c(\"mean\", \"median\"),   scale.funs = TRUE,   save.in.sce = TRUE )"},{"path":"https://elolab.github.io/Coralysis/reference/SummariseCellClusterProbability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"object object SingleCellExperiment class ICP cell cluster probability tables saved metadata(object)$coralysis$joint.probability. running RunParallelDivisiveICP. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability. default NULL, .e., retrieved. Specify numeric vector retrieve specific set tables. icp.round ICP round(s) retrieve metadata(object)$coralysis$joint.probability. default NULL, .e., retrieved. funs Functions summarise ICP cell cluster probability: \"mean\" /\"median\". default c(\"mean\", \"median\"), .e, mean median calculated. Set NULL estimate . scale.funs Scale range 0-1 summarised probability obtained funs. default TRUE, .e., summarised probability scaled 0-1 range. save..sce Save data frame cell metadata SingleCellExperiment object return data frame. default TRUE, .e., summary probabilities retrieved save SCE object colData(object).","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SummariseCellClusterProbability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"data frame SingleCellExperiment object ICP cell cluster probability summarised.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/SummariseCellClusterProbability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Summarise cluster probability pbmc_10Xassays <- SummariseCellClusterProbability(object = pbmc_10Xassays, icp.round = 4, save.in.sce = TRUE) # save result in 'colData'  # Plot the clustering result for ICP run no. 3  PlotDimRed(object = pbmc_10Xassays, color.by = \"icp_run_round_3_4_clusters\")   # Plot Coralysis mean cell cluster probabilities  PlotExpression(object = pbmc_10Xassays, color.by = \"mean_probs\", color.scale = \"viridis\")"},{"path":"https://elolab.github.io/Coralysis/reference/TabulateCellBinsByGroup.html","id":null,"dir":"Reference","previous_headings":"","what":"Tabulate cell bins by group — TabulateCellBinsByGroup","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"Frequency cells per cell cluster probability bin group label. label specified beforehand function BinCellClusterProbability().","code":""},{"path":"https://elolab.github.io/Coralysis/reference/TabulateCellBinsByGroup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"","code":"TabulateCellBinsByGroup.SingleCellExperiment(object, group, relative, margin)  # S4 method for class 'SingleCellExperiment' TabulateCellBinsByGroup(object, group, relative = FALSE, margin = 1)"},{"path":"https://elolab.github.io/Coralysis/reference/TabulateCellBinsByGroup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"object object SingleCellExperiment class obtained function BinCellClusterProbability(). group Character specifying colData variable SingleCellExperiment object provided function BinCellClusterProbability() use categorical group variable. relative Logical specifying relative proportions cell bins per group returned. default FALSE, .e., absolute values returned. margin relative TRUE, proportions calculated : rows (1, default); columns (2); overall (NULL).","code":""},{"path":"https://elolab.github.io/Coralysis/reference/TabulateCellBinsByGroup.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"list tables frequency cells per bin cell cluster probability group label.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/TabulateCellBinsByGroup.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"","code":"# Packages library(\"SingleCellExperiment\")  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1) #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Cell states SCE object for a given cell type annotation or clustering cellstate.sce <- BinCellClusterProbability(object = pbmc_10Xassays, label = \"cell_type\", icp.round = 4, bins = 20)  cellstate.sce #> class: SingleCellExperiment  #> dim: 2000 245  #> metadata(1): coralysis #> assays(1): logcounts #> rownames(2000): LYZ S100A9 ... IGSF8 KIR2DL1 #> rowData names(0): #> colnames(245): B mem_bin1 B mem_bin10 ... pDC_bin8 pDC_bin9 #> colData names(4): label probability_bins aggregated_probability_bins #>   aggregated_label_bins #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):  # Tabulate cell bins by group  # give an interesting variable to the \"group\" parameter instead \"batch\" - given for illustrative purposes only cellbins.tables <- TabulateCellBinsByGroup(object = cellstate.sce, group = \"batch\", relative = TRUE, margin = 1)"},{"path":"https://elolab.github.io/Coralysis/reference/VlnPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualization of feature expression using violin plots — VlnPlot","title":"Visualization of feature expression using violin plots — VlnPlot","text":"VlnPlot function enables visualizing expression levels feature(s), across clusters using violin plots.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/VlnPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualization of feature expression using violin plots — VlnPlot","text":"","code":"VlnPlot.SingleCellExperiment(   object,   clustering.label,   features,   return.plot,   rotate.x.axis.labels )  # S4 method for class 'SingleCellExperiment' VlnPlot(   object,   clustering.label,   features,   return.plot = FALSE,   rotate.x.axis.labels = FALSE )"},{"path":"https://elolab.github.io/Coralysis/reference/VlnPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualization of feature expression using violin plots — VlnPlot","text":"object SingleCellExperiment class clustering.label variable name (class character) available cell metadata colData(object) clustering labels (character factor) use. features Feature names plot cluster (character) matching row.names(object). return.plot return.plot whether return ggplot2 object. Default FALSE. rotate.x.axis.labels logical denoting whether x-axis labels rotated 90 degrees just draw . Default FALSE.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/VlnPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualization of feature expression using violin plots — VlnPlot","text":"ggplot2 object return.plot=TRUE.","code":""},{"path":"https://elolab.github.io/Coralysis/reference/VlnPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualization of feature expression using violin plots — VlnPlot","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 507 493 #> ARI=0.820656512175675 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 305 695 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 229 771 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 215 785 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 397 603 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 507 493 #> projected clustering = 390 610 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 253 247 246 #> projected clustering = 240 251 223 286 #> ARI=0.610512906764122 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 240 251 223 286 #> projected clustering = 178 222 281 319 #> ARI=0.624701443134292 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 178 222 281 319 #> projected clustering = 178 220 261 341 #> ARI=0.92549568249167 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 220 261 341 #> projected clustering = 178 223 242 357 #> ARI=0.942882446336459 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 242 357 #> projected clustering = 179 224 243 354 #> ARI=0.965384950223849 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 235 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 223 228 370 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 176 223 233 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 179 224 226 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 224 243 354 #> projected clustering = 181 219 231 369 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 112 122 121 178 176 #> projected clustering = 75 102 79 142 120 132 152 198 #> ARI=0.556620816299057 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 102 79 142 120 132 152 198 #> projected clustering = 58 116 58 164 110 139 141 214 #> ARI=0.684965717343665 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 116 58 164 110 139 141 214 #> projected clustering = 49 130 44 173 112 137 146 209 #> ARI=0.787852864331197 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 49 130 44 173 112 137 146 209 #> projected clustering = 49 135 33 184 108 140 108 243 #> ARI=0.823146690674369 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 49 135 33 184 108 140 108 243 #> projected clustering = 29 151 17 198 107 139 96 263 #> ARI=0.885166773941308 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 29 151 17 198 107 139 96 263 #> projected clustering = 24 155 8 211 113 128 93 268 #> ARI=0.912600794577665 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 24 155 8 211 113 128 93 268 #> projected clustering = 20 159 4 214 110 125 97 271 #> ARI=0.933592238687329 #> probability matrix dimensions = 1000 8 #> k 8 decreased to 7 #> EPOCH: 8 #> current clustering = 20 159 4 214 110 125 97 271 #> projected clustering = 13 168 0 219 105 118 106 271 #> ARI=0.936239315867647 #> probability matrix dimensions = 1000 7 #> EPOCH: 9 #> current clustering = 13 168 0 219 105 118 106 271 #> projected clustering = 7 176 0 220 98 115 115 269 #> ARI=0.957108984439776 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 8 176 0 220 134 140 322 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 246 0 222 233 109 103 80 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 181 0 219 107 137 95 254 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 180 0 220 121 143 329 0 #> probability matrix dimensions = 1000 7 #> EPOCH: 10 #> current clustering = 7 176 0 220 98 115 115 269 #> projected clustering = 7 177 0 219 112 134 0 351 #> probability matrix dimensions = 1000 14 #> k 16 decreased to 14 #> EPOCH: 1 #> current clustering = 4 3 88 88 110 110 49 49 58 57 58 57 135 134 #> projected clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> ARI=0.58411256789772 #> probability matrix dimensions = 1000 14 #> EPOCH: 2 #> current clustering = 6 3 64 109 125 95 37 58 48 73 48 70 83 181 #> projected clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> ARI=0.72343379957138 #> probability matrix dimensions = 1000 14 #> EPOCH: 3 #> current clustering = 2 3 58 120 148 73 19 64 44 74 48 69 57 221 #> projected clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> ARI=0.842885763011903 #> probability matrix dimensions = 1000 14 #> EPOCH: 4 #> current clustering = 2 4 53 129 160 60 11 67 39 77 47 78 27 246 #> projected clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> ARI=0.881473686553216 #> probability matrix dimensions = 1000 14 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 1 3 44 140 175 45 1 85 35 81 47 72 3 268 #> probability matrix dimensions = 1000 12 #> k 14 decreased to 11 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 0 0 41 144 182 36 0 83 35 80 49 65 1 284 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 5 0 55 129 175 46 4 112 38 87 49 299 0 1 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 3 0 32 152 166 52 1 94 29 91 48 66 1 265 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 3 2 50 129 164 55 5 77 40 80 53 73 10 259 #> projected clustering = 2 4 32 148 169 54 0 183 38 80 29 260 0 1 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.881473686553216. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.827927761718037 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 270 730 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 246 257 209 288 #> ARI=0.622891971970668 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 180 223 268 329 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 199 236 225 340 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 187 219 260 334 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 246 257 209 288 #> projected clustering = 247 233 181 339 #> ARI=0.687965646662765 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 247 233 181 339 #> projected clustering = 180 222 251 347 #> ARI=0.774904992388955 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 180 222 251 347 #> projected clustering = 177 222 255 346 #> ARI=0.960996154214872 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 222 255 346 #> projected clustering = 176 222 260 342 #> ARI=0.969913976759884 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 180 223 242 355 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 177 224 236 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 235 362 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 178 222 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 260 342 #> projected clustering = 179 224 221 376 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 89 87 112 110 131 129 172 170 #> projected clustering = 97 80 102 119 131 128 153 190 #> ARI=0.568622246023177 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 97 80 102 119 131 128 153 190 #> projected clustering = 91 81 114 109 151 98 126 230 #> ARI=0.686240575186566 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 62 110 143 81 173 70 78 283 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 58 119 158 63 183 63 43 313 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 108 149 67 189 58 32 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 64 118 177 40 189 58 30 324 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 91 81 114 109 151 98 126 230 #> projected clustering = 71 103 113 110 140 85 269 109 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 46 45 41 40 58 56 55 54 76 75 49 49 64 62 115 115 #> projected clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> ARI=0.431400621805209 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 39 48 51 38 65 60 39 57 79 70 39 57 98 70 101 89 #> projected clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> ARI=0.572354136280868 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 39 49 58 31 76 52 45 47 93 57 21 61 117 50 107 97 #> projected clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> ARI=0.667388469573626 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 12 57 94 20 93 49 39 38 99 56 40 39 168 26 72 98 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 4 55 112 10 113 42 29 37 106 51 47 39 209 23 42 81 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 61 109 5 116 38 28 40 136 51 18 45 174 20 77 79 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 3 62 111 3 126 36 18 41 110 77 11 32 197 25 72 76 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 21 62 67 27 85 53 42 39 96 52 28 53 137 39 98 101 #> projected clustering = 1 68 115 0 150 14 11 40 119 75 5 51 75 21 151 104 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.667388469573626. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 366 634 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 225 775 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 222 778 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 437 563 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 218 263 238 281 #> ARI=0.547419100706512 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 218 263 238 281 #> projected clustering = 181 224 270 325 #> ARI=0.595431627480682 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 181 224 270 325 #> projected clustering = 178 224 249 349 #> ARI=0.905857968903036 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 224 249 349 #> projected clustering = 178 223 246 353 #> ARI=0.969058057702433 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 177 223 240 360 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 178 223 246 353 #> projected clustering = 176 222 242 360 #> ARI=0.969134899530728 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 223 237 363 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 235 366 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 224 209 390 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 178 221 207 394 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 176 222 242 360 #> projected clustering = 177 222 202 399 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 112 110 121 121 181 179 #> projected clustering = 75 105 92 132 119 134 98 245 #> ARI=0.568200181254668 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 75 105 92 132 119 134 98 245 #> projected clustering = 59 113 71 152 123 131 57 294 #> ARI=0.685724669992193 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 59 113 71 152 123 131 57 294 #> projected clustering = 52 120 54 168 113 140 25 328 #> ARI=0.820816888848888 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 52 120 54 168 113 140 25 328 #> projected clustering = 54 121 39 182 114 140 22 328 #> ARI=0.927983947210822 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 54 121 39 182 114 140 22 328 #> projected clustering = 55 122 36 183 107 144 23 330 #> ARI=0.960498040121679 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 55 122 36 183 107 144 23 330 #> projected clustering = 56 122 35 182 108 144 21 332 #> ARI=0.967877933136761 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 56 122 35 182 108 144 21 332 #> projected clustering = 58 121 34 182 111 139 23 332 #> ARI=0.977289780897713 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 58 121 34 182 111 139 23 332 #> projected clustering = 59 119 35 182 106 142 26 331 #> ARI=0.97753652193791 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 55 119 36 184 104 141 23 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 117 34 183 106 148 26 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 119 35 185 104 139 21 341 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 56 120 35 184 104 141 22 338 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 59 119 35 182 106 142 26 331 #> projected clustering = 58 120 36 185 107 139 19 336 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 30 29 60 59 18 17 92 90 54 52 72 70 14 12 166 165 #> projected clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> ARI=0.511814242302804 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 23 42 44 74 22 16 70 109 59 55 43 95 16 20 152 160 #> projected clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> ARI=0.659280276359074 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 15 44 24 99 27 8 47 137 50 57 20 121 13 12 185 141 #> projected clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> ARI=0.809505849162123 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 4 #> current clustering = 8 42 11 115 33 2 29 157 47 56 7 134 6 10 201 142 #> projected clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> ARI=0.879548480596558 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 1 51 4 124 38 0 11 169 47 46 0 144 0 4 361 0 #> probability matrix dimensions = 1000 13 #> k 12 decreased to 9 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 72 0 141 36 0 1 189 59 143 3 356 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 0 26 3 151 36 0 1 181 22 66 0 159 0 3 204 148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 4 281 3 130 35 0 0 186 111 89 0 161 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 5 #> current clustering = 4 48 3 125 36 0 16 168 46 60 4 137 1 10 206 136 #> projected clustering = 2 40 0 141 59 0 8 174 117 115 0 0 0 0 307 37 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.879548480596558. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 502 498 #> ARI=0.809809622287621 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 328 672 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 220 780 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 221 779 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 502 498 #> projected clustering = 218 782 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 251 251 249 249 #> projected clustering = 259 248 202 291 #> ARI=0.579689086990992 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 259 248 202 291 #> projected clustering = 186 224 244 346 #> ARI=0.601942119579158 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 186 224 244 346 #> projected clustering = 178 223 247 352 #> ARI=0.81992922272261 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 178 223 247 352 #> projected clustering = 179 223 241 357 #> ARI=0.968378042035475 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 225 211 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 181 221 211 387 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 182 222 184 412 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 180 220 186 414 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 223 241 357 #> projected clustering = 176 223 141 460 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 112 111 121 120 179 178 #> projected clustering = 74 114 79 140 126 136 92 239 #> ARI=0.531440715127228 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 74 114 79 140 126 136 92 239 #> projected clustering = 52 128 47 169 126 138 47 293 #> ARI=0.710471973200468 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 128 47 169 126 138 47 293 #> projected clustering = 32 147 35 182 116 137 37 314 #> ARI=0.849902032408299 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 32 147 35 182 116 137 37 314 #> projected clustering = 19 161 58 156 114 137 36 319 #> ARI=0.893796846587781 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 19 161 58 156 114 137 36 319 #> projected clustering = 14 165 101 117 109 135 35 324 #> ARI=0.89771134672335 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 14 165 101 117 109 135 35 324 #> projected clustering = 12 168 136 85 114 133 33 319 #> ARI=0.910087550870021 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 12 168 136 85 114 133 33 319 #> projected clustering = 9 173 161 59 108 132 26 332 #> ARI=0.910645783074883 #> probability matrix dimensions = 1000 8 #> EPOCH: 8 #> current clustering = 9 173 161 59 108 132 26 332 #> projected clustering = 9 173 170 50 128 116 23 331 #> ARI=0.943114154784047 #> probability matrix dimensions = 1000 8 #> EPOCH: 9 #> current clustering = 9 173 170 50 128 116 23 331 #> projected clustering = 8 177 175 42 136 111 21 330 #> ARI=0.965229775478377 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 6 178 179 38 136 110 20 333 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 178 185 34 133 118 15 332 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 181 183 34 133 120 16 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 5 180 184 33 131 123 17 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 10 #> current clustering = 8 177 175 42 136 111 21 330 #> projected clustering = 4 178 184 34 133 123 13 331 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> ARI=0.526606265454719 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 7 3 79 96 61 111 27 20 40 97 48 64 14 19 101 213 #> projected clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> ARI=0.693528104269222 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 7 1 69 103 50 125 33 11 31 109 48 64 5 12 68 264 #> projected clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> ARI=0.810663045265528 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 12 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 6 0 68 113 6 178 35 0 31 147 33 71 0 5 307 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 5 0 33 152 25 157 35 2 35 186 33 78 0 10 0 249 #> probability matrix dimensions = 1000 13 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 4 0 85 93 27 156 36 0 35 133 24 82 0 0 19 306 #> probability matrix dimensions = 1000 12 #> k 12 decreased to 10 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 11 201 23 154 41 0 34 419 39 71 0 0 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 8 0 60 112 33 144 38 5 32 112 41 69 1 9 49 287 #> projected clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> ARI=0.83043783423148 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 6 0 51 136 8 175 37 0 40 423 13 81 0 0 30 0 #> probability matrix dimensions = 1000 11 #> EPOCH: 5 #> current clustering = 7 0 52 120 18 163 39 0 36 128 24 76 0 0 18 319 #> projected clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> ARI=0.838032403500304 #> probability matrix dimensions = 1000 9 #> k 10 decreased to 8 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 2 0 0 251 11 169 40 0 60 461 6 0 0 0 0 0 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 8 0 3 187 10 170 49 0 163 26 7 0 0 0 0 377 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 3 0 1 448 11 174 65 0 84 203 9 0 0 0 0 2 #> probability matrix dimensions = 1000 10 #> EPOCH: 6 #> current clustering = 5 0 13 161 13 168 66 0 45 165 23 0 0 0 0 341 #> projected clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> ARI=0.853843724755049 #> probability matrix dimensions = 1000 7 #> k 8 decreased to 7 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 2 0 0 344 12 171 40 0 11 420 0 0 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 6 #> EPOCH: 7 #> current clustering = 4 0 0 183 11 169 54 0 31 205 11 0 0 0 0 332 #> projected clustering = 6 0 0 168 9 172 67 0 0 0 0 0 0 0 0 578 #> probability matrix dimensions = 1000 5 #> k decreased, starting from the beginning... consider increasing d to 0.5 and C to 1 or increasing the ICP batch size and check the input data (scaled dense data might cause problems) #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 5 3 89 88 88 87 22 20 69 67 56 55 11 10 165 165 #> projected clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> ARI=0.519251941347066 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 6 3 69 106 75 96 26 22 58 81 43 63 19 18 114 201 #> projected clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> ARI=0.693838711791634 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 4 3 57 119 71 108 21 19 51 100 30 73 7 11 126 200 #> projected clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> ARI=0.735657791383824 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 3 3 54 123 60 121 26 12 48 102 26 78 5 6 168 165 #> projected clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> ARI=0.7997876483612 #> probability matrix dimensions = 1000 15 #> EPOCH: 5 #> current clustering = 5 3 50 126 48 132 33 5 47 118 19 77 2 0 189 146 #> projected clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> ARI=0.834231415504474 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 3 36 141 22 157 38 0 51 114 5 81 1 0 348 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 2 0 45 167 14 166 38 0 118 364 3 83 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 26 150 14 171 37 0 45 152 0 86 0 0 229 87 #> probability matrix dimensions = 1000 11 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 22 177 12 169 39 0 53 435 0 90 0 0 0 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 3 2 43 134 36 146 38 0 52 120 10 78 2 0 205 131 #> projected clustering = 3 0 28 147 33 147 54 0 102 158 0 0 0 0 194 134 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.834231415504474. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Plot features by cell type (give a clustering instead) genes <- c(\"CD8A\", \"CCR7\", \"GZMA\", \"MS4A1\", \"CD27\") VlnPlot(pbmc_10Xassays, clustering.label = \"cell_type\", features = genes, rotate.x.axis.labels = TRUE)"},{"path":"https://elolab.github.io/Coralysis/reference/pbmc_10Xassays.html","id":null,"dir":"Reference","previous_headings":"","what":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"Two 10X PBMCs 3' assays, V1 V2, downsampled 2K cells (1K per assay). datasets downloaded 10X website (see source ). PBMC dataset V1 corresponds sample pbmc6k V2 pbmc8k. Cells annotated using annotations provided Korsunsky et al., 2019 (PMID:31740819; Source Data Figure 4 file).","code":""},{"path":"https://elolab.github.io/Coralysis/reference/pbmc_10Xassays.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"","code":"data(pbmc_10Xassays) pbmc_10Xassays"},{"path":"https://elolab.github.io/Coralysis/reference/pbmc_10Xassays.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"SCE object","code":""},{"path":"https://elolab.github.io/Coralysis/reference/pbmc_10Xassays.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/pbmc6k https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc8k","code":""},{"path":"https://elolab.github.io/Coralysis/reference/pbmc_10Xassays.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"","code":"data(pbmc_10Xassays) pbmc_10Xassays #> class: SingleCellExperiment  #> dim: 2000 2000  #> metadata(0): #> assays(2): counts logcounts #> rownames(2000): LYZ S100A9 ... IGSF8 KIR2DL1 #> rowData names(8): highly_variable mean ... FDR per.block #> colnames(2000): ACATACCTGTCAAC ATTGAAACTCGTAG ... AGAGTGGCAGGGTTAG #>   GACTGCGAGCGTTCCG #> colData names(3): barcode batch cell_type #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):"}]
