<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Differential expression between cell clusters — FindClusterMarkers • Coralysis</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Differential expression between cell clusters — FindClusterMarkers"><meta name="description" content="FindClusterMarkers enables identifying feature markers for one
cluster or two arbitrary combinations of clusters, e.g. 1_2 vs. 3_4_5. Feature
and cell filters can be applied to accelerate the analysis, but this might
lead to missing weak signals."><meta property="og:description" content="FindClusterMarkers enables identifying feature markers for one
cluster or two arbitrary combinations of clusters, e.g. 1_2 vs. 3_4_5. Feature
and cell filters can be applied to accelerate the analysis, but this might
lead to missing weak signals."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Coralysis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/Coralysis.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/01_Integration.html">Integration</a></li>
    <li><a class="dropdown-item" href="../articles/02_RefMap.html">Reference-mapping</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/elolab/Coralysis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Differential expression between cell clusters</h1>
      <small class="dont-index">Source: <a href="https://github.com/elolab/Coralysis/blob/main/R/CoreMethods.R" class="external-link"><code>R/CoreMethods.R</code></a></small>
      <div class="d-none name"><code>FindClusterMarkers.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>FindClusterMarkers</code> enables identifying feature markers for one
cluster or two arbitrary combinations of clusters, e.g. 1_2 vs. 3_4_5. Feature
and cell filters can be applied to accelerate the analysis, but this might
lead to missing weak signals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FindClusterMarkers.SingleCellExperiment</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">clustering.label</span>,</span>
<span>  <span class="va">clusters.1</span>,</span>
<span>  <span class="va">clusters.2</span>,</span>
<span>  <span class="va">test</span>,</span>
<span>  <span class="va">log2fc.threshold</span>,</span>
<span>  <span class="va">min.pct</span>,</span>
<span>  <span class="va">min.diff.pct</span>,</span>
<span>  <span class="va">min.cells.group</span>,</span>
<span>  <span class="va">max.cells.per.cluster</span>,</span>
<span>  <span class="va">return.thresh</span>,</span>
<span>  <span class="va">only.pos</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SingleCellExperiment'</span></span>
<span><span class="fu">FindClusterMarkers</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">clustering.label</span>,</span>
<span>  clusters.1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clusters.2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  test <span class="op">=</span> <span class="st">"wilcox"</span>,</span>
<span>  log2fc.threshold <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  min.pct <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  min.diff.pct <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min.cells.group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  max.cells.per.cluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return.thresh <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  only.pos <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <code>SingleCellExperiment</code> object.</p></dd>


<dt id="arg-clustering-label">clustering.label<a class="anchor" aria-label="anchor" href="#arg-clustering-label"></a></dt>
<dd><p>A variable name (of class <code>character</code>) available
in the cell metadata <code>colData(object)</code> with the clustering labels
(<code>character</code> or <code>factor</code>) to use.</p></dd>


<dt id="arg-clusters-">clusters.1<a class="anchor" aria-label="anchor" href="#arg-clusters-"></a></dt>
<dd><p>a character or numeric vector denoting which clusters
to use in the first group (named group.1 in the results)</p></dd>


<dt id="arg-clusters-">clusters.2<a class="anchor" aria-label="anchor" href="#arg-clusters-"></a></dt>
<dd><p>a character or numeric vector denoting which clusters
to use in the second group (named group.2 in the results)</p></dd>


<dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>Which test to use. Only "wilcoxon" (the Wilcoxon rank-sum test,
AKA Mann-Whitney U test) is supported at the moment.</p></dd>


<dt id="arg-log-fc-threshold">log2fc.threshold<a class="anchor" aria-label="anchor" href="#arg-log-fc-threshold"></a></dt>
<dd><p>Filters out features that have log2 fold-change of the
averaged feature expression values below this threshold.
Default is <code>0.25</code>.</p></dd>


<dt id="arg-min-pct">min.pct<a class="anchor" aria-label="anchor" href="#arg-min-pct"></a></dt>
<dd><p>Filters out features that have dropout rate (fraction of cells
expressing a feature) below this threshold in both comparison groups
Default is <code>0.1</code>.</p></dd>


<dt id="arg-min-diff-pct">min.diff.pct<a class="anchor" aria-label="anchor" href="#arg-min-diff-pct"></a></dt>
<dd><p>Filters out features that do not have this minimum
difference in the dropout rates (fraction of cells expressing a feature)
between the two comparison groups. Default is <code>NULL</code>.</p></dd>


<dt id="arg-min-cells-group">min.cells.group<a class="anchor" aria-label="anchor" href="#arg-min-cells-group"></a></dt>
<dd><p>The minimum number of cells in the two comparison
groups to perform the DE analysis. If the number of cells is below the
threshold, then the DE analysis is not performed.
Default is <code>3</code>.</p></dd>


<dt id="arg-max-cells-per-cluster">max.cells.per.cluster<a class="anchor" aria-label="anchor" href="#arg-max-cells-per-cluster"></a></dt>
<dd><p>The maximun number of cells per cluster
if downsampling is performed to speed up the DE analysis.
Default is <code>NULL</code>, i.e. no downsampling.</p></dd>


<dt id="arg-return-thresh">return.thresh<a class="anchor" aria-label="anchor" href="#arg-return-thresh"></a></dt>
<dd><p>If only.pos=TRUE, then return only features that
have the adjusted p-value (adjusted by the Bonferroni method) below or
equal to this threshold.  Default is <code>0.01</code>.</p></dd>


<dt id="arg-only-pos">only.pos<a class="anchor" aria-label="anchor" href="#arg-only-pos"></a></dt>
<dd><p>Whether to return only features that have an adjusted
p-value (adjusted by the Bonferroni method) below or equal to the
threshold. Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a data frame of the results if positive results were found, else NULL</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Import package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"SingleCellExperiment"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create toy SCE data</span></span></span>
<span class="r-in"><span><span class="va">batches</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b1"</span>, <span class="st">"b2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">239</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">batch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">batches</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span>assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>logcounts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,  </span></span>
<span class="r-in"><span>                            colData <span class="op">=</span> <span class="fu">DataFrame</span><span class="op">(</span><span class="st">"Species"</span> <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, </span></span>
<span class="r-in"><span>                                               <span class="st">"Batch"</span> <span class="op">=</span> <span class="va">batch</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"samp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Markers between versicolor vs virginica</span></span></span>
<span class="r-in"><span><span class="va">dge</span> <span class="op">&lt;-</span> <span class="fu">FindClusterMarkers</span><span class="op">(</span><span class="va">sce</span>, clustering.label <span class="op">=</span> <span class="st">"Species"</span>, </span></span>
<span class="r-in"><span>                          clusters.1 <span class="op">=</span> <span class="st">"versicolor"</span>, </span></span>
<span class="r-in"><span>                          clusters.2 <span class="op">=</span> <span class="st">"virginica"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> testing cluster group.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 features left after min.pct filtering</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 features left after min.diff.pct filtering</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 features left after log2fc.threshold filtering</span>
<span class="r-in"><span><span class="va">dge</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   p.value  adj.p.value log2FC pct.1 pct.2 diff.pct       marker</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Length 5.869006e-07 2.347603e-06 -0.652     1     1        0 Sepal.Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length 9.133545e-17 3.653418e-16 -1.292     1     1        0 Petal.Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Width  9.698045e-17 3.879218e-16 -0.700     1     1        0  Petal.Width</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by António Sousa, Johannes Smolander, Sini Junttila, Laura L Elo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

