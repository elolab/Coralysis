[{"path":"/articles/01_QuickStart.html","id":"integration","dir":"Articles","previous_headings":"","what":"Integration","title":"Integration & reference-mapping","text":"Check data looks integrating.  Run integration Coralysis. Provide batch label column name colData(pbmc_10Xassays) parameter batch.label.","code":"# Packages library(\"SingleCellExperiment\") library(\"Coralysis\") library(\"scater\") library(\"ggplot2\") #library(\"scran\")  #library(\"cowplot\") # Import data distributed with Coralysis data(\"pbmc_10Xassays\") # it imports object as sce pbmc_10Xassays ## class: SingleCellExperiment  ## dim: 2000 2000  ## metadata(0): ## assays(2): counts logcounts ## rownames(2000): LYZ S100A9 ... IGSF8 KIR2DL1 ## rowData names(8): highly_variable mean ... FDR per.block ## colnames(2000): ACATACCTGTCAAC ATTGAAACTCGTAG ... AGAGTGGCAGGGTTAG ##   GACTGCGAGCGTTCCG ## colData names(3): barcode batch cell_type ## reducedDimNames(0): ## mainExpName: NULL ## altExpNames(0): # Compute PCA & TSNE set.seed(123) pbmc_10Xassays <- RunPCA(object = pbmc_10Xassays, assay.name = \"logcounts\", p = 30, dimred.name = \"unintPCA\") set.seed(123) pbmc_10Xassays <- RunTSNE(pbmc_10Xassays, dimred.type = \"unintPCA\", dimred.name = \"unintTSNE\")  # Plot TSNE highlighting the batch & cell type unint.batch.plot <- PlotDimRed(object = pbmc_10Xassays, color.by = \"batch\",                                 dimred = \"unintTSNE\", point.size = 0.01,                                 legend.nrow = 1, seed.color = 1024) unint.cell.plot <- PlotDimRed(object = pbmc_10Xassays, color.by = \"cell_type\",                                 dimred = \"unintTSNE\", point.size = 0.01,                                 legend.nrow = 4, seed.color = 7) cowplot::plot_grid(unint.batch.plot, unint.cell.plot, ncol = 2, align = \"vh\") # Perform integration with Coralysis set.seed(1024) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", threads = 4) ##  ## Building training set... ## Training set successfully built. ##  ## Computing cluster seed. ## Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE ## or useNames = FALSE. ##  ## Initializing divisive ICP clustering... ##    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   2%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   6%   |                                                                               |======                                                                |   8%   |                                                                               |=======                                                               |  10%   |                                                                               |=========                                                             |  12%   |                                                                               |==========                                                            |  14%   |                                                                               |===========                                                           |  16%   |                                                                               |=============                                                         |  18%   |                                                                               |==============                                                        |  20%   |                                                                               |================                                                      |  22%   |                                                                               |=================                                                     |  24%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  31%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  35%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  39%   |                                                                               |=============================                                         |  41%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  45%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  49%   |                                                                               |====================================                                  |  51%   |                                                                               |=====================================                                 |  53%   |                                                                               |=======================================                               |  55%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  59%   |                                                                               |===========================================                           |  61%   |                                                                               |============================================                          |  63%   |                                                                               |==============================================                        |  65%   |                                                                               |===============================================                       |  67%   |                                                                               |=================================================                     |  69%   |                                                                               |==================================================                    |  71%   |                                                                               |===================================================                   |  73%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  78%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  82%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  88%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  92%   |                                                                               |==================================================================    |  94%   |                                                                               |===================================================================   |  96%   |                                                                               |===================================================================== |  98%   |                                                                               |======================================================================| 100% ##  ## Divisive ICP clustering completed successfully. ##  ## Predicting cell cluster probabilities using ICP models... ## 'as(<matrix>, \"dgRMatrix\")' is deprecated. ## Use 'as(as(as(., \"dMatrix\"), \"generalMatrix\"), \"RsparseMatrix\")' instead. ## See help(\"Deprecated\") and help(\"Matrix-deprecated\"). ## Prediction of cell cluster probabilities completed successfully. ##  ## Multi-level integration completed successfully. # Compute PCA with joint cluster probabilities & TSNE set.seed(123) pbmc_10Xassays <- RunPCA(pbmc_10Xassays, assay.name = \"joint.probability\", dimred.name = \"intPCA\") ## Divisive ICP: selecting ICP tables multiple of 4 set.seed(123) pbmc_10Xassays <- RunTSNE(pbmc_10Xassays, dimred.type = \"intPCA\", dimred.name = \"intTSNE\")  # Plot TSNE highlighting the batch & cell type int.batch.plot <- PlotDimRed(object = pbmc_10Xassays, color.by = \"batch\",                               dimred = \"intTSNE\", point.size = 0.01,                               legend.nrow = 1, seed.color = 1024) int.cell.plot <- PlotDimRed(object = pbmc_10Xassays, color.by = \"cell_type\",                              dimred = \"intTSNE\", point.size = 0.01,                              legend.nrow = 4, seed.color = 7) cowplot::plot_grid(int.batch.plot, int.cell.plot, ncol = 2, align = \"vh\")"},{"path":"/articles/01_QuickStart.html","id":"graph-based-clustering-on-the-integrated-pca","dir":"Articles","previous_headings":"","what":"Graph-based clustering on the integrated PCA","title":"Integration & reference-mapping","text":"","code":"# Graph-based clustering on the integrated PCA w/ 'scran' package set.seed(123) pbmc_10Xassays$cluster <- scran::clusterCells(pbmc_10Xassays, use.dimred = \"intPCA\",                                                BLUSPARAM = bluster::SNNGraphParam(k = 15, cluster.fun = \"louvain\"))  # Plot clustering clt.plot <- PlotDimRed(object = pbmc_10Xassays, color.by = \"cluster\", dimred = \"intTSNE\",                         point.size = 0.01, legend.nrow = 3, seed.color = 65) cowplot::plot_grid(int.batch.plot, int.cell.plot, clt.plot, ncol = 3, align = \"h\")"},{"path":"/articles/01_QuickStart.html","id":"cluster-markers","dir":"Articles","previous_headings":"","what":"Cluster markers","title":"Integration & reference-mapping","text":"","code":"# Cluster markers  cluster.markers <- FindAllClusterMarkers(object = pbmc_10Xassays, clustering.label = \"cluster\") ## ----------------------------------- ## testing cluster 1 ## 1125 features left after min.pct filtering ## 1125 features left after min.diff.pct filtering ## 219 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 2 ## 1213 features left after min.pct filtering ## 1213 features left after min.diff.pct filtering ## 283 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 3 ## 1184 features left after min.pct filtering ## 1184 features left after min.diff.pct filtering ## 429 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 4 ## 1186 features left after min.pct filtering ## 1186 features left after min.diff.pct filtering ## 448 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 5 ## 1189 features left after min.pct filtering ## 1189 features left after min.diff.pct filtering ## 278 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 6 ## 1125 features left after min.pct filtering ## 1125 features left after min.diff.pct filtering ## 286 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 7 ## 1193 features left after min.pct filtering ## 1193 features left after min.diff.pct filtering ## 190 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 8 ## 1140 features left after min.pct filtering ## 1140 features left after min.diff.pct filtering ## 392 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 9 ## 1219 features left after min.pct filtering ## 1219 features left after min.diff.pct filtering ## 364 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 10 ## 1141 features left after min.pct filtering ## 1141 features left after min.diff.pct filtering ## 280 features left after log2fc.threshold filtering ## ----------------------------------- ## ----------------------------------- ## testing cluster 11 ## 1210 features left after min.pct filtering ## 1210 features left after min.diff.pct filtering ## 346 features left after log2fc.threshold filtering ## ----------------------------------- # Select the top 3 positive markers per cluster  top3.markers <- lapply(X = split(x = cluster.markers, f = cluster.markers$cluster), FUN = function(x) {     head(x[order(x$log2FC, decreasing = TRUE),], n = 3) }) top3.markers <- do.call(rbind, top3.markers) top3.markers <- top3.markers[order(as.numeric(top3.markers$cluster)),]  # Heatmap of the top 3 positive markers per cluster HeatmapFeatures(object = pbmc_10Xassays, clustering.label = \"cluster\",                  features = top3.markers$marker)"},{"path":"/articles/01_QuickStart.html","id":"dge","dir":"Articles","previous_headings":"","what":"DGE","title":"Integration & reference-mapping","text":"Coralysis able separate CD8 effector T cells two clusters: 7 10. differential expression analysis , clear cluster 10 cytotoxic similar NK cells cluster 7.","code":"# DGE analysis: cluster 7 vs 10 dge.clt7vs10 <- FindClusterMarkers(pbmc_10Xassays, clustering.label = \"cluster\",                                     clusters.1 = \"7\", clusters.2 = \"10\") ## testing cluster group.1 ## 1113 features left after min.pct filtering ## 1113 features left after min.diff.pct filtering ## 191 features left after log2fc.threshold filtering head(dge.clt7vs10[order(abs(dge.clt7vs10$log2FC), decreasing = TRUE),]) ##             p.value  adj.p.value    log2FC      pct.1     pct.2  diff.pct ## GZMH   8.414945e-48 1.682989e-44 -2.905334 0.15246637 1.0000000 0.8475336 ## NKG7   1.252970e-28 2.505941e-25 -1.988487 0.78475336 1.0000000 0.2152466 ## GZMB   5.329866e-38 1.065973e-34 -1.976993 0.06278027 0.7777778 0.7149975 ## LTB    1.889206e-21 3.778412e-18  1.848061 0.85650224 0.2222222 0.6342800 ## GZMK   1.956057e-22 3.912113e-19  1.817744 0.79820628 0.1111111 0.6870952 ## FGFBP2 9.881937e-30 1.976387e-26 -1.711501 0.11659193 0.7500000 0.6334081 ##        marker ## GZMH     GZMH ## NKG7     NKG7 ## GZMB     GZMB ## LTB       LTB ## GZMK     GZMK ## FGFBP2 FGFBP2 top6.degs <- head(dge.clt7vs10[order(abs(dge.clt7vs10$log2FC), decreasing = TRUE),\"marker\"]) exp.plots <- lapply(X = top6.degs, FUN = function(x) {     PlotExpression(object = pbmc_10Xassays, color.by = x, scale.values = TRUE, point.size = 0.5, point.stroke = 0.5) }) cowplot::plot_grid(plotlist = exp.plots, align = \"vh\", ncol = 6)"},{"path":"/articles/01_QuickStart.html","id":"reference-mapping","dir":"Articles","previous_headings":"","what":"Reference-mapping","title":"Integration & reference-mapping","text":"Perform reference-mapping Coralysis,","code":"## Reference-mapping # Split the SCE object by 'batch' reducedDims(pbmc_10Xassays) <- list() # remove dimensional reductions  ref <- pbmc_10Xassays[,pbmc_10Xassays$batch==\"V2\"] # let V2 assay batch be the reference data set query <- pbmc_10Xassays[,pbmc_10Xassays$batch==\"V1\"] # let V1 be the query (unknown annotations)  # 1) Train the reference  set.seed(123) ref <- RunParallelDivisiveICP(object = ref, divisive.method = \"cluster\",                                threads = 4) # runs without 'batch.label' as it represents 1 sample only ##  ## Building training set... ## Training set successfully built. ##  ## Computing cluster seed. ## Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE ## or useNames = FALSE. ##  ## Initializing divisive ICP clustering... ##    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   2%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   6%   |                                                                               |======                                                                |   8%   |                                                                               |=======                                                               |  10%   |                                                                               |=========                                                             |  12%   |                                                                               |==========                                                            |  14%   |                                                                               |===========                                                           |  16%   |                                                                               |=============                                                         |  18%   |                                                                               |==============                                                        |  20%   |                                                                               |================                                                      |  22%   |                                                                               |=================                                                     |  24%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  31%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  35%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  39%   |                                                                               |=============================                                         |  41%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  45%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  49%   |                                                                               |====================================                                  |  51%   |                                                                               |=====================================                                 |  53%   |                                                                               |=======================================                               |  55%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  59%   |                                                                               |===========================================                           |  61%   |                                                                               |============================================                          |  63%   |                                                                               |==============================================                        |  65%   |                                                                               |===============================================                       |  67%   |                                                                               |=================================================                     |  69%   |                                                                               |==================================================                    |  71%   |                                                                               |===================================================                   |  73%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  78%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  82%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  88%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  92%   |                                                                               |==================================================================    |  94%   |                                                                               |===================================================================   |  96%   |                                                                               |===================================================================== |  98%   |                                                                               |======================================================================| 100% ##  ## Divisive ICP clustering completed successfully. ##  ## Predicting cell cluster probabilities using ICP models... ## Prediction of cell cluster probabilities completed successfully. ##  ## Multi-level integration completed successfully. # 2) Compute reference PCA & UMAP ref <- RunPCA(ref, return.model = TRUE, pca.method = \"stats\") ## Divisive ICP: selecting ICP tables multiple of 4 set.seed(123) ref <- RunUMAP(ref, return.model = TRUE)  # 3) Project & predict query cell labels  set.seed(1024) map <- ReferenceMapping(ref = ref, query = query, ref.label = \"cell_type\",                          project.umap = TRUE, dimred.name.prefix = \"ref\")  # Calculate accuracy preds_x_truth <- table(map$coral_labels, map$cell_type) preds_x_truth ##                  ##                  aDC B mem B naive CD4 mem CD4 naive CD8 eff CD8 T HSC ##   aDC             14     0       0       0         0       0     0   0 ##   B mem            0    40      16       0         0       0     0   3 ##   B naive          0     4      69       0         0       0     0   0 ##   CD4 mem          0     0       0      94        26       2     1   0 ##   CD4 naive        0     0       0      28       165       0    15   2 ##   CD8 eff          0     1       0       0         0      95     1   0 ##   CD8 T            0     0       0       6         5      10    65   0 ##   HSC              0     0       0       0         0       0     0   0 ##   Megakaryocyte    0     0       0       0         0       0     0   0 ##   Monocyte         1     0       0       0         0       0     0   0 ##   CD16+ monocyte   0     0       0       0         0       0     0   0 ##   NK               0     0       0       0         0       1     0   0 ##   pDC              0     0       0       0         0       0     0   0 ##   Treg             0     0       0       0         0       0     0   0 ##                  ##                  Megakaryocyte Monocyte CD16+ monocyte  NK pDC Treg ##   aDC                        0        0              0   0   0    0 ##   B mem                      0        0              0   0   0    0 ##   B naive                    0        0              0   0   0    0 ##   CD4 mem                    0        0              0   0   0    4 ##   CD4 naive                  0        0              0   0   0   11 ##   CD8 eff                    1        0              0   1   0    0 ##   CD8 T                      1        0              0   0   0    0 ##   HSC                        0        0              0   0   0    0 ##   Megakaryocyte              0        0              0   0   0    0 ##   Monocyte                   3      176              8   1   0    0 ##   CD16+ monocyte             1        2             68   0   0    0 ##   NK                         0        0              0  55   0    0 ##   pDC                        0        0              0   0   4    0 ##   Treg                       0        0              0   0   0    0 sum(diag(preds_x_truth)) / sum(preds_x_truth) # 0.845 : 85% ## [1] 0.845 # Plot query and reference UMAP side-by-side with ground-truth & predicted cell labels use.color <- c(\"aDC\" = \"#E6F5C9\", \"B mem\" = \"#CCEBC5\", \"B naive\" = \"#FB8072\",                 \"CD4 mem\" = \"#A6761D\", \"CD4 naive\" = \"#666666\", \"CD8 eff\" = \"#80B1D3\",                \"CD8 T\" = \"#CBD5E8\", \"HSC\" = \"#E31A1C\", \"Megakaryocyte\" = \"#377EB8\",                 \"Monocyte\" = \"#FCCDE5\", \"CD16+ monocyte\" = \"#A6D854\", \"NK\" = \"#6A3D9A\",                \"pDC\" = \"#E7298A\", \"Treg\" = \"#FFFF33\") ref.celltype.plot <- PlotDimRed(object = ref, color.by = \"cell_type\", dimred = \"UMAP\", point.size = 0.01,                                  legend.nrow = 6, seed.color = 7) + ggtitle(\"reference (ground-truth)\") query.ground_truth.plot <- PlotDimRed(object = map, color.by = \"cell_type\", dimred = \"refUMAP\", point.size = 0.01,                                        legend.nrow = 6, seed.color = 7) + ggtitle(\"query (ground-truth)\") query.predicted.plot <-PlotDimRed(object = map, color.by = \"coral_labels\", dimred = \"refUMAP\", point.size = 0.01,                                    legend.nrow = 6, use.color = use.color) + ggtitle(\"query (predicted)\") query.confidence.plot <- PlotExpression(object = map, color.by = \"coral_probability\", dimred = \"refUMAP\", point.size = 0.01,                                      color.scale = \"viridis\") + ggtitle(\"query (confidence)\") cowplot::plot_grid(ref.celltype.plot, query.ground_truth.plot, query.predicted.plot, query.confidence.plot,                     ncol = 4, align = \"vh\") # R session sessionInfo() ## R version 4.2.1 (2022-06-23) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 20.04.5 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] scater_1.26.1               ggplot2_3.5.1               ##  [3] scuttle_1.8.4               Coralysis_1.0.0             ##  [5] SingleCellExperiment_1.20.1 SummarizedExperiment_1.28.0 ##  [7] Biobase_2.58.0              GenomicRanges_1.50.2        ##  [9] GenomeInfoDb_1.34.9         IRanges_2.32.0              ## [11] S4Vectors_0.36.2            BiocGenerics_0.44.0         ## [13] MatrixGenerics_1.10.0       matrixStats_1.1.0           ##  ## loaded via a namespace (and not attached): ##   [1] Rtsne_0.16                ggbeeswarm_0.7.1          ##   [3] colorspace_2.1-0          class_7.3-20              ##   [5] modeltools_0.2-23         rprojroot_2.0.3           ##   [7] bluster_1.8.0             XVector_0.38.0            ##   [9] BiocNeighbors_1.16.0      fs_1.6.1                  ##  [11] rstudioapi_0.14           farver_2.1.1              ##  [13] ggrepel_0.9.3             RSpectra_0.16-1           ##  [15] fansi_1.0.4               codetools_0.2-18          ##  [17] sparseMatrixStats_1.10.0  cachem_1.0.7              ##  [19] knitr_1.42                jsonlite_1.8.4            ##  [21] Cairo_1.6-0               umap_0.2.10.0             ##  [23] cluster_2.1.3             png_0.1-8                 ##  [25] pheatmap_1.0.12           compiler_4.2.1            ##  [27] dqrng_0.3.0               Matrix_1.6-5              ##  [29] fastmap_1.1.1             limma_3.54.2              ##  [31] aricode_1.0.2             cli_3.6.1                 ##  [33] BiocSingular_1.14.0       htmltools_0.5.4           ##  [35] tools_4.2.1               rsvd_1.0.5                ##  [37] igraph_1.4.1              gtable_0.3.3              ##  [39] glue_1.6.2                GenomeInfoDbData_1.2.9    ##  [41] RANN_2.6.1                reshape2_1.4.4            ##  [43] LiblineaR_2.10-22         dplyr_1.1.1               ##  [45] doRNG_1.8.6               Rcpp_1.0.10               ##  [47] jquerylib_0.1.4           pkgdown_2.0.6             ##  [49] vctrs_0.6.1               iterators_1.0.14          ##  [51] DelayedMatrixStats_1.20.0 xfun_0.37                 ##  [53] stringr_1.5.0             beachmat_2.14.0           ##  [55] lifecycle_1.0.3           irlba_2.3.5.1             ##  [57] rngtools_1.5.2            statmod_1.5.0             ##  [59] edgeR_3.40.2              zlibbioc_1.44.0           ##  [61] scales_1.3.0              ragg_1.2.4                ##  [63] doSNOW_1.0.20             parallel_4.2.1            ##  [65] SparseM_1.81              RColorBrewer_1.1-3        ##  [67] yaml_2.3.7                reticulate_1.34.0         ##  [69] memoise_2.0.1             gridExtra_2.3             ##  [71] ggrastr_1.0.1             sass_0.4.5                ##  [73] stringi_1.7.12            highr_0.10                ##  [75] desc_1.4.2                foreach_1.5.2             ##  [77] ScaledMatrix_1.6.0        scran_1.26.2              ##  [79] BiocParallel_1.32.6       rlang_1.1.0               ##  [81] pkgconfig_2.0.3           systemfonts_1.0.4         ##  [83] bitops_1.0-7              evaluate_0.20             ##  [85] lattice_0.20-45           purrr_1.0.1               ##  [87] labeling_0.4.2            cowplot_1.1.1             ##  [89] tidyselect_1.2.0          plyr_1.8.8                ##  [91] magrittr_2.0.3            R6_2.5.1                  ##  [93] snow_0.4-4                generics_0.1.3            ##  [95] metapod_1.6.0             DelayedArray_0.24.0       ##  [97] pillar_1.9.0              withr_2.5.0               ##  [99] RCurl_1.98-1.10           tibble_3.2.1              ## [101] utf8_1.2.3                rmarkdown_2.20            ## [103] viridis_0.6.2             locfit_1.5-9.7            ## [105] grid_4.2.1                flexclust_1.4-1           ## [107] digest_0.6.31             textshaping_0.3.6         ## [109] openssl_2.0.6             munsell_0.5.0             ## [111] viridisLite_0.4.1         beeswarm_0.4.0            ## [113] vipor_0.4.5               bslib_0.4.2               ## [115] askpass_1.1"},{"path":"/articles/02_CellState.html","id":"integration","dir":"Articles","previous_headings":"","what":"Integration","title":"Cell state identification","text":"single-cell RNA sequencing dataset peripheral blood mononuclear cells (PBMCs) healthy versus COVID-19 infected donors published Wilk et al., (2020) used demonstrated cell cluster probability can used identify cell states associated differential gene expression programs.","code":"# Packages loaded suppressWarnings(suppressMessages(library(\"SingleCellExperiment\"))) suppressWarnings(suppressMessages(library(\"scater\"))) suppressWarnings(suppressMessages(library(\"dplyr\"))) library(\"Coralysis\") library(\"ggplot2\")  # Packages not loaded, but required: #library(\"scran\")  #library(\"cowplot\") #library(\"ComplexHeatmap\") # Import data  sce <- readRDS(\"covid_Wilk_et_al.rds\")"},{"path":"/articles/02_CellState.html","id":"normalization","dir":"Articles","previous_headings":"","what":"Normalization","title":"Cell state identification","text":"Coralysis requires log-normalised data input. dataset previously normalised basic log-normalisation method Seurat. simple custom function can used perform Seurat (see NormalizeData). alternative, scran normalization can performed, particularly beneficial rare cell types exist (see following vignette).","code":"## Normalize the data # log1p normalization SeuratNormalisation <- function(object) {   # 'SeuratNormalisation()' function applies the basic Seurat normalization to   #a SingleCellExperiment object with a 'counts' assay. Normalized data   #is saved in the 'logcounts' assay.   logcounts(object) <- apply(counts(object), 2, function(x) {     log1p(x/sum(x)*10000)   }) # log1p normalization w/ 10K scaling factor   logcounts(object) <- as(logcounts(object), \"sparseMatrix\")   return(object) } sce <- SeuratNormalisation(object = sce) ## scran normalisation ScranNormalisation <- function(object) {     norm_clusters <- scran::quickCluster(object)     object <- scran::computeSumFactors(object, clusters = norm_clusters)     object <- scater::logNormCounts(object)     return(object) }  # Split object by batch: 'Donor_full' batch.levels <- levels(sce$Donor_full) names(batch.levels) <- batch.levels sce.list <- lapply(batch.levels, function(x) sce[,sce$Donor_full == x])  # Apply normalisation set.seed(123) sce.list <- lapply(sce.list, ScranNormalisation)  # Join  sce <- do.call(cbind, sce.list)"},{"path":"/articles/02_CellState.html","id":"hvg-selection","dir":"Articles","previous_headings":"","what":"HVG selection","title":"Cell state identification","text":"Highly variable genes (HVG) can selected using R package scran. variable Donor_full colData used batch label. SingleCellExperiment object can comprise alternative experiments. main experiment called raw , alternative HVG, hvg. important keep backup genes SingleCellExperiment object selecting HVGs (see SingleCellExperiment vignette).","code":"# Feature selection with 'scran' package nhvg <- 2000 batch.label <- \"Donor_full\" sce[[batch.label]] <- factor(sce[[batch.label]]) m.hvg <- scran::modelGeneVar(sce, block=sce[[batch.label]]) hvg.ordered <- order(m.hvg[[\"bio\"]], decreasing=TRUE) top.hvg <- row.names(sce)[hvg.ordered[1:nhvg]] rowData(sce) <- cbind(\"highly_variable\" = row.names(sce) %in% top.hvg, m.hvg)  # Name main expression assay & swap assays mainExpName(sce) <- \"raw\" altExp(sce, \"hvg\") <- sce[top.hvg,] sce <- swapAltExp(sce, \"hvg\", withColData = FALSE)"},{"path":"/articles/02_CellState.html","id":"dimred---before-integration","dir":"Articles","previous_headings":"","what":"Dimred - before integration","title":"Cell state identification","text":"PCA UMAP representation dataset performing integration can obtained Coralysis. Several parameters can provided functions order adjust analyses dataset (see ?Coralysis::RunPCA() ?Coralysis::RunUMAP).  clear donor effect, particularly cell types, CD14 monocytes CD8 memory T cells.","code":"# Dimensional reduction - unintegrated set.seed(123) sce <- RunPCA(object = sce, assay.name = \"logcounts\", dimred.name = \"unintPCA\") set.seed(123) sce <- RunUMAP(object = sce, dims = 1:30, dimred.type = \"unintPCA\",                 umap.method = \"uwot\", dimred.name = \"unintUMAP\",                 n_neighbors = 15, min_dist = 0.3)  # Plotting  original.cell.label <- \"cell_type\" cell.label <- \"predicted_celltype_l2\" vars2plot <- c(batch.label, original.cell.label, cell.label) names(vars2plot) <- vars2plot unint.plts <- lapply(X = vars2plot, FUN = function(x) {     PlotDimRed(object = sce, color.by = x, point.size = 0.2, legend.nrow = 10, point.stroke = 0.1) }) # plot each variable all.unint.plts <- cowplot::plot_grid(plotlist = unint.plts, ncol = 3, align = \"vh\") # join plots together all.unint.plts"},{"path":"/articles/02_CellState.html","id":"multi-level-integration","dir":"Articles","previous_headings":"","what":"Multi-level integration","title":"Cell state identification","text":"Multi-level integration can performed Coralysis running function RunParallelDivisiveICP(). batch.label parameter required. batch.label corresponds variable colData. case Donor_full. RunParallelDivisiveICP() function can run parallel providing number threads reduce run time (takes around 40 min. 4 threads). Consult full documentation function ?RunParallelDivisiveICP. Coralysis returns list cell cluster probabilities saved metadata(sce)$coralysis$joint.probability length equal number icp runs, .e., L (default L=50), times number icp rounds, .e., log2(k) (default k=16, thus 4 rounds divisive icp). cell cluster probability given icp run divisive rounds can plotted function PlotClusterTree(). colData variable can provided see composition per cluster across divisive rounds respective icp run. See examples icp run number 42.  cell types formed unique clusters, quite remained mixed. Multi-level integration resolution might get better running RunParallelDivisiveICP() 32 cluster, .e., k = 32, instead 16.","code":"# Perform multi-level integration set.seed(123) sce <- RunParallelDivisiveICP(object = sce, batch.label = \"Donor_full\", threads = 4) ##    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   2%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   6%   |                                                                               |======                                                                |   8%   |                                                                               |=======                                                               |  10%   |                                                                               |=========                                                             |  12%   |                                                                               |==========                                                            |  14%   |                                                                               |===========                                                           |  16%   |                                                                               |=============                                                         |  18%   |                                                                               |==============                                                        |  20%   |                                                                               |================                                                      |  22%   |                                                                               |=================                                                     |  24%   |                                                                               |===================                                                   |  27%   |                                                                               |====================                                                  |  29%   |                                                                               |=====================                                                 |  31%   |                                                                               |=======================                                               |  33%   |                                                                               |========================                                              |  35%   |                                                                               |==========================                                            |  37%   |                                                                               |===========================                                           |  39%   |                                                                               |=============================                                         |  41%   |                                                                               |==============================                                        |  43%   |                                                                               |===============================                                       |  45%   |                                                                               |=================================                                     |  47%   |                                                                               |==================================                                    |  49%   |                                                                               |====================================                                  |  51%   |                                                                               |=====================================                                 |  53%   |                                                                               |=======================================                               |  55%   |                                                                               |========================================                              |  57%   |                                                                               |=========================================                             |  59%   |                                                                               |===========================================                           |  61%   |                                                                               |============================================                          |  63%   |                                                                               |==============================================                        |  65%   |                                                                               |===============================================                       |  67%   |                                                                               |=================================================                     |  69%   |                                                                               |==================================================                    |  71%   |                                                                               |===================================================                   |  73%   |                                                                               |=====================================================                 |  76%   |                                                                               |======================================================                |  78%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  82%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  86%   |                                                                               |=============================================================         |  88%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  92%   |                                                                               |==================================================================    |  94%   |                                                                               |===================================================================   |  96%   |                                                                               |===================================================================== |  98%   |                                                                               |======================================================================| 100% ## Plot cluster tree for icp run 13 # Probability prob.cluster.tree <- PlotClusterTree(object = sce, icp.run = 42)  # batch label distribution batch.cluster.tree <- PlotClusterTree(object = sce, icp.run = 42, color.by = \"Donor_full\")  # original cell type label distribution orig.cell.cluster.tree <- PlotClusterTree(object = sce, icp.run = 42, color.by = \"cell_type\")  # Azimuth/predicted cell type label distribution cell.cluster.tree <- PlotClusterTree(object = sce, icp.run = 42, color.by = \"predicted_celltype_l2\")  # Join all plots with 'cowplot' all.cluster.tree <- cowplot::plot_grid(cowplot::plot_grid(prob.cluster.tree, batch.cluster.tree,                                                            ncol = 2, rel_widths = c(0.5, 0.5), align = \"v\"),                                         cowplot::plot_grid(orig.cell.cluster.tree, cell.cluster.tree,                                                            ncol = 2, rel_widths = c(0.5, 0.5), align = \"vh\"),                                        ncol = 1) all.cluster.tree"},{"path":"/articles/02_CellState.html","id":"dimred---after-integration","dir":"Articles","previous_headings":"","what":"Dimred - after integration","title":"Cell state identification","text":"Coralysis returns list cell cluster probabilities saved metadata(sce)$coralysis$joint.probability length equal number icp runs, .e., L (default L=50), times number icp rounds, .e., log2(k) (default k=16, thus 4 rounds divisive icp). cell cluster probability can concatenated compute PCA order obtain integrated embedded. default cell cluster probability corresponding last icp round used. Coralysis integrated embedding can used downstream non-linear dimensional reduction, t-SNE UMAP, clustering.  Coralysis efficiently integrated donor PBMC samples, identified small populations (e.g., neutrophils, Treg, MAIT, dnT, NK CD56bright), differentiation trajectories (e.g., B naive memory).","code":"# Dimensional reduction - unintegrated set.seed(123) sce <- RunPCA(object = sce, assay.name = \"joint.probability\", dimred.name = \"intPCA\") ## Divisive ICP: selecting ICP tables multiple of 4 # UMAP set.seed(123) sce <- RunUMAP(object = sce, dimred.type = \"intPCA\",                 umap.method = \"uwot\", dimred.name = \"intUMAP\",                 dims = 1:50, n_neighbors = 15, min_dist = 0.3)  # Plotting  int.plts <- lapply(X = vars2plot, FUN = function(x) {     PlotDimRed(object = sce, color.by = x, point.size = 0.2, legend.nrow = 10, point.stroke = 0.1) }) # plot each variable all.int.plts <- cowplot::plot_grid(plotlist = int.plts, ncol = 3, align = \"vh\") # join plots together all.int.plts"},{"path":"/articles/02_CellState.html","id":"graph-based-clustering","dir":"Articles","previous_headings":"","what":"Graph-based clustering","title":"Cell state identification","text":"Graph-based clustering can obtained running scran function clusterCells() using Coralysis integrated embedding. alternative, joint cluster probabilities can used clustering. advantages using integrated embedding instead joint probabilities : computational efficiency; , noise robustness. Using joint probabilities instead PCA embedding takes considerably time.","code":"### Graph-based clustering with scran ## Coralysis integrated PCA embedding  set.seed(1024) sce$emb_clusters <- scran::clusterCells(sce, use.dimred = \"intPCA\",                                          BLUSPARAM = bluster::SNNGraphParam(k = 15, cluster.fun = \"louvain\"))  ## Coralysis joint cluster probabilities # retrieve ICP cell cluster probability tables for every icp run, but only for the last divisive round probs <- GetCellClusterProbability(object = sce, icp.round = 4)  # dim(probs) # 44721 cells x 800 clusters (16 clusters x 50 icp runs = 800 clusters)  probs <- t(probs) colnames(probs) <- colnames(sce) prob.sce <- SingleCellExperiment(assays = list(\"probability\" = probs)) set.seed(1024) sce$prob_clusters <- scran::clusterCells(prob.sce,                                           assay.type = \"probability\",                                          BLUSPARAM = bluster::SNNGraphParam(k = 15, cluster.fun = \"louvain\"))  # Plotting vars2plot2 <- c(cell.label, \"emb_clusters\", \"prob_clusters\") names(vars2plot2) <- vars2plot2 clts.plts <- lapply(X = vars2plot2, FUN = function(x) {     PlotDimRed(object = sce, color.by = x, point.size = 0.2, legend.nrow = 10, point.stroke = 0.1) }) # plot each variable all.clts.plts <- cowplot::plot_grid(plotlist = clts.plts, ncol = 3, align = \"vh\") # join plots together all.clts.plts"},{"path":"/articles/02_CellState.html","id":"cell-state-identification","dir":"Articles","previous_headings":"","what":"Cell state identification","title":"Cell state identification","text":"cell cluster probability aggregated mean median across icp runs can obtained function SummariseCellClusterProbability() plotted infer transient steady cell states.  instance, B cell states (naive, intermediate, memory) well supported Coralysis cell cluster probability, probably require run Coralysis higher resolution, .e., k=32 instead k=16.","code":"# Summarise cell cluster probability sce <- SummariseCellClusterProbability(object = sce, icp.round = 4) # save result in 'colData' # colData(sce) # check the colData  # Plot cell cluster probabilities - mean # possible options: \"mean_probs\", \"median_probs\", \"scaled_median_probs\"  PlotExpression(object = sce, color.by = \"scaled_mean_probs\", color.scale = \"viridis\",                 point.size = 0.2, point.stroke = 0.1, legend.title = \"Mean prob.\\n(min-max)\")"},{"path":"/articles/02_CellState.html","id":"label-gene-coefficients-by-majority-voting","dir":"Articles","previous_headings":"","what":"Label gene coefficients by majority voting","title":"Cell state identification","text":"Gene coefficients can obtained given cell label majority voting function MajorityVotingFeatures(). majority voting performed searching representative cluster given cell label across possible clusters (.e., across icp runs rounds). representative cluster corresponds cluster highest majority voting score. corresponds geometric mean proportion cells given label intersected cluster proportion cells cluster intersected cells given label. higher score better. cluster scores 1 indicates cells correspond assigned label, vice versa; .e., cells assigned label belong cluster. example, MajorityVotingFeatures() providing colData variable \"emb_clusters\"(.e., label=\"emb_clusters\"). function MajorityVotingFeatures() returns list two elements: feature_coeff: list data frames comprising gene coefficients respective weights. summary: data frame summarizing ICP cluster best represents cell label, along respective majority voting score.","code":"# Get label gene coefficients by majority voting clts.gene.coeff <- MajorityVotingFeatures(object = sce, label = \"emb_clusters\") # Print cluster gene coefficients summary clts.gene.coeff$summary ##    label icp_run icp_round cluster     score ## 1      1      32         4       1 0.8854464 ## 2      2       8         4       2 0.8029275 ## 3      3      22         4       5 0.5766541 ## 4      4      33         4       5 0.9547252 ## 5      5      47         4       7 0.7899177 ## 6      6       2         4      11 0.7727299 ## 7      7      31         4       2 0.7066273 ## 8      8      22         4       8 0.8764744 ## 9      9      36         4       3 0.9384610 ## 10    10      47         4      15 0.6753852 ## 11    11      40         3       5 0.5651993 ## 12    12       9         4      14 0.8316545 ## 13    13      49         4      16 0.8342693 ## 14    14      34         3       5 0.7364123 ## 15    15      28         4       1 0.6918241 ## 16    16       3         4      12 0.8207624 ## 17    17      25         4      16 0.4316837 ## 18    18      40         4       6 0.8674741 ## 19    19      46         4       6 0.9495629 ## 20    20      40         4       1 0.8132710 ## 21    21      48         4      11 0.7210690 ## 22    22      33         4       4 0.6778038 ## 23    23      32         4       5 0.8918649 # Print top 30 positive gene coefficients for cluster 21 (corresponding to CD8 naive T cells based on Azimuth annotations) head(clts.gene.coeff$feature_coeff$`21`[order(clts.gene.coeff$feature_coeff$`21`[,2], decreasing = TRUE),], 30) ##           feature coeff_clt11 ## 19           CD8B  1.22619799 ## 18           CD8A  0.90092405 ## 70  RP11-291B21.2  0.56716552 ## 77            SKI  0.56677043 ## 95            TTN  0.51546293 ## 65         PRRC2B  0.51026741 ## 59     PCED1B-AS1  0.50039030 ## 89         TBC1D4  0.49940311 ## 43            ITK  0.40797111 ## 1           ACAP1  0.32258468 ## 81          SOCS3  0.30357642 ## 63          PLCG1  0.25315596 ## 96            TXK  0.24066515 ## 25        FAM102A  0.21608469 ## 83         SPOCK2  0.20044225 ## 79          SLFN5  0.13378946 ## 68          RCAN3  0.11383799 ## 101        ZNF106  0.10929793 ## 94        TSC22D3  0.09985137 ## 26            FOS  0.08740513 ## 56           NKTR  0.08706334 ## 16           CD3D  0.07613402 ## 14           CCR7  0.07542613 ## 10          BIRC6  0.07336380 ## 38         IPCEF1  0.06746328 ## 76           RSF1  0.04338863 ## 40          ITGA6  0.04214525 ## 93          TRBC2  0.03751715 ## 45        LDLRAP1  0.03632500 ## 24            EVL  0.02270878"},{"path":"/articles/02_CellState.html","id":"cd14-monocytes-cluster-gene-coefficients---5-versus-8","dir":"Articles","previous_headings":"","what":"CD14 monocytes: cluster gene coefficients - 5 versus 8","title":"Cell state identification","text":"Coralysis identified two clusters CD14 monocytes: 5 8 (considering Louvain clustering obtained integrated embedding). top positive gene coefficients cluster 5 8 selected plotted (gene expression scaled).  expression level CYP1B1 cluster 8 slightly higher COVID-19 infected donor cells healthy donors, particularly, ventilated versus healhty donors.  previous plots suggest clusters 5 8 phenotypically different. addition, low expression HLA-DR (HLA-DRA, HLA-DRB1) genes associated severe inflammatory conditions like COVID-19 (see plots ) well high expression S100A9. results suggest cluster 8 corresponds strongly activated possibly dysregulated monocytes, common severe COVID-19 cluster 5. Indeed, almost half (48%) cells cluster 8 COVID-19 infected donors required ventilation, whereas percentage close 30% cluster 5.","code":"# Cluster gene coefficients: 5 versus 8 clt5 <- clts.gene.coeff$feature_coeff$`5` clt5 <- clt5[order(clt5[,2], decreasing = TRUE),] clt8 <- clts.gene.coeff$feature_coeff$`8` # copy data frame of gene coefficients for cluster 8  clt8 <- clt8[order(clt8[,2], decreasing = TRUE),]  # Merge cluster coefficients clt5vs8 <- merge(clt5, clt8, all = TRUE) clt5vs8[is.na(clt5vs8)] <- 0 clt5vs8.parsed <- clt5vs8 %>%      mutate(\"coeff_variation\" = abs(coeff_clt7 - coeff_clt8)) %>%      arrange(desc(coeff_variation)) %>%      filter(coeff_clt7!=0 & coeff_clt8!=0) %>%      filter((coeff_clt7 * coeff_clt8)<0) top5.clt5 <- clt5vs8.parsed  %>%      arrange(desc(coeff_clt7)) %>%     pull(feature) %>% head(5) top5.clt8 <- clt5vs8.parsed %>%      arrange(desc(coeff_clt8)) %>%      pull(feature) %>% head(5)  # Top 5 positive coefficients in each cluster top5.genes <- c(top5.clt5, top5.clt8) names(top5.genes) <- top5.genes  # Plot top5.gexp.mono.clts.plts <- lapply(X = top5.genes, FUN = function(x) {     PlotExpression(object = sce, color.by = x, scale.values = TRUE, point.size = 0.25, point.stroke = 0.25) }) all.top5.gexp.mono.clts.plts <- cowplot::plot_grid(plotlist = top5.gexp.mono.clts.plts, ncol = 5, align = \"vh\") all.top5.gexp.mono.clts.plts scater::plotExpression(object = sce[,sce$emb_clusters==\"8\"], features = \"CYP1B1\",                         color_by = \"Ventilated\", x = \"Ventilated\") genes2plot <- c(\"HLA-DRA\", \"HLA-DRB1\") gexp.hla.plots <- lapply(genes2plot, function(x) {     PlotExpression(object = sce, color.by = x, scale.values = TRUE, point.size = 0.25, point.stroke = 0.25) }) cowplot::plot_grid(plotlist = gexp.hla.plots, ncol = 2, align = \"vh\")"},{"path":"/articles/02_CellState.html","id":"cell-state-association-with-covid-19","dir":"Articles","previous_headings":"","what":"Cell state association with COVID-19","title":"Cell state identification","text":"cell cluster probability can used search altered cell states, e.g., associated COVID-19. distribution cell cluster probability per cluster (integrated embedding) per ventilated group shown running function CellClusterProbabilityDistribution(). Cluster 18, roughly corresponding CD16 monocytes, shows difference healthy COVID associated cells (non-ventilated ventilated donor cells).  Cell cluster probability bins per cluster label can obtained running BinCellClusterProbability(), returns SingleCellExperiment object logcounts average per label per cell probability bin. number probability bins can provided parameter bins. cell frequency per cell bin per group interest can obtained function TabulateCellBinsByGroup(). heatmap shows cell frequency across ventilated groups per bins cluster 18 (corresponding CD16 monocytes). cell frequency represented corresponds cell proportions per group (healthy, non-ventilated ventilated) scaled bins, .e., columns. Cell states higher probabilities tend “healthier” states lower probabilities.  correlation cell cluster probability bins cluster 18 averaged gene expression can obtained function CellBinsFeatureCorrelation(). Among several positively negatively correlated genes, expression C1QB seems enriched diseased cells, negative Pearson coefficient close 0.8. gene selected example due expression relatively limited cluster 18.","code":"## Disease associated cell state  # Search for diseased affected cell states prob.dist <- CellClusterProbabilityDistribution(object = sce,                                                  label = \"emb_clusters\",                                                  group = \"Ventilated\",                                                  probability = \"scaled_mean_probs\") prob.dist # cell states SCE object  cellstate.sce <- BinCellClusterProbability(object = sce, label = \"emb_clusters\", icp.round = 4, bins = 20)   # Tabulate cell bins by group  cellbins.tables <- TabulateCellBinsByGroup(object = cellstate.sce, group = \"Ventilated\", relative = TRUE, margin = 1)  # Heatmap of cell bins distribution by group for cluster 20 - CD16 Monocytes cluster <- \"18\" col.fun <- circlize::colorRamp2(c(-1.5, 0, 1.5), viridis::inferno(3)) heat.plot <- ComplexHeatmap::Heatmap(matrix = scale(cellbins.tables[[cluster]]),                                       name = \"Col. Z-score\",                                       cluster_rows = FALSE,                                       cluster_columns = FALSE,                                       row_names_side = \"left\",                                       col = col.fun,                                       column_title = \"Distribution of cells per cell cluster probability bin\",                                       heatmap_legend_param = list(legend_direction = \"horizontal\", title_position = \"topcenter\")) ComplexHeatmap::draw(heat.plot, heatmap_legend_side = \"bottom\", annotation_legend_side = \"bottom\") # Pearson correlated features with cluster 20 cor.features.clt18 <- CellBinsFeatureCorrelation(object = cellstate.sce, labels = cluster) cor.features.clt18 <- cor.features.clt18 %>%     filter(!is.na(`18`)) %>%      arrange(`18`) # C1QB exp.C1QB.umap <- PlotExpression(sce, color.by = \"C1QB\", scale.values = TRUE, point.size = 0.5, point.stroke = 0.25) exp.C1QB.violin <- scater::plotExpression(sce[,sce$emb_clusters == cluster], features = \"C1QB\",                                           x = \"Ventilated\", color_by = \"Ventilated\") exp.C1QB.umap exp.C1QB.violin # R session sessionInfo() ## R version 4.2.1 (2022-06-23) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 20.04.5 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3 ##  ## locale: ##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               ##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     ##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    ##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  ##  [9] LC_ADDRESS=C               LC_TELEPHONE=C             ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C        ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] Coralysis_1.0.0             dplyr_1.1.1                 ##  [3] scater_1.26.1               ggplot2_3.5.1               ##  [5] scuttle_1.8.4               SingleCellExperiment_1.20.1 ##  [7] SummarizedExperiment_1.28.0 Biobase_2.58.0              ##  [9] GenomicRanges_1.50.2        GenomeInfoDb_1.34.9         ## [11] IRanges_2.32.0              S4Vectors_0.36.2            ## [13] BiocGenerics_0.44.0         MatrixGenerics_1.10.0       ## [15] matrixStats_1.1.0           ##  ## loaded via a namespace (and not attached): ##   [1] snow_0.4-4                circlize_0.4.15           ##   [3] systemfonts_1.0.4         plyr_1.8.8                ##   [5] igraph_1.4.1              BiocParallel_1.32.6       ##   [7] digest_0.6.31             foreach_1.5.2             ##   [9] htmltools_0.5.4           viridis_0.6.2             ##  [11] fansi_1.0.4               magrittr_2.0.3            ##  [13] memoise_2.0.1             ScaledMatrix_1.6.0        ##  [15] cluster_2.1.3             doParallel_1.0.17         ##  [17] limma_3.54.2              ComplexHeatmap_2.14.0     ##  [19] pkgdown_2.0.6             colorspace_2.1-0          ##  [21] ggrepel_0.9.3             textshaping_0.3.6         ##  [23] xfun_0.37                 crayon_1.5.2              ##  [25] RCurl_1.98-1.10           jsonlite_1.8.4            ##  [27] scatterpie_0.2.3          iterators_1.0.14          ##  [29] glue_1.6.2                polyclip_1.10-4           ##  [31] gtable_0.3.3              zlibbioc_1.44.0           ##  [33] XVector_0.38.0            GetoptLong_1.0.5          ##  [35] DelayedArray_0.24.0       BiocSingular_1.14.0       ##  [37] shape_1.4.6               SparseM_1.81              ##  [39] scales_1.3.0              pheatmap_1.0.12           ##  [41] edgeR_3.40.2              rngtools_1.5.2            ##  [43] Rcpp_1.0.10               viridisLite_0.4.1         ##  [45] aricode_1.0.2             clue_0.3-64               ##  [47] dqrng_0.3.0               rsvd_1.0.5                ##  [49] metapod_1.6.0             RColorBrewer_1.1-3        ##  [51] modeltools_0.2-23         pkgconfig_2.0.3           ##  [53] farver_2.1.1              sass_0.4.5                ##  [55] uwot_0.1.14               locfit_1.5-9.7            ##  [57] utf8_1.2.3                tidyselect_1.2.0          ##  [59] labeling_0.4.2            rlang_1.1.0               ##  [61] reshape2_1.4.4            munsell_0.5.0             ##  [63] tools_4.2.1               cachem_1.0.7              ##  [65] cli_3.6.1                 generics_0.1.3            ##  [67] evaluate_0.20             stringr_1.5.0             ##  [69] fastmap_1.1.1             yaml_2.3.7                ##  [71] ragg_1.2.4                knitr_1.42                ##  [73] fs_1.6.1                  purrr_1.0.1               ##  [75] RANN_2.6.1                doRNG_1.8.6               ##  [77] sparseMatrixStats_1.10.0  scran_1.26.2              ##  [79] flexclust_1.4-1           compiler_4.2.1            ##  [81] rstudioapi_0.14           beeswarm_0.4.0            ##  [83] png_0.1-8                 tibble_3.2.1              ##  [85] statmod_1.5.0             tweenr_2.0.3              ##  [87] bslib_0.4.2               stringi_1.7.12            ##  [89] highr_0.10                desc_1.4.2                ##  [91] RSpectra_0.16-1           lattice_0.20-45           ##  [93] bluster_1.8.0             Matrix_1.6-5              ##  [95] vctrs_0.6.1               pillar_1.9.0              ##  [97] lifecycle_1.0.3           jquerylib_0.1.4           ##  [99] LiblineaR_2.10-22         GlobalOptions_0.1.2       ## [101] RcppAnnoy_0.0.20          BiocNeighbors_1.16.0      ## [103] cowplot_1.1.1             bitops_1.0-7              ## [105] irlba_2.3.5.1             R6_2.5.1                  ## [107] gridExtra_2.3             vipor_0.4.5               ## [109] codetools_0.2-18          MASS_7.3-57               ## [111] rprojroot_2.0.3           rjson_0.2.21              ## [113] withr_2.5.0               GenomeInfoDbData_1.2.9    ## [115] parallel_4.2.1            doSNOW_1.0.20             ## [117] grid_4.2.1                ggfun_0.1.3               ## [119] beachmat_2.14.0           tidyr_1.3.0               ## [121] class_7.3-20              rmarkdown_2.20            ## [123] DelayedMatrixStats_1.20.0 Cairo_1.6-0               ## [125] ggforce_0.4.1             ggbeeswarm_0.7.1"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"António Sousa. Maintainer, author. Johannes Smolander. Contributor, author. Sini Junttila. Author. Laura L Elo. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sousa , Smolander J, Junttila S, Elo L (2025). “Coralysis enables sensitive identification imbalanced cell types states single-cell data via multi-level integration.” bioRxiv. doi:10.1101/2025.02.07.637023, R package version 1.0.0.","code":"@Article{,   author = {António G.G. Sousa and Johannes Smolander and Sini Junttila and Laura L. Elo},   title = {Coralysis enables sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration},   year = {2025},   doi = {10.1101/2025.02.07.637023},   publisher = {Cold Spring Harbor Laboratory},   journal = {bioRxiv},   note = {R package version 1.0.0}, }"},{"path":[]},{"path":"/index.html","id":"coralysis-is-an-r-package-featuring-a-multi-level-integration-algorithm-for-sensitive-integration-reference-mapping-and-cell-state-identification-in-single-cell-data","dir":"","previous_headings":"","what":"Coralysis is an R package featuring a multi-level integration algorithm for sensitive integration, reference-mapping, and cell state identification in single-cell data.","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"Coralysis integration flowchart. () input heterogeneous scRNA-seq datasets overclustered batch wise training set modelled Iterative Clustering Projection (ICP) algorithm order predict cell cluster probabilities obtain integrated embedding. Adaptations original ICP algorithm (Smolander et al., 2021): (B) batch wise cluster assignment start, dependent cell distribution across Principal Component 1 (median cutoff); (C) training cells selected batch k nearest neighbours cell highest probability every batch per cluster; , (D) upon ICP clustering convergence, cluster divided two next clustering round, dependent batch wise cluster probability distribution (median cutoff). (E) Multi-level integration achieved multiple divisive clustering rounds, blending batch effect highlighting biological signal incrementally. Shapes represent cell types colours batches.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"latest version Coralysis can downloaded GitHub using devtools R package.","code":"devtools::install_github(\"elolab/Coralysis\")"},{"path":"/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick-start","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"run Coralysis, follow instructions :","code":"# Packages library(\"SingleCellExperiment\") library(\"Coralysis\")  # Prepare data: checks 'logcounts' format & removes non-expressed genes pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays)  # Multi-level integration set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", threads = 4)   # Compute integrated PCA from joint probability set.seed(125) pbmc_10Xassays <- RunPCA(object = pbmc_10Xassays)  # Run UMAP set.seed(1204) pbmc_10Xassays <- RunUMAP(object = pbmc_10Xassays, umap.method = \"uwot\", n_neighbors = 20, min_dist = 0.3)  # Visualize integrated data  vars <- c(\"batch\", \"cell_type\") plots <- lapply(X = vars, FUN = function(x) {     PlotDimRed(object = pbmc_10Xassays, color.by = x, point.size = 0.5, point.stroke = 0.5, legend.nrow = 3) })  cowplot::plot_grid(plotlist = plots, ncol = 2, align = \"vh\") # join plots together"},{"path":"/index.html","id":"contact-information","dir":"","previous_headings":"","what":"Contact information","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"questions related Coralysis, please contact us .","code":""},{"path":"/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Coralysis sensitive identification of imbalanced cell types and states in single-cell data via multi-level integration","text":"Johannes Smolander, Sini Junttila, Mikko S Venäläinen, Laura L Elo. “ILoReg: tool high-resolution cell population identification single-cell RNA-seq data”. Bioinformatics, Volume 37, Issue 8, 15 April 2021, Pages 1107–1114, https://doi.org/10.1093/bioinformatics/btaa919.","code":""},{"path":"/reference/AggregateClusterExpression.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregates cell feature expression by clusters — AggregateClusterExpression","title":"Aggregates cell feature expression by clusters — AggregateClusterExpression","text":"function aggregates cell feature expression clusters provided.","code":""},{"path":"/reference/AggregateClusterExpression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregates cell feature expression by clusters — AggregateClusterExpression","text":"","code":"AggregateClusterExpression(mtx, cluster, select.features = NULL, fun = \"mean\")"},{"path":"/reference/AggregateClusterExpression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregates cell feature expression by clusters — AggregateClusterExpression","text":"mtx Matrix features vs cells (rows vs cols) feature expression  aggregate. cluster Cluster identities vector corresponding cells  mtx. select.features features selected. default NULL,  features used. fun Character specifying feature expression aggregated  mean sum. default \"mean\".","code":""},{"path":"/reference/AggregateClusterExpression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregates cell feature expression by clusters — AggregateClusterExpression","text":"Matrix feature expressed aggregated clusters.","code":""},{"path":"/reference/AggregateDataByBatch.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"function aggregates feature expression cell clusters, per  batch provided.","code":""},{"path":"/reference/AggregateDataByBatch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"","code":"AggregateDataByBatch.SingleCellExperiment(object, batch.label, nhvg, p, ...)  # S4 method for SingleCellExperiment AggregateDataByBatch(object, batch.label, nhvg = 2000L, p = 30L, ...)"},{"path":"/reference/AggregateDataByBatch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"object object SingleCellExperiment class. batch.label Cluster identities vector corresponding cells  mtx. nhvg Integer number highly variable features select. default  2000. p Integer. default 30. ... Parameters passed ClusterCells() function.","code":""},{"path":"/reference/AggregateDataByBatch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"SingleCellExperiment object feature expression aggregated clusters.","code":""},{"path":"/reference/AggregateDataByBatch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregates feature expression by cell clusters, per batch if provided. — AggregateDataByBatch","text":"","code":"# Run with a batch set.seed(1204) sce <- AggregateDataByBatch(object = pbmc_10Xassays, batch.label = \"batch\") logcounts(sce)[1:10,1:10] #> Error in logcounts(sce): could not find function \"logcounts\" head(metadata(sce)$clusters) #> Error in metadata(sce): could not find function \"metadata\"  # Run without a batch set.seed(1204) sce <- AggregateDataByBatch(object = pbmc_10Xassays, batch.label = NULL) logcounts(sce)[1:10,1:10] #> Error in logcounts(sce): could not find function \"logcounts\" head(metadata(sce)$clusters) #> Error in metadata(sce): could not find function \"metadata\""},{"path":"/reference/BinCellClusterProbability.html","id":null,"dir":"Reference","previous_headings":"","what":"Bin cell cluster probability — BinCellClusterProbability","title":"Bin cell cluster probability — BinCellClusterProbability","text":"Bin cell cluster probability given cell label.","code":""},{"path":"/reference/BinCellClusterProbability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bin cell cluster probability — BinCellClusterProbability","text":"","code":"BinCellClusterProbability.SingleCellExperiment(   object,   label,   icp.run,   icp.round,   funs,   bins,   aggregate.bins.by,   use.assay )  # S4 method for SingleCellExperiment BinCellClusterProbability(   object,   label,   icp.run = NULL,   icp.round = NULL,   funs = \"mean\",   bins = 20,   aggregate.bins.by = \"mean\",   use.assay = \"logcounts\" )"},{"path":"/reference/BinCellClusterProbability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bin cell cluster probability — BinCellClusterProbability","text":"object object SingleCellExperiment class ICP cell  cluster probability tables saved metadata(object)$coralysis$joint.probability.  running one RunParallelICP RunParallelDivisiveICP. label Label interest available colData(object) group  bins cell cluster probability. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability.  default NULL, .e., retrieved. Specify numeric vector  retrieve specific set tables. icp.round ICP round(s) retrieve metadata(object)$coralysis$joint.probability.  default NULL, .e., retrieved. relevant probabilities obtained function RunParallelDivisiveICP, .e., divisive ICP performed. Otherwise ignored internally assumed icp.round = 1,  .e., one round. funs One function summarise ICP cell cluster probability. One \"mean\"  \"median\". default \"mean\". bins Number bins bin cell cluster probability cell label given.  default 20. aggregate.bins.One function aggregate One \"mean\"  \"median\". default \"mean\". use.assay Name assay used obtain average expression  features across cell label probability bins.","code":""},{"path":"/reference/BinCellClusterProbability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bin cell cluster probability — BinCellClusterProbability","text":"SingleCellExperiment class object feature average expression  cell label probability bins.","code":""},{"path":"/reference/BinCellClusterProbability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bin cell cluster probability — BinCellClusterProbability","text":"","code":"# Packages library(\"SingleCellExperiment\") #> Loading required package: SummarizedExperiment #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: ‘MatrixGenerics’ #> The following objects are masked from ‘package:matrixStats’: #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: ‘BiocGenerics’ #> The following objects are masked from ‘package:stats’: #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from ‘package:base’: #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append, #>     as.data.frame, basename, cbind, colnames, dirname, do.call, #>     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted, #>     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin, #>     pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table, #>     tapply, union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: ‘S4Vectors’ #> The following objects are masked from ‘package:base’: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #>  #> Attaching package: ‘Biobase’ #> The following object is masked from ‘package:MatrixGenerics’: #>  #>     rowMedians #> The following objects are masked from ‘package:matrixStats’: #>  #>     anyMissing, rowMedians  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1) #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> 'as(<matrix>, \"dgRMatrix\")' is deprecated. #> Use 'as(as(as(., \"dMatrix\"), \"generalMatrix\"), \"RsparseMatrix\")' instead. #> See help(\"Deprecated\") and help(\"Matrix-deprecated\"). #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Cell states SCE object for a given cell type annotation or clustering cellstate.sce <- BinCellClusterProbability(object = pbmc_10Xassays, label = \"cell_type\", icp.round = 4, bins = 20)  cellstate.sce #> class: SingleCellExperiment  #> dim: 2000 245  #> metadata(1): coralysis #> assays(1): logcounts #> rownames(2000): LYZ S100A9 ... IGSF8 KIR2DL1 #> rowData names(0): #> colnames(245): B mem_bin1 B mem_bin10 ... pDC_bin8 pDC_bin9 #> colData names(4): label probability_bins aggregated_probability_bins #>   aggregated_label_bins #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):"},{"path":"/reference/CellBinsFeatureCorrelation.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell bins feature correlation — CellBinsFeatureCorrelation","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"Correlation cell bins given labels features.","code":""},{"path":"/reference/CellBinsFeatureCorrelation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"","code":"CellBinsFeatureCorrelation.SingleCellExperiment(object, labels, method)  # S4 method for SingleCellExperiment CellBinsFeatureCorrelation(object, labels = NULL, method = \"pearson\")"},{"path":"/reference/CellBinsFeatureCorrelation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"object object SingleCellExperiment class obtained  function BinCellClusterProbability(). labels Character label(s) label provided function  BinCellClusterProbability(). default NULL, .e., labels used. method Character specifying correlation method use. One  \"pearson\", \"kendall\" \"spearman\". default \"pearson\" used.","code":""},{"path":"/reference/CellBinsFeatureCorrelation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"data frame correlation coefficient feature (rows)  across labels (columns).","code":""},{"path":"/reference/CellBinsFeatureCorrelation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell bins feature correlation — CellBinsFeatureCorrelation","text":"","code":"# Packages library(\"SingleCellExperiment\")  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1) #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Cell states SCE object for a given cell type annotation or clustering cellstate.sce <- BinCellClusterProbability(object = pbmc_10Xassays, label = \"cell_type\", icp.round = 4, bins = 20)  cellstate.sce #> class: SingleCellExperiment  #> dim: 2000 245  #> metadata(1): coralysis #> assays(1): logcounts #> rownames(2000): LYZ S100A9 ... IGSF8 KIR2DL1 #> rowData names(0): #> colnames(245): B mem_bin1 B mem_bin10 ... pDC_bin8 pDC_bin9 #> colData names(4): label probability_bins aggregated_probability_bins #>   aggregated_label_bins #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):  # Pearson correlated features with \"Monocyte\" cor.features.mono <- CellBinsFeatureCorrelation(object = cellstate.sce, labels = \"Monocyte\")"},{"path":"/reference/CellClusterProbabilityDistribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Cell cluster probability distribution — CellClusterProbabilityDistribution","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"Plot cell cluster probability distribution per label group.","code":""},{"path":"/reference/CellClusterProbabilityDistribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"","code":"CellClusterProbabilityDistribution.SingleCellExperiment(   object,   label,   group,   probability )  # S4 method for SingleCellExperiment CellClusterProbabilityDistribution(   object,   label,   group,   probability = \"scaled_mean_probs\" )"},{"path":"/reference/CellClusterProbabilityDistribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"object object SingleCellExperiment class aggregated  cell cluster probability available colData(object), can  obtained running SummariseCellClusterProbability(). label Character specifying colData variable use cell  type/cluster label. group Character specifying colData variable use  categorical group variable. probability Character specifying aggregated cell cluster probability  variable available colData, used plot distribution. One  \"mean_probs\", \"scaled_mean_probs\", \"median_probs\",  \"scaled_median_probs\". availability variables colData  depends parameters given function SummariseCellClusterProbability()  beforehand. default assumes \"scaled_mean_probs\" available colData, true SummariseCellClusterProbability()  function run funs = \"mean\" scale.funs = TRUE.","code":""},{"path":"/reference/CellClusterProbabilityDistribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"plot class ggplot.","code":""},{"path":"/reference/CellClusterProbabilityDistribution.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cell cluster probability distribution — CellClusterProbabilityDistribution","text":"","code":"# Packages library(\"SingleCellExperiment\")  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1) #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Summarise cell cluster probability pbmc_10Xassays <- SummariseCellClusterProbability(object = pbmc_10Xassays, icp.round = 4) # save result in 'colData'  # Search for differences in probabilities across group(s)  # give an interesting variable to the \"group\" parameter instead \"batch\" - given for illustrative purposes only prob.dist <- CellClusterProbabilityDistribution(object = pbmc_10Xassays, label = \"cell_type\", group = \"batch\", probability = \"scaled_mean_probs\") prob.dist # print plot"},{"path":"/reference/ClusterCells.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster cells — ClusterCells","title":"Cluster cells — ClusterCells","text":"function clusters cells K-means++ algorithm","code":""},{"path":"/reference/ClusterCells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster cells — ClusterCells","text":"","code":"ClusterCells(object, nclusters = 500, use.emb = TRUE, emb.name = \"PCA\")"},{"path":"/reference/ClusterCells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster cells — ClusterCells","text":"object object SingleCellExperiment class. nclusters Cluster cells n clusters. Ignored number  cells object lower equal nclusters. use.emb embedding used cluster log-transformed  data. default TRUE. emb.name embedding use. default \"PCA\".","code":""},{"path":"/reference/ClusterCells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster cells — ClusterCells","text":"SingleCellExperiment object clusters.","code":""},{"path":"/reference/DownOverSampleEvenlyBatches.html","id":null,"dir":"Reference","previous_headings":"","what":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","title":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","text":"function - -samples cluster cells evenly batch.","code":""},{"path":"/reference/DownOverSampleEvenlyBatches.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","text":"","code":"DownOverSampleEvenlyBatches(x, batch, n = 50)"},{"path":"/reference/DownOverSampleEvenlyBatches.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","text":"x character numeric vector data -oversample. batch character vector batch labels corresponding x. n many cells include per cluster.","code":""},{"path":"/reference/DownOverSampleEvenlyBatches.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Down- and oversample data evenly batches — DownOverSampleEvenlyBatches","text":"list containing output LiblineaR prediction","code":""},{"path":"/reference/DownOverSampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Down- and oversample data — DownOverSampling","title":"Down- and oversample data — DownOverSampling","text":"function implements script - oversamples data include n cells.","code":""},{"path":"/reference/DownOverSampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Down- and oversample data — DownOverSampling","text":"","code":"DownOverSampling(x, n = 50)"},{"path":"/reference/DownOverSampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Down- and oversample data — DownOverSampling","text":"x character numeric vector data -oversample. n many cells include per cluster.","code":""},{"path":"/reference/DownOverSampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Down- and oversample data — DownOverSampling","text":"list containing output LiblineaR prediction","code":""},{"path":"/reference/FindAllClusterMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification of feature markers for all clusters — FindAllClusterMarkers","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"FindAllClusterMarkers enables identifying feature markers  clusters . done differential expresission analysis  cells one cluster compared cells rest  clusters. Feature cell filters can applied accelerate analysis,  might lead missing weak signals.","code":""},{"path":"/reference/FindAllClusterMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"","code":"FindAllClusterMarkers.SingleCellExperiment(   object,   clustering.label,   test,   log2fc.threshold,   min.pct,   min.diff.pct,   min.cells.group,   max.cells.per.cluster,   return.thresh,   only.pos )  # S4 method for SingleCellExperiment FindAllClusterMarkers(   object,   clustering.label,   test = \"wilcox\",   log2fc.threshold = 0.25,   min.pct = 0.1,   min.diff.pct = NULL,   min.cells.group = 3,   max.cells.per.cluster = NULL,   return.thresh = 0.01,   only.pos = FALSE )"},{"path":"/reference/FindAllClusterMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"object SingleCellExperiment object. clustering.label variable name (class character) available  cell metadata colData(object) clustering labels  (character factor) use. test test use. \"wilcox\" (Wilcoxon rank-sum test, AKA Mann-Whitney U test) supported moment. log2fc.threshold Filters features log2 fold-change averaged feature expression values threshold. Default 0.25. min.pct Filters features dropout rate (fraction cells expressing feature) threshold comparison groups. Default  0.1. min.diff.pct Filters features minimum difference dropout rates (fraction cells expressing feature) two comparison groups. Default NULL. min.cells.group minimum number cells two comparison groups perform DE analysis. number cells threshold, DE analysis cluster skipped. Default 3. max.cells.per.cluster maximum number cells per cluster downsampling performed speed DE analysis. Default NULL,  .e., downsampling. return.thresh .pos=TRUE, return features adjusted p-value (adjusted Bonferroni method) equal threshold. Default 0.01. .pos Whether return features adjusted p-value (adjusted Bonferroni method) equal threshold. Default  FALSE.","code":""},{"path":"/reference/FindAllClusterMarkers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"data frame results positive results found, else NULL.","code":""},{"path":"/reference/FindAllClusterMarkers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identification of feature markers for all clusters — FindAllClusterMarkers","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Perform differential expression on a given clustering or cell type annotations ## Clustering # Perform clustering on the integrated PCA with your favorite algorithm, e.g., graph-based clustering with 'scran' #set .seed(123) #pbmc_10Xassays$cluster <- scran::clusterCells(pbmc_10Xassays, use.dimred=\"PCA\", BLUSPARAM = bluster::SNNGraphParam(k = 15, cluster.fun = \"louvain\")) #markers <- FindAllClusterMarkers(pbmc_10Xassays, clustering.label = \"cluster\")  ## Cell type annotations or other pre-existing annotations  markers <- FindAllClusterMarkers(pbmc_10Xassays, clustering.label = \"cell_type\") #> ----------------------------------- #> testing cluster aDC #> 1470 features left after min.pct filtering #> 1470 features left after min.diff.pct filtering #> 362 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster B mem #> 1302 features left after min.pct filtering #> 1302 features left after min.diff.pct filtering #> 266 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster B naive #> 1198 features left after min.pct filtering #> 1198 features left after min.diff.pct filtering #> 352 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD4 mem #> 1140 features left after min.pct filtering #> 1140 features left after min.diff.pct filtering #> 210 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD4 naive #> 1132 features left after min.pct filtering #> 1132 features left after min.diff.pct filtering #> 306 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD8 eff #> 1147 features left after min.pct filtering #> 1147 features left after min.diff.pct filtering #> 225 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD8 T #> 1185 features left after min.pct filtering #> 1185 features left after min.diff.pct filtering #> 270 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster HSC #> 1520 features left after min.pct filtering #> 1520 features left after min.diff.pct filtering #> 378 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster Megakaryocyte #> 1289 features left after min.pct filtering #> 1289 features left after min.diff.pct filtering #> 495 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster Monocyte #> 1191 features left after min.pct filtering #> 1191 features left after min.diff.pct filtering #> 482 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster CD16+ monocyte #> 1146 features left after min.pct filtering #> 1146 features left after min.diff.pct filtering #> 391 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster NK #> 1256 features left after min.pct filtering #> 1256 features left after min.diff.pct filtering #> 353 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster pDC #> 1442 features left after min.pct filtering #> 1442 features left after min.diff.pct filtering #> 498 features left after log2fc.threshold filtering #> ----------------------------------- #> ----------------------------------- #> testing cluster Treg #> 1236 features left after min.pct filtering #> 1236 features left after min.diff.pct filtering #> 256 features left after log2fc.threshold filtering #> -----------------------------------"},{"path":"/reference/FindBatchKNN.html","id":null,"dir":"Reference","previous_headings":"","what":"Find batch k nearest neighbors — FindBatchKNN","title":"Find batch k nearest neighbors — FindBatchKNN","text":"function finds batch k nearest neighbors cell highest  probability every batch.","code":""},{"path":"/reference/FindBatchKNN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find batch k nearest neighbors — FindBatchKNN","text":"","code":"FindBatchKNN(idx, group, prob, k = 10)"},{"path":"/reference/FindBatchKNN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find batch k nearest neighbors — FindBatchKNN","text":"idx numeric vector cell ids retrieve data set. group character vector batch labels corresponding idx. prob numeric vector cell probabilities corresponding idx. k number nearest neighbors search . Default 10.","code":""},{"path":"/reference/FindBatchKNN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find batch k nearest neighbors — FindBatchKNN","text":"list containing k nearest neighbors every cell queried","code":""},{"path":"/reference/FindClusterBatchKNN.html","id":null,"dir":"Reference","previous_headings":"","what":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","title":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","text":"function finds batch k nearest neighbors cell highest  probability every batch per cluster.","code":""},{"path":"/reference/FindClusterBatchKNN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","text":"","code":"FindClusterBatchKNN(preds, probs, batch, k = 10, k.prop = NULL)"},{"path":"/reference/FindClusterBatchKNN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","text":"preds numeric vector cell cluster predictions. probs numeric matrix cell cluster probabilities. batch character batch labels. k number nearest neighbors search . Default 10. k.prop numeric (higher 0 lower 1) corresponding  fraction cells per cluster use k nearest neighbors. Default  NULL meaning number k nearest neighbors equal k. given, k parameter ignored k calculated based k.prop.","code":""},{"path":"/reference/FindClusterBatchKNN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find batch k nearest neighbors per cluster — FindClusterBatchKNN","text":"list containing k nearest neighbors every cluster","code":""},{"path":"/reference/FindClusterMarkers.html","id":null,"dir":"Reference","previous_headings":"","what":"Differential expression between cell clusters — FindClusterMarkers","title":"Differential expression between cell clusters — FindClusterMarkers","text":"FindClusterMarkers enables identifying feature markers one  cluster two arbitrary combinations clusters, e.g. 1_2 vs. 3_4_5. Feature  cell filters can applied accelerate analysis, might  lead missing weak signals.","code":""},{"path":"/reference/FindClusterMarkers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Differential expression between cell clusters — FindClusterMarkers","text":"","code":"FindClusterMarkers.SingleCellExperiment(   object,   clustering.label,   clusters.1,   clusters.2,   test,   log2fc.threshold,   min.pct,   min.diff.pct,   min.cells.group,   max.cells.per.cluster,   return.thresh,   only.pos )  # S4 method for SingleCellExperiment FindClusterMarkers(   object,   clustering.label,   clusters.1 = NULL,   clusters.2 = NULL,   test = \"wilcox\",   log2fc.threshold = 0.25,   min.pct = 0.1,   min.diff.pct = NULL,   min.cells.group = 3,   max.cells.per.cluster = NULL,   return.thresh = 0.01,   only.pos = FALSE )"},{"path":"/reference/FindClusterMarkers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Differential expression between cell clusters — FindClusterMarkers","text":"object SingleCellExperiment object. #' @param clustering.label variable name (class character) available  cell metadata colData(object) clustering labels  (character factor) use. clusters.1 character numeric vector denoting clusters use first group (named group.1 results) clusters.2 character numeric vector denoting clusters use second group (named group.2 results) test test use. \"wilcoxon\" (Wilcoxon rank-sum test, AKA Mann-Whitney U test) supported moment. log2fc.threshold Filters features log2 fold-change averaged feature expression values threshold. Default 0.25. min.pct Filters features dropout rate (fraction cells expressing feature) threshold comparison groups Default 0.1. min.diff.pct Filters features minimum difference dropout rates (fraction cells expressing feature) two comparison groups. Default NULL. min.cells.group minimum number cells two comparison groups perform DE analysis. number cells threshold, DE analysis performed. Default 3. max.cells.per.cluster maximun number cells per cluster downsampling performed speed DE analysis. Default NULL, .e. downsampling. return.thresh .pos=TRUE, return features adjusted p-value (adjusted Bonferroni method) equal threshold.  Default 0.01. .pos Whether return features adjusted p-value (adjusted Bonferroni method) equal threshold. Default FALSE.","code":""},{"path":"/reference/FindClusterMarkers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Differential expression between cell clusters — FindClusterMarkers","text":"data frame results positive results found, else NULL","code":""},{"path":"/reference/FindClusterMarkers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Differential expression between cell clusters — FindClusterMarkers","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Perform differential expression on a given clustering or cell type annotations ## Clustering # Perform clustering on the integrated PCA with your favorite algorithm, e.g., graph-based clustering with 'scran' #set .seed(123) #pbmc_10Xassays$cluster <- scran::clusterCells(pbmc_10Xassays, use.dimred=\"PCA\", BLUSPARAM = bluster::SNNGraphParam(k = 15, cluster.fun = \"louvain\")) #cluster_markers_1 <- FindClusterMarkers(pbmc_10Xassays, clustering.label = \"cluster\", clusters.1 = \"1\")  #cluster_markers_1_vs_2 <- FindClusterMarkers(pbmc_10Xassays, clustering.label = \"cluster\", clusters.1 = \"1\", clusters.1 = \"2\")   ## Cell type annotations or other pre-existing annotations   gene_markers_Bmem <- FindClusterMarkers(pbmc_10Xassays, clustering.label = \"cell_type\", clusters.1 = \"B mem\") #> testing cluster group.1 #> 1302 features left after min.pct filtering #> 1302 features left after min.diff.pct filtering #> 266 features left after log2fc.threshold filtering gene_markers_Bmem_vs_Bnaive <- FindClusterMarkers(pbmc_10Xassays, clustering.label = \"cell_type\", clusters.1 = \"B mem\", clusters.2 = \"B naive\")  #> testing cluster group.1 #> 1151 features left after min.pct filtering #> 1151 features left after min.diff.pct filtering #> 103 features left after log2fc.threshold filtering"},{"path":"/reference/GetCellClusterProbability.html","id":null,"dir":"Reference","previous_headings":"","what":"Get ICP cell cluster probability — GetCellClusterProbability","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"Get ICP cell cluster probability table(s)","code":""},{"path":"/reference/GetCellClusterProbability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"","code":"GetCellClusterProbability.SingleCellExperiment(   object,   icp.run,   icp.round,   concatenate )  # S4 method for SingleCellExperiment GetCellClusterProbability(   object,   icp.run = NULL,   icp.round = NULL,   concatenate = TRUE )"},{"path":"/reference/GetCellClusterProbability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"object object SingleCellExperiment class ICP cell  cluster probability tables saved metadata(object)$coralysis$joint.probability.  running RunParallelDivisiveICP. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability.  default NULL, .e., retrieved. Specify numeric vector  retrieve specific set tables. icp.round ICP round(s) retrieve metadata(object)$coralysis$joint.probability.  default NULL, .e., retrieved. concatenate Concatenate list ICP cell cluster probability tables retrieved.  default TRUE, .e., list ICP cell cluster probability tables concatenated.","code":""},{"path":"/reference/GetCellClusterProbability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"list ICP cell cluster probability tables matrix  concatenated tables.","code":""},{"path":"/reference/GetCellClusterProbability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get ICP cell cluster probability — GetCellClusterProbability","text":"","code":"#' # Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Get cluster probability for all ICP runs for the last 4th round  probs <- GetCellClusterProbability(object = pbmc_10Xassays, icp.round = 4, concatenate = TRUE) # matrix 2,000 cells x 56 cell clusters"},{"path":"/reference/GetFeatureCoefficients.html","id":null,"dir":"Reference","previous_headings":"","what":"Get feature coefficients — GetFeatureCoefficients","title":"Get feature coefficients — GetFeatureCoefficients","text":"Get feature coefficients ICP models.","code":""},{"path":"/reference/GetFeatureCoefficients.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get feature coefficients — GetFeatureCoefficients","text":"","code":"GetFeatureCoefficients.SingleCellExperiment(   object,   icp.run = NULL,   icp.round = NULL )  # S4 method for SingleCellExperiment GetFeatureCoefficients(object, icp.run = NULL, icp.round = NULL)"},{"path":"/reference/GetFeatureCoefficients.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get feature coefficients — GetFeatureCoefficients","text":"object object SingleCellExperiment class ICP cell  cluster probability tables saved metadata(object)$coralysis$joint.probability.  running RunParallelDivisiveICP. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability.  default NULL, .e., retrieved. Specify numeric vector  retrieve specific set tables. icp.round ICP round(s) retrieve metadata(object)$coralysis$joint.probability.  default NULL, .e., retrieved.","code":""},{"path":"/reference/GetFeatureCoefficients.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get feature coefficients — GetFeatureCoefficients","text":"list feature coefficient weights per cluster per ICP run/round.","code":""},{"path":"/reference/GetFeatureCoefficients.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get feature coefficients — GetFeatureCoefficients","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # GetFeatureCoefficients gene_coefficients_icp_2_4 <- GetFeatureCoefficients(object = pbmc_10Xassays, icp.run = 2, icp.round = 4) #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result head(gene_coefficients_icp_2_4$icp_8) #>   feature  coeff_clt1 coeff_clt2   coeff_clt3   coeff_clt4  coeff_clt5 #> 1    ACTB -0.04227882  0.0000000 -0.002538485 -0.005484716 -0.02505979 #> 2   ACTG1  0.00000000 -0.5654091  0.000000000  0.000000000  0.00000000 #> 3     AES  0.00000000  0.0000000  0.000000000  0.000000000  0.00000000 #> 4    AIF1  0.00000000  0.0000000  0.000000000  0.000000000  0.00000000 #> 5 ANKRD12  0.00000000  0.0000000  0.000000000  0.000000000  0.00000000 #> 6   ANXA1  0.00000000  0.0000000 -0.101121661  0.000000000  0.00000000 #>      coeff_clt6  coeff_clt7 coeff_clt8  coeff_clt9  coeff_clt10 coeff_clt11 #> 1  0.0000000000 -0.01047122  0.0000000 -0.01757908  0.000000000 -0.05862168 #> 2 -0.0009015467  0.00000000  0.0000000  0.00000000 -0.007161188  0.00000000 #> 3  0.0000000000  0.00000000  0.0000000  0.00000000  0.000000000  0.00000000 #> 4  0.0000000000  0.00000000  0.1389333  0.00000000  0.000000000  0.00000000 #> 5  0.0000000000  0.00000000  0.0000000  0.00000000  0.000000000  0.00000000 #> 6  0.0000000000  0.00000000  0.0000000  0.00000000  0.000000000  0.00000000 #>   coeff_clt12 coeff_clt13 coeff_clt14  coeff_clt15 coeff_clt16 #> 1           0 -0.03066832  0.00000000  0.000000000 0.000000000 #> 2           0  0.00000000  0.00000000  0.000000000 0.000000000 #> 3           0  0.00000000 -0.08138357  0.000285507 0.006519562 #> 4           0  0.00000000  0.00000000  0.000000000 0.000000000 #> 5           0  0.00000000  0.00000000 -0.430041506 0.256644521 #> 6           0  0.00000000  0.00000000  0.000000000 0.065202564"},{"path":"/reference/HeatmapFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"HeatmapFeatures function draws heatmap features  cluster identity.","code":""},{"path":"/reference/HeatmapFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"","code":"HeatmapFeatures.SingleCellExperiment(object, clustering.label, features, ...)  # S4 method for SingleCellExperiment HeatmapFeatures(object, clustering.label, features, ...)"},{"path":"/reference/HeatmapFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"object SingleCellExperiment class clustering.label variable name (class character) available  cell metadata colData(object) clustering labels  (character factor) use. features Feature names plot cluster (character) matching  row.names(object). ... Parameters pass pheatmap::pheatmap function.","code":""},{"path":"/reference/HeatmapFeatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"nothing","code":""},{"path":"/reference/HeatmapFeatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Heatmap visualization of the expression of features by clusters — HeatmapFeatures","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Plot features by cell type (give a clustering instead) genes <- c(\"CD8A\", \"CCR7\", \"GZMA\", \"MS4A1\", \"CD27\") HeatmapFeatures(object = pbmc_10Xassays, clustering.label = \"cell_type\", features = genes) # log-normalized  HeatmapFeatures(object = pbmc_10Xassays, clustering.label = \"cell_type\", features = genes, scale = \"row\") # scale genes"},{"path":"/reference/LogisticRegression.html","id":null,"dir":"Reference","previous_headings":"","what":"Clustering projection using logistic regression from\nthe LiblineaR R package — LogisticRegression","title":"Clustering projection using logistic regression from\nthe LiblineaR R package — LogisticRegression","text":"function implements script downsamples data dataset, trains logistic regression classifier model projects clustering onto using trained L1-regularized logistic regression model.","code":""},{"path":"/reference/LogisticRegression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clustering projection using logistic regression from\nthe LiblineaR R package — LogisticRegression","text":"","code":"LogisticRegression(   training.sparse.matrix = NULL,   training.ident = NULL,   C = 0.3,   reg.type = \"L1\",   test.sparse.matrix = NULL,   d = 0.3,   batch.label = NULL,   training_ident_subset = NULL )"},{"path":"/reference/LogisticRegression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clustering projection using logistic regression from\nthe LiblineaR R package — LogisticRegression","text":"training.sparse.matrix sparse matrix (dgCMatrix) containing training sample's feature expression data features rows cells columns. Default NULL. training.ident named factor containing sample's cluster labels cell training.sparse.matrix. Default NULL. C Cost constraints violation L1-regularized logistic regression (C). Default 0.3. reg.type \"L1\" LASSO \"L2\" Ridge. Default \"L1\". test.sparse.matrix sparse matrix (dgCMatrix) containing test sample's feature expression data features rows cells columns. Default NULL. d numeric smaller 1 greater 0 determines many cells per cluster - oversampled (d N/k*d), N total number cells k number clusters. Default 0.3. batch.label character vector batch labels corresponding cells given training.ident. character batch labels need named cells names given training.ident. default NULL,  .e., cells sampled evenly regardless batch. training_ident_subset character numeric vector cell ids  use train set. default NULL. given, - oversampled parameters ignored.","code":""},{"path":"/reference/LogisticRegression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clustering projection using logistic regression from\nthe LiblineaR R package — LogisticRegression","text":"list containing output LiblineaR prediction","code":""},{"path":"/reference/MajorityVotingFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Majority voting features by label — MajorityVotingFeatures","title":"Majority voting features by label — MajorityVotingFeatures","text":"Get ICP feature coefficients label interest majority voting label across ICP clusters.","code":""},{"path":"/reference/MajorityVotingFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Majority voting features by label — MajorityVotingFeatures","text":"","code":"MajorityVotingFeatures.SingleCellExperiment(object, label)  # S4 method for SingleCellExperiment MajorityVotingFeatures(object, label)"},{"path":"/reference/MajorityVotingFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Majority voting features by label — MajorityVotingFeatures","text":"object object SingleCellExperiment class ICP cell  cluster probability tables saved metadata(object)$coralysis$joint.probability.  running RunParallelDivisiveICP. label Label interest available colData(object).","code":""},{"path":"/reference/MajorityVotingFeatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Majority voting features by label — MajorityVotingFeatures","text":"list list data frames feature weights per label data frame summary label.","code":""},{"path":"/reference/MajorityVotingFeatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Majority voting features by label — MajorityVotingFeatures","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Get gene coefficients by majority voting for a given clustering or cell type annotations gene_coeff <- MajorityVotingFeatures(object = pbmc_10Xassays, label = \"cell_type\") #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result #> Warning: column names ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’, ‘coeff.x’, ‘coeff.y’ are duplicated in the result gene_coeff$summary #>             label icp_run icp_round cluster     score #> 1             aDC       2         4       7 0.8464321 #> 2           B mem       4         4       3 0.7694876 #> 3         B naive       3         3       2 0.8987839 #> 4         CD4 mem       3         4      16 0.7399265 #> 5       CD4 naive       3         3       8 0.6704215 #> 6         CD8 eff       2         3       5 0.8324150 #> 7           CD8 T       2         4      13 0.6640691 #> 8             HSC       4         4       2 0.5000000 #> 9   Megakaryocyte       4         3       7 0.1178511 #> 10       Monocyte       4         3       4 0.9273383 #> 11 CD16+ monocyte       4         4       5 0.9485040 #> 12             NK       2         3       6 0.9174312 #> 13            pDC       1         4       1 1.0000000 #> 14           Treg       3         4      16 0.2145881 head(gene_coeff$feature_coeff$Monocyte[order(gene_coeff$feature_coeff$Monocyte$coeff_clt4, decreasing = TRUE), ], n = 15) #>          feature coeff_clt4 #> 57        S100A8 0.50956344 #> 9           FCN1 0.36156018 #> 22        LGALS2 0.31951242 #> 58        S100A9 0.28751527 #> 24           LYZ 0.22706608 #> 4          CEBPD 0.10636171 #> 5           CST3 0.10408997 #> 27        MS4A6A 0.08288454 #> 61        TYROBP 0.07518187 #> 12          GPX1 0.05788580 #> 26          MNDA 0.05503557 #> 36 RP11-1143G9.4 0.05498114 #> 18       HLA-DRA 0.05219189 #> 1          AP1S2 0.04030567 #> 13           GRN 0.04017337 PlotExpression(object = pbmc_10Xassays, color.by = \"LGALS2\")"},{"path":"/reference/PCAElbowPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"Draw elbow plot standard deviations principal  components deduce appropriate value p.","code":""},{"path":"/reference/PCAElbowPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"","code":"PCAElbowPlot.SingleCellExperiment(object, dimred.name, return.plot)  # S4 method for SingleCellExperiment PCAElbowPlot(object, dimred.name = \"PCA\", return.plot = FALSE)"},{"path":"/reference/PCAElbowPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"object SingleCellExperiment object obtained running  RunParallelDivisiveICP. dimred.name Dimensional reduction name PCA select  reducedDimNames(object). default \"PCA\". return.plot logical indicating ggplot2 object returned. default FALSE.","code":""},{"path":"/reference/PCAElbowPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"ggplot2 object, return.plot=TRUE.","code":""},{"path":"/reference/PCAElbowPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Elbow plot of the standard deviations of the principal components — PCAElbowPlot","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Plot Elbow PCAElbowPlot(pbmc_10Xassays)"},{"path":"/reference/PlotClusterTree.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot cluster tree — PlotClusterTree","title":"Plot cluster tree — PlotClusterTree","text":"Plot cluster tree cluster probability categorical variable.","code":""},{"path":"/reference/PlotClusterTree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot cluster tree — PlotClusterTree","text":"","code":"PlotClusterTree.SingleCellExperiment(   object,   icp.run,   color.by,   use.color,   seed.color,   legend.title,   return.data )  # S4 method for SingleCellExperiment PlotClusterTree(   object,   icp.run,   color.by = NULL,   use.color = NULL,   seed.color = 123,   legend.title = color.by,   return.data = FALSE )"},{"path":"/reference/PlotClusterTree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot cluster tree — PlotClusterTree","text":"object object SingleCellExperiment class. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability.  default NULL, .e., retrieved. Specify numeric vector  retrieve specific set tables. color.Categorical variable available colData(object)  plot. NULL cluster probability represented instead.  default NULL. use.color Character specifying colors. default NULL, .e.,  colors randomly chosen based seed given seed.color. seed.color Seed randomly select colors. default 123. legend.title Legend title. default given color.. Ignored color.NULL. return.data Return data frame used plot. Logical. default FALSE,  .e., plot returned.","code":""},{"path":"/reference/PlotClusterTree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot cluster tree — PlotClusterTree","text":"plot class ggplot list plot class ggplot data frame.","code":""},{"path":"/reference/PlotClusterTree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot cluster tree — PlotClusterTree","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Plot probability PlotClusterTree(object = pbmc_10Xassays, icp.run = 2)   # Plot batch label distribution PlotClusterTree(object = pbmc_10Xassays, icp.run = 2, color.by = \"batch\")   # Plot cell type label distribution PlotClusterTree(object = pbmc_10Xassays, icp.run = 2, color.by = \"cell_type\")"},{"path":"/reference/PlotDimRed.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot dimensional reduction categorical variables — PlotDimRed","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"Plot categorical variables dimensional reduction.","code":""},{"path":"/reference/PlotDimRed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"","code":"PlotDimRed.SingleCellExperiment(   object,   color.by,   dimred,   dims,   use.color,   point.size,   point.stroke,   legend.nrow,   seed.color,   label,   plot.theme,   rasterise,   rasterise.dpi,   legend.justification,   legend.size,   legend.title )  # S4 method for SingleCellExperiment PlotDimRed(   object,   color.by,   dimred = tail(reducedDimNames(object), n = 1),   dims = 1:2,   use.color = NULL,   point.size = 1,   point.stroke = 1,   legend.nrow = 2,   seed.color = 123,   label = FALSE,   plot.theme = theme_classic(),   rasterise = (ncol(object) <= 30000),   rasterise.dpi = 300,   legend.justification = \"center\",   legend.size = 10,   legend.title = color.by )"},{"path":"/reference/PlotDimRed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"object object SingleCellExperiment class. color.Categorical variable available colData(object)  plot. dimred Dimensional reduction available ReducedDimNames(object) plot. default last dimensional reduction object used. dims Dimensions dimensional reduction embedding plot. use.color Character specifying colors. default NULL, .e.,  colors randomly chosen based seed given seed.color. point.size Size points. default 1. point.stroke Size stroke. default 1. legend.nrow Display legend items number rows. default 2. seed.color Seed randomly select colors. default 123. label Logical add categorical labels centroid categories.  default FALSE, .e., labels added. plot.theme Plot theme available ggplot2. default theme_classic(). rasterise Logical specifying points rasterised .  default TRUE, 3e4 cells, otherwise FALSE. rasterise.dpi case rasterise = TRUE, DPI use. default  300. legend.justification Legend justification. default \"center\". legend.size Legend size. default 10 legend.title Legend title. default given color..","code":""},{"path":"/reference/PlotDimRed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"plot class ggplot.","code":""},{"path":"/reference/PlotDimRed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot dimensional reduction categorical variables — PlotDimRed","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Run UMAP set.seed(123) pbmc_10Xassays <- RunUMAP(pbmc_10Xassays, dimred.type = \"PCA\")  # Plot batch  PlotDimRed(object = pbmc_10Xassays, color.by = \"batch\", dimred = \"UMAP\")   # Plot cell type annotations PlotDimRed(object = pbmc_10Xassays, color.by = \"cell_type\", legend.nrow = 3, dimred = \"UMAP\", label = TRUE) #> Warning: Removed 1986 rows containing missing values or values outside the scale range #> (`geom_text_repel()`)."},{"path":"/reference/PlotExpression.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot dimensional reduction feature expression — PlotExpression","title":"Plot dimensional reduction feature expression — PlotExpression","text":"Plot feature expression dimensional reduction.","code":""},{"path":"/reference/PlotExpression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot dimensional reduction feature expression — PlotExpression","text":"","code":"PlotExpression.SingleCellExperiment(   object,   color.by,   dimred,   scale.values,   color.scale,   plot.theme,   legend.title,   point.size,   point.stroke )  # S4 method for SingleCellExperiment PlotExpression(   object,   color.by,   dimred = tail(reducedDimNames(object), n = 1),   scale.values = FALSE,   color.scale = \"inferno\",   plot.theme = theme_classic(),   legend.title = color.by,   point.size = 1,   point.stroke = 1 )"},{"path":"/reference/PlotExpression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot dimensional reduction feature expression — PlotExpression","text":"object object SingleCellExperiment class. color.Categorical variable available colData(object)  plot. dimred Dimensional reduction available ReducedDimNames(object) plot. default last dimensional reduction object used. color.scale Character color scale palette passed  ggplot2::scale_color_viridis_c. default inferno. palettes also available viridis. plot.theme Plot theme available ggplot2. default theme_classic(). legend.title Legend title. default given color.. point.size Size points. default 1. point.stroke Size stroke. default 1.","code":""},{"path":"/reference/PlotExpression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot dimensional reduction feature expression — PlotExpression","text":"plot class ggplot.","code":""},{"path":"/reference/PlotExpression.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot dimensional reduction feature expression — PlotExpression","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Run UMAP set.seed(123) pbmc_10Xassays <- RunUMAP(pbmc_10Xassays, dimred.type = \"PCA\")  # Plot cell cluster probabilities - mean # possible options: \"mean_probs\", \"median_probs\", \"scaled_median_probs\"  pbmc_10Xassays <- SummariseCellClusterProbability(object = pbmc_10Xassays, icp.round = 4, scale.funs = TRUE, save.in.sce = TRUE) # save result in 'colData' PlotExpression(object = pbmc_10Xassays, color.by = \"scaled_mean_probs\", dimred = \"UMAP\", color.scale = \"viridis\", legend.title = \"Scaled mean prob.\\n(min-max)\")    # Plot expression level of one or more features ## one  PlotExpression(object = pbmc_10Xassays, color.by = \"LGALS2\", dimred = \"UMAP\")   ## more than one genes <- c(\"CD8A\", \"CCR7\", \"GZMA\", \"MS4A1\", \"CD27\") exp.plots <- lapply(X = genes, FUN = function(x) {     PlotExpression(object = pbmc_10Xassays, color.by = x, dimred = \"UMAP\", scale.values = TRUE, point.size = 0.25, point.stroke = 0.25) }) cowplot::plot_grid(plotlist = exp.plots, ncol = 5, align = \"vh\")"},{"path":"/reference/PrepareData.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare SingleCellExperiment object for analysis — PrepareData","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"function prepares SingleCellExperiment object  analysis. required input object class SingleCellExperiment  least data logcounts slot.","code":""},{"path":"/reference/PrepareData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"","code":"PrepareData.SingleCellExperiment(object)  # S4 method for SingleCellExperiment PrepareData(object)"},{"path":"/reference/PrepareData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"object object SingleCellExperiment class.","code":""},{"path":"/reference/PrepareData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"object SingleCellExperiment class.","code":""},{"path":"/reference/PrepareData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare SingleCellExperiment object for analysis — PrepareData","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Run function pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values."},{"path":"/reference/RandomlyDivisiveClustering.html","id":null,"dir":"Reference","previous_headings":"","what":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","title":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","text":"Splits randomly every cluster given k clusters","code":""},{"path":"/reference/RandomlyDivisiveClustering.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","text":"","code":"RandomlyDivisiveClustering(cluster, k, cluster.names = NULL)"},{"path":"/reference/RandomlyDivisiveClustering.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","text":"cluster clustering result cluster divided  randomly k clusters. k number clusters cluster given cluster  randomly divided . cluster.names Names name cluster result given.  default NULL.","code":""},{"path":"/reference/RandomlyDivisiveClustering.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split randomly every cluster into k clusters — RandomlyDivisiveClustering","text":"clustering result every cluster given split randomly  k clusters.","code":""},{"path":"/reference/ReferenceMapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Reference mapping — ReferenceMapping","title":"Reference mapping — ReferenceMapping","text":"function allows project new query data sets onto reference  built Coralysis well transfer cell labels reference queries.","code":""},{"path":"/reference/ReferenceMapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reference mapping — ReferenceMapping","text":"","code":"ReferenceMapping.SingleCellExperiment(   ref,   query,   ref.label,   scale.query.by,   project.umap,   select.icp.models,   k.nn,   dimred.name.prefix )  # S4 method for SingleCellExperiment,SingleCellExperiment ReferenceMapping(   ref,   query,   ref.label,   scale.query.by = NULL,   project.umap = FALSE,   select.icp.models = metadata(ref)$coralysis$pca.params$select.icp.tables,   k.nn = 10,   dimred.name.prefix = \"\" )"},{"path":"/reference/ReferenceMapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reference mapping — ReferenceMapping","text":"ref object SingleCellExperiment class trained Coralysis running RunPCA(..., return.model = TRUE) function. query object SingleCellExperiment class project onto  ref. ref.label character cell metadata column name ref  object transfer queries. scale.query.query data scaled cell  feature. default NULL, .e., scaled. Scale  reference scaled. project.umap Project query data onto reference UMAP (logical).  default FALSE. TRUE, ref object needs  UMAP embedding obtained RunUMAP(..., return.model = TRUE) function. k.nn number k nearest neighbors use classification KNN algorithm used transfer labels reference queries (integer). default 10. dimred.name.prefix Dimensional reduction name prefix add  computed PCA UMAP. default nothing added, .e.,  dimred.name.prefix = \"\". selecte.icp.models Select reference ICP models use query  cluster probability prediction. default metadata(ref)$coralysis$pca.params$select.icp.tables,  .e., models selected compute reference PCA selected.  NULL used. Otherwise numeric vector given select ICP models interest.","code":""},{"path":"/reference/ReferenceMapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reference mapping — ReferenceMapping","text":"object SingleCellExperiment class.","code":""},{"path":"/reference/ReferenceMapping.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reference mapping — ReferenceMapping","text":"","code":"## Reference-mapping # Split the SCE object by 'batch' ref <- pbmc_10Xassays[,pbmc_10Xassays$batch==\"V2\"] # let V2 assay batch be the reference data set query <- pbmc_10Xassays[,pbmc_10Xassays$batch==\"V1\"] # let V1 be the query (unknown annotations)  # 1) Train the reference - 'L = 4' just for highlighting purposes; use 'L=50' (default) or greater set.seed(123) ref <- RunParallelDivisiveICP(object = ref, L = 4, divisive.method = \"cluster\", threads = 1) # runs without 'batch.label' as it represents 1 sample only #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 500 2 #> EPOCH: 1 #> current clustering = 250 250 #> projected clustering = 243 257 #> ARI=0.824111794972596 #> probability matrix dimensions = 500 2 #> EPOCH: 2 #> current clustering = 243 257 #> projected clustering = 253 247 #> ARI=0.890917588495972 #> probability matrix dimensions = 500 2 #> EPOCH: 3 #> current clustering = 253 247 #> projected clustering = 255 245 #> ARI=0.906115952548316 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 255 245 #> projected clustering = 254 246 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 255 245 #> projected clustering = 255 245 #> ARI=0.921442683857967 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 255 245 #> projected clustering = 254 246 #> ARI=0.960320530116754 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 254 246 #> projected clustering = 269 231 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 254 246 #> projected clustering = 252 248 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 254 246 #> projected clustering = 260 240 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 254 246 #> projected clustering = 250 250 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 254 246 #> projected clustering = 251 249 #> probability matrix dimensions = 500 4 #> EPOCH: 1 #> current clustering = 123 123 127 127 #> projected clustering = 104 134 129 133 #> ARI=0.520819635224991 #> probability matrix dimensions = 500 4 #> EPOCH: 2 #> current clustering = 104 134 129 133 #> projected clustering = 111 127 134 128 #> ARI=0.670161331317624 #> probability matrix dimensions = 500 4 #> EPOCH: 3 #> current clustering = 111 127 134 128 #> projected clustering = 119 117 139 125 #> ARI=0.781665569263852 #> probability matrix dimensions = 500 4 #> EPOCH: 4 #> current clustering = 119 117 139 125 #> projected clustering = 119 114 124 143 #> ARI=0.820318265538334 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 119 114 124 143 #> projected clustering = 117 111 114 158 #> ARI=0.835943289259642 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 117 111 114 158 #> projected clustering = 120 105 119 156 #> ARI=0.854033281567644 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 120 105 119 156 #> projected clustering = 123 102 122 153 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 120 105 119 156 #> projected clustering = 125 101 127 147 #> ARI=0.857939738942163 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 125 101 127 147 #> projected clustering = 123 100 138 139 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 125 101 127 147 #> projected clustering = 128 97 126 149 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 125 101 127 147 #> projected clustering = 127 98 123 152 #> ARI=0.862546483726132 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 127 98 123 152 #> projected clustering = 126 97 130 147 #> ARI=0.89636150946619 #> probability matrix dimensions = 500 4 #> EPOCH: 10 #> current clustering = 126 97 130 147 #> projected clustering = 126 97 139 138 #> ARI=0.938010963844231 #> probability matrix dimensions = 500 4 #> EPOCH: 11 #> current clustering = 126 97 139 138 #> projected clustering = 126 97 142 135 #> ARI=0.982574507597867 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 126 97 142 135 #> projected clustering = 126 96 145 133 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 126 97 142 135 #> projected clustering = 129 94 143 134 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 126 97 142 135 #> projected clustering = 126 97 138 139 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 126 97 142 135 #> projected clustering = 127 96 145 132 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 126 97 142 135 #> projected clustering = 126 97 138 139 #> probability matrix dimensions = 500 8 #> EPOCH: 1 #> current clustering = 49 48 68 67 63 63 71 71 #> projected clustering = 38 59 52 88 47 79 72 65 #> ARI=0.494301551803411 #> probability matrix dimensions = 500 8 #> EPOCH: 2 #> current clustering = 38 59 52 88 47 79 72 65 #> projected clustering = 35 64 49 89 47 79 63 74 #> ARI=0.707363021678207 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 35 64 49 89 47 79 63 74 #> projected clustering = 44 55 56 79 42 85 63 76 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 35 64 49 89 47 79 63 74 #> projected clustering = 31 68 50 93 44 82 75 57 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 35 64 49 89 47 79 63 74 #> projected clustering = 34 64 69 76 46 80 59 72 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 35 64 49 89 47 79 63 74 #> projected clustering = 33 63 69 70 48 79 66 72 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 35 64 49 89 47 79 63 74 #> projected clustering = 31 68 69 71 38 87 69 67 #> probability matrix dimensions = 500 16 #> EPOCH: 1 #> current clustering = 32 32 25 24 40 39 45 44 32 31 37 37 24 23 18 17 #> projected clustering = 19 39 35 15 38 32 41 49 39 37 15 46 32 23 26 14 #> ARI=0.350545257443073 #> probability matrix dimensions = 500 16 #> EPOCH: 2 #> current clustering = 19 39 35 15 38 32 41 49 39 37 15 46 32 23 26 14 #> projected clustering = 24 34 40 31 36 32 32 40 35 29 25 44 32 25 21 20 #> ARI=0.477587994405075 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 24 34 40 31 36 32 32 40 35 29 25 44 32 25 21 20 #> projected clustering = 23 31 29 37 30 43 25 49 47 29 27 32 25 29 25 19 #> ARI=0.496092643178161 #> probability matrix dimensions = 500 16 #> EPOCH: 4 #> current clustering = 23 31 29 37 30 43 25 49 47 29 27 32 25 29 25 19 #> projected clustering = 23 32 37 28 37 43 30 47 42 31 22 39 19 28 19 23 #> ARI=0.62298932353608 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 23 32 37 28 37 43 30 47 42 31 22 39 19 28 19 23 #> projected clustering = 30 22 32 27 40 36 35 44 43 42 20 33 25 26 22 23 #> ARI=0.635287298523067 #> probability matrix dimensions = 500 16 #> EPOCH: 6 #> current clustering = 30 22 32 27 40 36 35 44 43 42 20 33 25 26 22 23 #> projected clustering = 28 19 30 27 39 39 40 44 31 47 25 33 23 25 27 23 #> ARI=0.638944841310744 #> probability matrix dimensions = 500 16 #> EPOCH: 7 #> current clustering = 28 19 30 27 39 39 40 44 31 47 25 33 23 25 27 23 #> projected clustering = 30 21 34 22 35 44 39 48 34 36 34 30 20 27 24 22 #> ARI=0.70469579869558 #> probability matrix dimensions = 500 16 #> EPOCH: 8 #> current clustering = 30 21 34 22 35 44 39 48 34 36 34 30 20 27 24 22 #> projected clustering = 23 24 34 20 39 42 44 51 33 37 30 30 16 28 29 20 #> ARI=0.710396638756063 #> probability matrix dimensions = 500 16 #> EPOCH: 9 #> current clustering = 23 24 34 20 39 42 44 51 33 37 30 30 16 28 29 20 #> projected clustering = 26 25 35 20 42 32 43 49 43 29 30 30 20 30 26 20 #> probability matrix dimensions = 500 16 #> EPOCH: 9 #> current clustering = 23 24 34 20 39 42 44 51 33 37 30 30 16 28 29 20 #> projected clustering = 20 21 37 24 38 43 38 46 41 27 31 34 17 29 32 22 #> ARI=0.740761014939628 #> probability matrix dimensions = 500 16 #> EPOCH: 10 #> current clustering = 20 21 37 24 38 43 38 46 41 27 31 34 17 29 32 22 #> projected clustering = 20 16 39 18 36 45 42 47 39 35 26 33 16 29 33 26 #> probability matrix dimensions = 500 16 #> EPOCH: 10 #> current clustering = 20 21 37 24 38 43 38 46 41 27 31 34 17 29 32 22 #> projected clustering = 26 15 34 17 34 36 43 54 37 35 28 30 27 29 33 22 #> ARI=0.747336672374071 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 26 15 34 17 34 36 43 54 37 35 28 30 27 29 33 22 #> projected clustering = 26 15 35 19 37 37 44 49 39 38 23 35 24 27 38 14 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 26 15 34 17 34 36 43 54 37 35 28 30 27 29 33 22 #> projected clustering = 22 19 34 14 41 32 39 55 34 40 27 34 25 29 31 24 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 26 15 34 17 34 36 43 54 37 35 28 30 27 29 33 22 #> projected clustering = 23 15 35 20 30 45 38 51 31 43 31 28 22 29 35 24 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 26 15 34 17 34 36 43 54 37 35 28 30 27 29 33 22 #> projected clustering = 26 16 41 16 23 43 35 55 34 29 33 35 24 35 30 25 #> probability matrix dimensions = 500 16 #> EPOCH: 11 #> current clustering = 26 15 34 17 34 36 43 54 37 35 28 30 27 29 33 22 #> projected clustering = 18 20 37 18 27 44 49 47 41 26 28 33 30 26 32 24 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.747336672374071. #> ICP run: 2 #> probability matrix dimensions = 500 2 #> EPOCH: 1 #> current clustering = 250 250 #> projected clustering = 243 257 #> ARI=0.795254009078026 #> probability matrix dimensions = 500 2 #> EPOCH: 2 #> current clustering = 243 257 #> projected clustering = 252 248 #> ARI=0.883366457789441 #> probability matrix dimensions = 500 2 #> EPOCH: 3 #> current clustering = 252 248 #> projected clustering = 246 254 #> ARI=0.936897581678391 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 246 254 #> projected clustering = 246 254 #> ARI=0.968192287637096 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 246 254 #> projected clustering = 245 255 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 246 254 #> projected clustering = 249 251 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 246 254 #> projected clustering = 247 253 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 246 254 #> projected clustering = 246 254 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 246 254 #> projected clustering = 242 258 #> probability matrix dimensions = 500 4 #> EPOCH: 1 #> current clustering = 127 127 123 123 #> projected clustering = 124 136 85 155 #> ARI=0.505655130498455 #> probability matrix dimensions = 500 4 #> EPOCH: 2 #> current clustering = 124 136 85 155 #> projected clustering = 138 128 96 138 #> ARI=0.683101815749058 #> probability matrix dimensions = 500 4 #> EPOCH: 3 #> current clustering = 138 128 96 138 #> projected clustering = 137 129 110 124 #> ARI=0.814566576111229 #> probability matrix dimensions = 500 4 #> EPOCH: 4 #> current clustering = 137 129 110 124 #> projected clustering = 140 129 114 117 #> ARI=0.821782487016266 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 140 129 114 117 #> projected clustering = 142 126 118 114 #> ARI=0.881342040005077 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 142 126 118 114 #> projected clustering = 139 126 124 111 #> ARI=0.931826790907787 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 139 126 124 111 #> projected clustering = 140 126 124 110 #> ARI=0.963230615890191 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 140 126 124 110 #> projected clustering = 141 127 132 100 #> probability matrix dimensions = 500 4 #> EPOCH: 8 #> current clustering = 140 126 124 110 #> projected clustering = 142 126 127 105 #> ARI=0.963588001669763 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 142 126 127 105 #> projected clustering = 139 126 130 105 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 142 126 127 105 #> projected clustering = 140 126 133 101 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 142 126 127 105 #> projected clustering = 142 126 126 106 #> probability matrix dimensions = 500 4 #> EPOCH: 9 #> current clustering = 142 126 127 105 #> projected clustering = 143 126 129 102 #> ARI=0.970245264019729 #> probability matrix dimensions = 500 4 #> EPOCH: 10 #> current clustering = 143 126 129 102 #> projected clustering = 141 126 131 102 #> ARI=0.970435510349295 #> probability matrix dimensions = 500 4 #> EPOCH: 11 #> current clustering = 141 126 131 102 #> projected clustering = 142 126 134 98 #> ARI=0.974273973234211 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 142 126 134 98 #> projected clustering = 137 126 133 104 #> probability matrix dimensions = 500 4 #> EPOCH: 12 #> current clustering = 142 126 134 98 #> projected clustering = 140 126 135 99 #> ARI=0.9891123089446 #> probability matrix dimensions = 500 4 #> EPOCH: 13 #> current clustering = 140 126 135 99 #> projected clustering = 130 126 134 110 #> probability matrix dimensions = 500 4 #> EPOCH: 13 #> current clustering = 140 126 135 99 #> projected clustering = 143 126 135 96 #> probability matrix dimensions = 500 4 #> EPOCH: 13 #> current clustering = 140 126 135 99 #> projected clustering = 141 126 134 99 #> probability matrix dimensions = 500 4 #> EPOCH: 13 #> current clustering = 140 126 135 99 #> projected clustering = 125 127 138 110 #> probability matrix dimensions = 500 4 #> EPOCH: 13 #> current clustering = 140 126 135 99 #> projected clustering = 142 127 131 100 #> probability matrix dimensions = 500 8 #> EPOCH: 1 #> current clustering = 70 70 50 49 63 63 68 67 #> projected clustering = 50 90 38 56 45 81 63 77 #> ARI=0.57268013864495 #> probability matrix dimensions = 500 8 #> EPOCH: 2 #> current clustering = 50 90 38 56 45 81 63 77 #> projected clustering = 51 93 44 50 35 90 56 81 #> ARI=0.799444109940251 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 51 93 44 50 35 90 56 81 #> projected clustering = 50 93 38 58 37 90 44 90 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 51 93 44 50 35 90 56 81 #> projected clustering = 52 93 48 48 34 91 77 57 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 51 93 44 50 35 90 56 81 #> projected clustering = 46 94 37 53 39 91 50 90 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 51 93 44 50 35 90 56 81 #> projected clustering = 52 96 43 46 39 85 64 75 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 51 93 44 50 35 90 56 81 #> projected clustering = 50 94 38 59 52 74 68 65 #> probability matrix dimensions = 500 16 #> EPOCH: 1 #> current clustering = 47 46 22 22 45 45 25 25 28 28 18 17 41 40 26 25 #> projected clustering = 24 67 17 27 54 27 33 29 15 32 25 20 41 39 23 27 #> ARI=0.464653531562265 #> probability matrix dimensions = 500 16 #> EPOCH: 2 #> current clustering = 24 67 17 27 54 27 33 29 15 32 25 20 41 39 23 27 #> projected clustering = 25 68 21 22 33 41 30 33 18 29 32 20 41 37 18 32 #> ARI=0.648681975631689 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 25 68 21 22 33 41 30 33 18 29 32 20 41 37 18 32 #> projected clustering = 24 71 21 21 20 45 22 39 7 53 43 18 32 36 16 32 #> ARI=0.686680138885083 #> probability matrix dimensions = 500 16 #> EPOCH: 4 #> current clustering = 24 71 21 21 20 45 22 39 7 53 43 18 32 36 16 32 #> projected clustering = 31 64 23 15 19 44 26 33 10 50 43 19 33 37 19 34 #> ARI=0.755485177036571 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 31 64 23 15 19 44 26 33 10 50 43 19 33 37 19 34 #> projected clustering = 26 66 21 18 19 44 33 26 14 50 48 16 25 38 19 37 #> ARI=0.768321186810094 #> probability matrix dimensions = 500 16 #> EPOCH: 6 #> current clustering = 26 66 21 18 19 44 33 26 14 50 48 16 25 38 19 37 #> projected clustering = 29 67 20 19 26 41 29 28 14 57 46 15 16 47 22 24 #> probability matrix dimensions = 500 16 #> EPOCH: 6 #> current clustering = 26 66 21 18 19 44 33 26 14 50 48 16 25 38 19 37 #> projected clustering = 29 66 13 17 24 36 37 27 16 51 54 14 27 35 21 33 #> probability matrix dimensions = 500 16 #> EPOCH: 6 #> current clustering = 26 66 21 18 19 44 33 26 14 50 48 16 25 38 19 37 #> projected clustering = 32 62 20 19 21 44 26 29 14 57 47 15 19 41 17 37 #> probability matrix dimensions = 500 16 #> EPOCH: 6 #> current clustering = 26 66 21 18 19 44 33 26 14 50 48 16 25 38 19 37 #> projected clustering = 30 64 20 19 14 42 32 28 20 39 57 14 36 34 24 27 #> probability matrix dimensions = 500 16 #> EPOCH: 6 #> current clustering = 26 66 21 18 19 44 33 26 14 50 48 16 25 38 19 37 #> projected clustering = 30 64 21 23 32 48 23 26 13 58 33 15 27 35 20 32 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.768321186810094. #> ICP run: 3 #> probability matrix dimensions = 500 2 #> EPOCH: 1 #> current clustering = 250 250 #> projected clustering = 255 245 #> ARI=0.838732948808876 #> probability matrix dimensions = 500 2 #> EPOCH: 2 #> current clustering = 255 245 #> projected clustering = 258 242 #> ARI=0.86836051504992 #> probability matrix dimensions = 500 2 #> EPOCH: 3 #> current clustering = 258 242 #> projected clustering = 251 249 #> ARI=0.944673239129708 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 251 249 #> projected clustering = 250 250 #> ARI=0.976096097153539 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 250 250 #> projected clustering = 261 239 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 250 250 #> projected clustering = 245 255 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 250 250 #> projected clustering = 253 247 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 250 250 #> projected clustering = 256 244 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 250 250 #> projected clustering = 252 248 #> probability matrix dimensions = 500 4 #> EPOCH: 1 #> current clustering = 125 125 125 125 #> projected clustering = 122 122 130 126 #> ARI=0.570082150811321 #> probability matrix dimensions = 500 4 #> EPOCH: 2 #> current clustering = 122 122 130 126 #> projected clustering = 116 127 125 132 #> ARI=0.743534931137085 #> probability matrix dimensions = 500 4 #> EPOCH: 3 #> current clustering = 116 127 125 132 #> projected clustering = 114 127 123 136 #> ARI=0.849602575314537 #> probability matrix dimensions = 500 4 #> EPOCH: 4 #> current clustering = 114 127 123 136 #> projected clustering = 112 126 122 140 #> ARI=0.905618944041145 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 112 126 122 140 #> projected clustering = 111 126 109 154 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 112 126 122 140 #> projected clustering = 115 126 124 135 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 112 126 122 140 #> projected clustering = 110 126 118 146 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 112 126 122 140 #> projected clustering = 104 127 107 162 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 112 126 122 140 #> projected clustering = 106 126 114 154 #> probability matrix dimensions = 500 8 #> EPOCH: 1 #> current clustering = 56 56 70 70 63 63 61 61 #> projected clustering = 46 61 64 87 45 81 43 73 #> ARI=0.54123484914936 #> probability matrix dimensions = 500 8 #> EPOCH: 2 #> current clustering = 46 61 64 87 45 81 43 73 #> projected clustering = 29 76 66 94 38 88 33 76 #> ARI=0.725561093762805 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 29 76 66 94 38 88 33 76 #> projected clustering = 34 69 67 84 46 81 42 77 #> ARI=0.774261769737241 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 34 69 67 84 46 81 42 77 #> projected clustering = 37 68 62 78 38 88 44 85 #> ARI=0.825857825784347 #> probability matrix dimensions = 500 8 #> EPOCH: 5 #> current clustering = 37 68 62 78 38 88 44 85 #> projected clustering = 32 71 55 79 40 86 49 88 #> ARI=0.899053273334009 #> probability matrix dimensions = 500 8 #> EPOCH: 6 #> current clustering = 32 71 55 79 40 86 49 88 #> projected clustering = 32 70 55 76 42 84 49 92 #> ARI=0.901752172178415 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 32 70 55 76 42 84 49 92 #> projected clustering = 30 71 50 81 44 82 46 96 #> ARI=0.923493565834838 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 30 71 50 81 44 82 46 96 #> projected clustering = 30 69 52 85 42 84 45 93 #> probability matrix dimensions = 500 8 #> EPOCH: 8 #> current clustering = 30 71 50 81 44 82 46 96 #> projected clustering = 31 71 46 81 42 84 50 95 #> ARI=0.936810537294432 #> probability matrix dimensions = 500 8 #> EPOCH: 9 #> current clustering = 31 71 46 81 42 84 50 95 #> projected clustering = 30 71 53 79 44 82 47 94 #> ARI=0.94160969369401 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 30 71 53 79 44 82 47 94 #> projected clustering = 31 69 54 80 46 80 43 97 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 30 71 53 79 44 82 47 94 #> projected clustering = 29 72 53 75 51 75 52 93 #> probability matrix dimensions = 500 8 #> EPOCH: 10 #> current clustering = 30 71 53 79 44 82 47 94 #> projected clustering = 31 68 54 80 44 82 48 93 #> ARI=0.944333317190972 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 31 68 54 80 44 82 48 93 #> projected clustering = 31 68 58 83 44 82 43 91 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 31 68 54 80 44 82 48 93 #> projected clustering = 32 66 55 81 46 80 49 91 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 31 68 54 80 44 82 48 93 #> projected clustering = 33 65 59 78 44 82 47 92 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 31 68 54 80 44 82 48 93 #> projected clustering = 31 69 54 79 43 83 47 94 #> probability matrix dimensions = 500 8 #> EPOCH: 11 #> current clustering = 31 68 54 80 44 82 48 93 #> projected clustering = 30 68 62 74 47 79 46 94 #> probability matrix dimensions = 500 16 #> EPOCH: 1 #> current clustering = 34 34 27 27 41 41 40 40 47 46 22 22 24 24 16 15 #> projected clustering = 24 43 16 39 33 51 31 52 39 54 15 27 18 26 13 19 #> ARI=0.514247211924704 #> probability matrix dimensions = 500 16 #> EPOCH: 2 #> current clustering = 24 43 16 39 33 51 31 52 39 54 15 27 18 26 13 19 #> projected clustering = 31 31 16 39 30 49 34 46 29 64 21 27 23 25 15 20 #> ARI=0.661179482085389 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 31 31 16 39 30 49 34 46 29 64 21 27 23 25 15 20 #> projected clustering = 32 31 16 35 27 52 32 53 50 41 22 26 17 32 12 22 #> ARI=0.681766195825721 #> probability matrix dimensions = 500 16 #> EPOCH: 4 #> current clustering = 32 31 16 35 27 52 32 53 50 41 22 26 17 32 12 22 #> projected clustering = 28 32 14 40 32 51 28 54 58 33 15 29 15 34 15 22 #> ARI=0.750208928470526 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 28 32 14 40 32 51 28 54 58 33 15 29 15 34 15 22 #> projected clustering = 29 30 12 42 29 51 35 52 42 42 13 34 15 35 16 23 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 28 32 14 40 32 51 28 54 58 33 15 29 15 34 15 22 #> projected clustering = 40 21 18 36 27 58 23 45 59 39 15 27 17 39 15 21 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 28 32 14 40 32 51 28 54 58 33 15 29 15 34 15 22 #> projected clustering = 35 24 20 39 26 53 33 49 61 29 14 33 16 29 14 25 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 28 32 14 40 32 51 28 54 58 33 15 29 15 34 15 22 #> projected clustering = 34 23 14 39 31 52 28 51 55 43 14 29 15 32 17 23 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 28 32 14 40 32 51 28 54 58 33 15 29 15 34 15 22 #> projected clustering = 32 25 16 41 26 58 32 51 28 57 12 30 16 35 18 23 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.750208928470526. #> ICP run: 4 #> probability matrix dimensions = 500 2 #> EPOCH: 1 #> current clustering = 250 250 #> projected clustering = 265 235 #> ARI=0.83873398505553 #> probability matrix dimensions = 500 2 #> EPOCH: 2 #> current clustering = 265 235 #> projected clustering = 258 242 #> ARI=0.898501161140504 #> probability matrix dimensions = 500 2 #> EPOCH: 3 #> current clustering = 258 242 #> projected clustering = 256 244 #> ARI=0.936897707538242 #> probability matrix dimensions = 500 2 #> EPOCH: 4 #> current clustering = 256 244 #> projected clustering = 249 251 #> ARI=0.944673189756076 #> probability matrix dimensions = 500 2 #> EPOCH: 5 #> current clustering = 249 251 #> projected clustering = 248 252 #> ARI=0.97609610020095 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 248 252 #> projected clustering = 246 254 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 248 252 #> projected clustering = 252 248 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 248 252 #> projected clustering = 251 249 #> probability matrix dimensions = 500 2 #> EPOCH: 6 #> current clustering = 248 252 #> projected clustering = 245 255 #> ARI=0.976096118043035 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 245 255 #> projected clustering = 248 252 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 245 255 #> projected clustering = 241 259 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 245 255 #> projected clustering = 244 256 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 245 255 #> projected clustering = 248 252 #> probability matrix dimensions = 500 2 #> EPOCH: 7 #> current clustering = 245 255 #> projected clustering = 244 256 #> ARI=0.976096137703704 #> probability matrix dimensions = 500 2 #> EPOCH: 8 #> current clustering = 244 256 #> projected clustering = 248 252 #> probability matrix dimensions = 500 2 #> EPOCH: 8 #> current clustering = 244 256 #> projected clustering = 245 255 #> probability matrix dimensions = 500 2 #> EPOCH: 8 #> current clustering = 244 256 #> projected clustering = 248 252 #> probability matrix dimensions = 500 2 #> EPOCH: 8 #> current clustering = 244 256 #> projected clustering = 248 252 #> probability matrix dimensions = 500 2 #> EPOCH: 8 #> current clustering = 244 256 #> projected clustering = 248 252 #> probability matrix dimensions = 500 4 #> EPOCH: 1 #> current clustering = 128 128 122 122 #> projected clustering = 107 140 121 132 #> ARI=0.532065808397644 #> probability matrix dimensions = 500 4 #> EPOCH: 2 #> current clustering = 107 140 121 132 #> projected clustering = 110 131 140 119 #> ARI=0.672679552854405 #> probability matrix dimensions = 500 4 #> EPOCH: 3 #> current clustering = 110 131 140 119 #> projected clustering = 117 126 134 123 #> ARI=0.742739185419994 #> probability matrix dimensions = 500 4 #> EPOCH: 4 #> current clustering = 117 126 134 123 #> projected clustering = 114 127 134 125 #> ARI=0.821432387454403 #> probability matrix dimensions = 500 4 #> EPOCH: 5 #> current clustering = 114 127 134 125 #> projected clustering = 118 127 139 116 #> ARI=0.831106673271641 #> probability matrix dimensions = 500 4 #> EPOCH: 6 #> current clustering = 118 127 139 116 #> projected clustering = 115 127 150 108 #> ARI=0.921458939150972 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 115 127 150 108 #> projected clustering = 107 128 159 106 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 115 127 150 108 #> projected clustering = 114 127 156 103 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 115 127 150 108 #> projected clustering = 111 126 160 103 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 115 127 150 108 #> projected clustering = 104 127 163 106 #> probability matrix dimensions = 500 4 #> EPOCH: 7 #> current clustering = 115 127 150 108 #> projected clustering = 130 127 130 113 #> probability matrix dimensions = 500 8 #> EPOCH: 1 #> current clustering = 58 57 54 54 64 63 75 75 #> projected clustering = 35 73 50 58 59 68 47 110 #> ARI=0.571917744633526 #> probability matrix dimensions = 500 8 #> EPOCH: 2 #> current clustering = 35 73 50 58 59 68 47 110 #> projected clustering = 33 68 40 69 39 88 43 120 #> ARI=0.7591367000387 #> probability matrix dimensions = 500 8 #> EPOCH: 3 #> current clustering = 33 68 40 69 39 88 43 120 #> projected clustering = 35 62 41 69 33 94 45 121 #> ARI=0.845979383640427 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 35 62 41 69 33 94 45 121 #> projected clustering = 41 51 47 68 34 95 45 119 #> probability matrix dimensions = 500 8 #> EPOCH: 4 #> current clustering = 35 62 41 69 33 94 45 121 #> projected clustering = 42 55 41 72 30 96 42 122 #> ARI=0.905821117045133 #> probability matrix dimensions = 500 8 #> EPOCH: 5 #> current clustering = 42 55 41 72 30 96 42 122 #> projected clustering = 41 57 40 74 33 93 42 120 #> probability matrix dimensions = 500 8 #> EPOCH: 5 #> current clustering = 42 55 41 72 30 96 42 122 #> projected clustering = 37 58 40 74 32 95 42 122 #> probability matrix dimensions = 500 8 #> EPOCH: 5 #> current clustering = 42 55 41 72 30 96 42 122 #> projected clustering = 43 55 36 69 31 95 42 129 #> probability matrix dimensions = 500 8 #> EPOCH: 5 #> current clustering = 42 55 41 72 30 96 42 122 #> projected clustering = 44 53 42 73 32 94 44 118 #> ARI=0.9173783968805 #> probability matrix dimensions = 500 8 #> EPOCH: 6 #> current clustering = 44 53 42 73 32 94 44 118 #> projected clustering = 43 55 42 74 34 92 41 119 #> probability matrix dimensions = 500 8 #> EPOCH: 6 #> current clustering = 44 53 42 73 32 94 44 118 #> projected clustering = 38 60 48 75 40 86 42 111 #> probability matrix dimensions = 500 8 #> EPOCH: 6 #> current clustering = 44 53 42 73 32 94 44 118 #> projected clustering = 40 59 39 73 33 93 45 118 #> ARI=0.919429669540258 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 40 59 39 73 33 93 45 118 #> projected clustering = 37 62 39 74 43 83 45 117 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 40 59 39 73 33 93 45 118 #> projected clustering = 43 55 41 76 38 88 44 115 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 40 59 39 73 33 93 45 118 #> projected clustering = 38 60 46 76 31 93 41 115 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 40 59 39 73 33 93 45 118 #> projected clustering = 42 51 42 71 35 95 47 117 #> probability matrix dimensions = 500 8 #> EPOCH: 7 #> current clustering = 40 59 39 73 33 93 45 118 #> projected clustering = 41 58 45 77 35 91 42 111 #> probability matrix dimensions = 500 16 #> EPOCH: 1 #> current clustering = 20 20 47 46 20 19 59 59 30 29 17 16 37 36 23 22 #> projected clustering = 16 24 43 45 13 26 37 83 27 33 19 18 26 43 22 25 #> ARI=0.525606720175476 #> probability matrix dimensions = 500 16 #> EPOCH: 2 #> current clustering = 16 24 43 45 13 26 37 83 27 33 19 18 26 43 22 25 #> projected clustering = 19 17 48 39 13 27 26 94 26 33 22 18 48 26 16 28 #> ARI=0.655272225926455 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 19 17 48 39 13 27 26 94 26 33 22 18 48 26 16 28 #> projected clustering = 19 28 36 50 16 25 49 73 15 34 25 15 37 29 18 31 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 19 17 48 39 13 27 26 94 26 33 22 18 48 26 16 28 #> projected clustering = 22 24 29 57 12 28 40 80 16 35 27 12 33 40 18 27 #> probability matrix dimensions = 500 16 #> EPOCH: 3 #> current clustering = 19 17 48 39 13 27 26 94 26 33 22 18 48 26 16 28 #> projected clustering = 18 25 49 41 13 26 27 93 22 32 24 13 48 23 19 27 #> ARI=0.666878575178302 #> probability matrix dimensions = 500 16 #> EPOCH: 4 #> current clustering = 18 25 49 41 13 26 27 93 22 32 24 13 48 23 19 27 #> projected clustering = 16 24 46 34 15 26 32 91 16 41 34 13 44 23 19 26 #> ARI=0.719017455319634 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 16 24 46 34 15 26 32 91 16 41 34 13 44 23 19 26 #> projected clustering = 13 32 38 33 22 23 40 83 14 38 43 13 29 36 16 27 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 16 24 46 34 15 26 32 91 16 41 34 13 44 23 19 26 #> projected clustering = 16 20 42 34 34 21 28 83 22 41 37 13 42 22 19 26 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 16 24 46 34 15 26 32 91 16 41 34 13 44 23 19 26 #> projected clustering = 13 21 36 31 16 23 35 95 20 45 46 12 41 20 28 18 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 16 24 46 34 15 26 32 91 16 41 34 13 44 23 19 26 #> projected clustering = 16 23 44 31 19 26 32 87 18 40 40 13 24 41 26 20 #> probability matrix dimensions = 500 16 #> EPOCH: 5 #> current clustering = 16 24 46 34 15 26 32 91 16 41 34 13 44 23 19 26 #> projected clustering = 18 24 29 37 30 23 20 89 25 31 48 12 42 25 24 23 #> ARI=0.725082283085276 #> probability matrix dimensions = 500 16 #> EPOCH: 6 #> current clustering = 18 24 29 37 30 23 20 89 25 31 48 12 42 25 24 23 #> projected clustering = 21 20 31 38 29 24 18 93 26 31 45 12 28 38 22 24 #> ARI=0.781909113382413 #> probability matrix dimensions = 500 16 #> EPOCH: 7 #> current clustering = 21 20 31 38 29 24 18 93 26 31 45 12 28 38 22 24 #> projected clustering = 27 21 28 39 27 25 18 93 19 31 47 12 35 29 26 23 #> probability matrix dimensions = 500 16 #> EPOCH: 7 #> current clustering = 21 20 31 38 29 24 18 93 26 31 45 12 28 38 22 24 #> projected clustering = 29 20 20 45 27 21 33 92 21 28 48 12 26 33 21 24 #> probability matrix dimensions = 500 16 #> EPOCH: 7 #> current clustering = 21 20 31 38 29 24 18 93 26 31 45 12 28 38 22 24 #> projected clustering = 17 26 29 39 33 25 21 89 23 31 45 12 25 39 23 23 #> ARI=0.79146881232699 #> probability matrix dimensions = 500 16 #> EPOCH: 8 #> current clustering = 17 26 29 39 33 25 21 89 23 31 45 12 25 39 23 23 #> projected clustering = 21 24 29 42 38 22 23 80 25 29 42 12 35 33 19 26 #> probability matrix dimensions = 500 16 #> EPOCH: 8 #> current clustering = 17 26 29 39 33 25 21 89 23 31 45 12 25 39 23 23 #> projected clustering = 27 14 28 46 36 26 17 90 22 34 39 12 29 35 19 26 #> ARI=0.808159013434938 #> probability matrix dimensions = 500 16 #> EPOCH: 9 #> current clustering = 27 14 28 46 36 26 17 90 22 34 39 12 29 35 19 26 #> projected clustering = 30 16 26 47 24 29 27 89 26 26 41 12 35 29 19 24 #> probability matrix dimensions = 500 16 #> EPOCH: 9 #> current clustering = 27 14 28 46 36 26 17 90 22 34 39 12 29 35 19 26 #> projected clustering = 20 19 24 50 31 27 29 81 21 39 40 12 36 25 25 21 #> probability matrix dimensions = 500 16 #> EPOCH: 9 #> current clustering = 27 14 28 46 36 26 17 90 22 34 39 12 29 35 19 26 #> projected clustering = 28 15 32 42 30 29 21 86 21 35 39 12 32 33 25 20 #> probability matrix dimensions = 500 16 #> EPOCH: 9 #> current clustering = 27 14 28 46 36 26 17 90 22 34 39 12 29 35 19 26 #> projected clustering = 31 19 28 48 24 29 26 93 18 30 37 12 34 27 26 18 #> probability matrix dimensions = 500 16 #> EPOCH: 9 #> current clustering = 27 14 28 46 36 26 17 90 22 34 39 12 29 35 19 26 #> projected clustering = 36 15 24 54 41 24 35 71 19 28 35 12 25 37 21 23 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.808159013434938. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # 2) Compute reference PCA & UMAP ref <- RunPCA(ref, return.model = TRUE, pca.method = \"stats\") #> Divisive ICP: selecting ICP tables multiple of 4 set.seed(123) ref <- RunUMAP(ref, return.model = TRUE)  # 3) Project & predict query cell labels  set.seed(1024) map <- ReferenceMapping(ref = ref, query = query, ref.label = \"cell_type\", scale.query.by = NULL, project.umap = TRUE)  # Calculate accuracy preds_x_truth <- table(map$coral_labels, map$cell_type) preds_x_truth #>                  #>                  aDC B mem B naive CD4 mem CD4 naive CD8 eff CD8 T HSC #>   aDC             13     0       0       0         0       0     0   0 #>   B mem            0    37      16       0         0       1     0   2 #>   B naive          0     7      68       0         0       0     0   0 #>   CD4 mem          0     0       0      83        26       0     2   0 #>   CD4 naive        0     0       0      36       160       0    21   1 #>   CD8 eff          0     0       0       3         0      99     7   0 #>   CD8 T            0     1       1       5        10       7    52   0 #>   HSC              0     0       0       0         0       0     0   2 #>   Megakaryocyte    0     0       0       0         0       0     0   0 #>   Monocyte         2     0       0       0         0       0     0   0 #>   CD16+ monocyte   0     0       0       0         0       0     0   0 #>   NK               0     0       0       0         0       1     0   0 #>   pDC              0     0       0       0         0       0     0   0 #>   Treg             0     0       0       1         0       0     0   0 #>                  #>                  Megakaryocyte Monocyte CD16+ monocyte  NK pDC Treg #>   aDC                        0        6              0   0   0    0 #>   B mem                      0        0              0   0   0    0 #>   B naive                    0        0              0   0   2    0 #>   CD4 mem                    0        0              0   0   0    5 #>   CD4 naive                  0        0              0   0   0   10 #>   CD8 eff                    1        0              0   2   0    0 #>   CD8 T                      1        0              0   0   0    0 #>   HSC                        0        0              0   0   0    0 #>   Megakaryocyte              0        0              0   0   0    0 #>   Monocyte                   3      172             12   1   0    0 #>   CD16+ monocyte             1        0             64   0   0    0 #>   NK                         0        0              0  54   0    0 #>   pDC                        0        0              0   0   2    0 #>   Treg                       0        0              0   0   0    0 sum(diag(preds_x_truth)) / sum(preds_x_truth) # 0.806 : 81% #> [1] 0.806"},{"path":"/reference/RunDivisiveICP.html","id":null,"dir":"Reference","previous_headings":"","what":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","title":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","text":"function implements divisive Iterative Clustering Projection (ICP) clustering:  supervised learning-based clustering, maximizes clustering similarity clustering projection logistic regression,  divisive clustering manner.","code":""},{"path":"/reference/RunDivisiveICP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","text":"","code":"RunDivisiveICP(   normalized.data = NULL,   batch.label = NULL,   k = 16,   d = 0.3,   r = 5,   C = 5,   reg.type = \"L1\",   max.iter = 200,   icp.batch.size = Inf,   train.with.bnn = TRUE,   train.k.nn = 10,   train.k.nn.prop = NULL,   cluster.seed = NULL,   divisive.method = \"random\",   allow.free.k = FALSE,   ari.cutoff = 0.5 )"},{"path":"/reference/RunDivisiveICP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","text":"normalized.data sparse matrix (dgCMatrix) containing normalized feature expression data cells rows features columns. Default NULL. batch.label character vector batch labels corresponding cells given normalized.data. character batch labels need named cells names given rows normalized.data.  default NULL, .e., cells sampled evenly regardless batch. k positive integer power two, .e., 2**n, n>0, specifying number clusters last Iterative Clustering Projection (ICP) round. Decreasing k leads smaller cell populations diversity vice versa.  Default 16, .e., divisive clustering 2 -> 4 -> 8 -> 16 performed. d numeric defines many cells per cluster - oversampled (d ceiling(N/k*d)), stratified.downsampling=FALSE, fraction downsampled stratified approach ,stratified.downsampling=TRUE. Default 0.3. r positive integer denotes number reiterations performed algorithm stops. Default 5. C Cost constraints violation (C) L1-regulatization. Default 0.3. reg.type \"L1\" LASSO \"L2\" Ridge. Default \"L1\". max.iter positive integer denotes maximum number iterations performed algorithm ends. Default 200. icp.batch.size positive integer specifies many cells  randomly select ICP run complete data set.  new feature intended speed process larger data sets. Default Inf, means using cells. train..bnn Train data batch nearest neighbors. Default  TRUE. used batch.label given. train.k.nn Train data batch nearest neighbors using k  nearest neighbors. Default 10. used train..bnn  TRUE. train.k.nn.prop numeric (higher 0 lower 1) corresponding  fraction cells per cluster use train.k.nn nearest  neighbors. Default NULL meaning number train.k.nn  nearest neighbors equal train.k.nn. given, train.k.nn  parameter ignored train.k.nn calculated based  train.k.nn.prop. vector different proportions different divisive clustering rounds can given, otherwise value given  . cluster.seed cluster seed start guide clustering  reproducible clusterings across runs (factor). Default NULL. Otherwise,  random clustering takes place start divisive clustering ICP. divisive.method Divisive method (character). One \"random\"  (randomly sample two clusters every cluster previously found), \"cluster\" \"cluster.batch\" (sample two clusters every  cluster previously found based cluster probability distribution across batches per batch). default \"random\". allow.free.k Allow free k (logical). Allow ICP algorithm  decrease k given case find k target clusters.  default FALSE. ari.cutoff Include ICP models probability tables Adjusted  Rand Index higher ari.cutoff (numeric). default 0.5. value can range 0 (include ) lower 1.","code":""},{"path":"/reference/RunDivisiveICP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Divisive Iterative Clustering Projection (ICP) clustering — RunDivisiveICP","text":"list includes probability matrix clustering similarity measures: ARI, NMI, etc.","code":""},{"path":"/reference/RunPCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Principal Component Analysis — RunPCA","title":"Principal Component Analysis — RunPCA","text":"Perform principal component analysis using assays joint probability matrix input.","code":""},{"path":"/reference/RunPCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Principal Component Analysis — RunPCA","text":"","code":"RunPCA.SingleCellExperiment(   object,   assay.name,   p,   scale,   center,   threshold,   pca.method,   return.model,   select.icp.tables,   features,   dimred.name )  # S4 method for SingleCellExperiment RunPCA(   object,   assay.name = \"joint.probability\",   p = 50,   scale = TRUE,   center = TRUE,   threshold = 0,   pca.method = \"irlba\",   return.model = FALSE,   select.icp.tables = NULL,   features = NULL,   dimred.name = \"PCA\" )"},{"path":"/reference/RunPCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Principal Component Analysis — RunPCA","text":"object SingleCellExperiment object. assay.name Name assay compute PCA. One assayNames(object) joint.probability. default joint.probability used. Use  joint.probability obtain integrated embedding running  RunParallelDivisiveICP. One assays assayNames(object) can provided performing integration assess data requires  integration. p positive integer denoting number principal components  calculate select. Default 50. scale logical specifying whether probabilities standardized unit-variance running PCA. Default TRUE. center logical specifying whether probabilities centered running PCA. Default TRUE. threshold threshold filtering ICP runs PCA  lower terminal projection accuracy threshold. Default 0. pca.method character specifying PCA method. One \"irlba\" (default), \"RSpectra\" \"stats\". Set seed , method  \"irlba\" ensure reproducibility. return.model logical specifying PCA model  retrieved. default FALSE. implemented pca.method = \"stats\".  TRUE, pca.method coerced \"stats\". select.icp.tables Select ICP cluster probability tables perform  PCA. default NULL, .e., used, except ICP tables obtained function RunParallelDivisiveICP, ICP  tables correspond last round divisive clustering every epoch.   vector integers given otherwise. features character feature names matching row.names(object)  select computing PCA. used assay.name one assays assayNames(object), otherwise ignored. dimred.name Dimensional reduction name given returned PCA.  default \"PCA\".","code":""},{"path":"/reference/RunPCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Principal Component Analysis — RunPCA","text":"object SingleCellExperiment class","code":""},{"path":"/reference/RunPCA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Principal Component Analysis — RunPCA","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, assay.name = \"joint.probability\", p = 10, dimred.name = \"PCA\") #> Divisive ICP: selecting ICP tables multiple of 4"},{"path":"/reference/RunParallelDivisiveICP.html","id":null,"dir":"Reference","previous_headings":"","what":"Multi-level integration — RunParallelDivisiveICP","title":"Multi-level integration — RunParallelDivisiveICP","text":"Run divisive ICP clustering parallel order perform multi-level integration.","code":""},{"path":"/reference/RunParallelDivisiveICP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multi-level integration — RunParallelDivisiveICP","text":"","code":"RunParallelDivisiveICP.SingleCellExperiment(   object,   batch.label,   k,   d,   L,   r,   C,   reg.type,   max.iter,   threads,   icp.batch.size,   train.with.bnn,   train.k.nn,   train.k.nn.prop,   build.train.set,   build.train.params,   scale.by,   use.cluster.seed,   divisive.method,   allow.free.k,   ari.cutoff,   verbose )  # S4 method for SingleCellExperiment RunParallelDivisiveICP(   object,   batch.label = NULL,   k = 16,   d = 0.3,   L = 50,   r = 5,   C = 0.3,   reg.type = \"L1\",   max.iter = 200,   threads = 0,   icp.batch.size = Inf,   train.with.bnn = TRUE,   train.k.nn = 10,   train.k.nn.prop = 0.3,   build.train.set = TRUE,   build.train.params = list(),   scale.by = NULL,   use.cluster.seed = TRUE,   divisive.method = \"cluster.batch\",   allow.free.k = TRUE,   ari.cutoff = 0.3,   verbose = FALSE )"},{"path":"/reference/RunParallelDivisiveICP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multi-level integration — RunParallelDivisiveICP","text":"object object SingleCellExperiment class. batch.label variable name (class character) available  cell metadata colData(object) batch labels (character  factor) use. variable provided must contain NAs. default NULL, .e., cells sampled evenly regardless batch. k positive integer power two, .e., 2**n, n>0, specifying number clusters last Iterative Clustering Projection (ICP) round. Decreasing k leads smaller cell populations diversity vice versa.  Default 16, .e., divisive clustering 2 -> 4 -> 8 -> 16 performed. d numeric greater 0 smaller 1 determines many cells n - oversampled cluster training data (n=N/k*d), N total number cells, k number clusters ICP. Increasing 0.3 leads greadually smaller cell populations diversity. Default 0.3. L positive integer greater 1 denoting number ICP runs run. Default 50. Increasing recommended significantly larger sample size (tens thousands cells). Default 200. r positive integer denotes number reiterations performed ICP algorithm stops. Increasing recommended significantly larger sample size (tens thousands cells). Default 5. C positive real number denoting cost constraints violation L1-regularized logistic regression model LIBLINEAR library. Decreasing leads stringent feature selection, .e. less features selected used build projection classifier. Decreasing low value (~ 0.01) can lead failure identify central cell populations. Default 0.3. reg.type \"L1\" \"L2\". L2-regularization investigated manuscript, leads conventional outcome (less subpopulations). Default \"L1\". max.iter positive integer denotes maximum number iterations performed ICP stops. parameter useful situations ICP converges extremely slowly, preventing algorithm run long. cases, reaching number reiterations (r=5) terminates algorithm. Default 200. threads positive integer specifies many logical processors (threads) use parallel computation. Set 1 disable parallelism altogether 0 use available threas except one. Default 0. icp.batch.size positive integer specifies many cells  randomly select. behaves differently depending build.train.set.  build.train.set=FALSE, randomly samples cells ICP run  complete dataset. build.train.set=TRUE, randomly samples  cells , building training set sampled cells (per batch  batch.label different NULL). Default Inf,  means using cells. train..bnn Train data batch nearest neighbors. Default  TRUE. used batch.label given. train.k.nn Train data batch nearest neighbors using k  nearest neighbors. Default 10. used train..bnn  TRUE train.k.nn.prop NULL. train.k.nn.prop numeric (higher 0 lower 1) corresponding  fraction cells per cluster use train.k.nn nearest  neighbors. NULL number train.k.nn nearest neighbors  equal train.k.nn. given, train.k.nn parameter ignored  train.k.nn calculated based train.k.nn.prop. default  0.3 meaning 30 proportions different divisive clustering rounds can given, otherwise  value given . build.train.set Logical specifying training set built  data whole data used training. default  TRUE. build.train.params list parameters passed function AggregateDataByBatch(). provided build.train.set TRUE. scale.character specifying data scaled cell feature training. Default NULL, .e., data  scaled training. use.cluster.seed starting clustering result provided ensure reproducible results (logical). FALSE, ICP run  starts total random clustering , thus, independent clustering.  default TRUE, .e., clustering result provided based PCA  density sampling. batch.label different NULL, PCA density sampling performed batch wise manner. divisive.method Divisive method (character). One \"random\"  (randomly sample two clusters every cluster previously found), \"cluster\" \"cluster.batch\" (sample two clusters every  cluster previously found based cluster probability distribution across batches per batch). default \"cluster.batch\". batch.label  NULL, automatically set cluster. can set  random explicitly provided. allow.free.k Allow free k (logical). Allow ICP algorithm  decrease k given case find k target clusters.  default TRUE. ari.cutoff Include ICP models probability tables Adjusted  Rand Index higher ari.cutoff (numeric). default 0.3. value can range 0 (include ) lower 1. verbose logical value print verbose ICP run case  parallelization, .e., 'threads' different 1. Default 'FALSE'.","code":""},{"path":"/reference/RunParallelDivisiveICP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multi-level integration — RunParallelDivisiveICP","text":"SingleCellExperiment object.","code":""},{"path":"/reference/RunParallelDivisiveICP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multi-level integration — RunParallelDivisiveICP","text":"","code":"# Packages library(\"SingleCellExperiment\")  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Integrated PCA set.seed(125) pbmc_10Xassays <- RunPCA(object = pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4"},{"path":"/reference/RunTSNE.html","id":null,"dir":"Reference","previous_headings":"","what":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding \n(t-SNE) — RunTSNE","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding \n(t-SNE) — RunTSNE","text":"Run nonlinear dimensionality reduction using t-SNE  PCA-transformed consensus matrix input.","code":""},{"path":"/reference/RunTSNE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding \n(t-SNE) — RunTSNE","text":"","code":"RunTSNE.SingleCellExperiment(   object,   dims,   dimred.type,   perplexity,   dimred.name,   ... )  # S4 method for SingleCellExperiment RunTSNE(   object,   dims = NULL,   dimred.type = \"PCA\",   perplexity = 30,   dimred.name = \"TSNE\",   ... )"},{"path":"/reference/RunTSNE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding \n(t-SNE) — RunTSNE","text":"object Object SingleCellExperiment class. dims Dimensions select dimred.type. default NULL,  .e., dimensions selected. Provide numeric vector select  specific range, e.g., dims = 1:10 select first 10 dimensions. dimred.type Dimensional reduction type use. default \"PCA\". perplexity Perplexity t-SNE. dimred.name Dimensional reduction name given returned t-SNE.  default \"TSNE\". ... Parameters passed Rtsne function. parameters  given match parameters accepted Rtsne function. Check  possible parameters ?Rtsne::Rtsne.","code":""},{"path":"/reference/RunTSNE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding \n(t-SNE) — RunTSNE","text":"SingleCellExperiment object.","code":""},{"path":"/reference/RunTSNE.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Barnes-Hut implementation of t-Distributed Stochastic Neighbor Embedding \n(t-SNE) — RunTSNE","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Run t-SNE set.seed(123) pbmc_10Xassays <- RunTSNE(pbmc_10Xassays, dimred.type = \"PCA\")"},{"path":"/reference/RunUMAP.html","id":null,"dir":"Reference","previous_headings":"","what":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"Run nonlinear dimensionality reduction using UMAP dimensional  reduction input.","code":""},{"path":"/reference/RunUMAP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"","code":"RunUMAP.SingleCellExperiment(   object,   dims,   dimred.type,   return.model,   umap.method,   dimred.name,   ... )  # S4 method for SingleCellExperiment RunUMAP(   object,   dims = NULL,   dimred.type = \"PCA\",   return.model = FALSE,   umap.method = \"umap\",   dimred.name = \"UMAP\",   ... )"},{"path":"/reference/RunUMAP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"object object SingleCellExperiment class. dims Dimensions select dimred.type. default NULL,  .e., dimensions selected. Provide numeric vector select  specific range, e.g., dims = 1:10 select first 10 dimensions. dimred.type Dimensional reduction type use. default \"PCA\". return.model Return UMAP model. default FALSE. umap.method UMAP method use: \"umap\" \"uwot\".  default \"umap\". dimred.name Dimensional reduction name given returned UMAP.  default \"UMAP\". ... Parameters passed umap function. parameters  given match parameters accepted umap function depending umap.method given. Check possible parameters ?umap::umap  ?uwot::umap depending umap.method \"umap\"  \"uwot\".","code":""},{"path":"/reference/RunUMAP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"SingleCellExperiment object.","code":""},{"path":"/reference/RunUMAP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Uniform Manifold Approximation and Projection (UMAP) — RunUMAP","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Run UMAP set.seed(123) pbmc_10Xassays <- RunUMAP(pbmc_10Xassays, dimred.type = \"PCA\")"},{"path":"/reference/SampleClusterBatchProbs.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","title":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","text":"Samples cells based cluster probabilities distribution batch wise","code":""},{"path":"/reference/SampleClusterBatchProbs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","text":"","code":"SampleClusterBatchProbs(cluster, probs, batch, q.split = 0.5)"},{"path":"/reference/SampleClusterBatchProbs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","text":"cluster Clustering cell labels predicted ICP (factor). probs Clustering probabilities predicted ICP (matrix). batch Batch labels corresponding clusters (character factor). q.split Split (cell) batch principal component distribution  quantile (numeric). default 0.5, .e., median.","code":""},{"path":"/reference/SampleClusterBatchProbs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cells based on cluster probabilities distribution batch wise — SampleClusterBatchProbs","text":"factor cell cluster identities.","code":""},{"path":"/reference/SampleClusterProbs.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","title":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","text":"Samples cells based cluster probabilities distribution","code":""},{"path":"/reference/SampleClusterProbs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","text":"","code":"SampleClusterProbs(cluster, probs, q.split = 0.5)"},{"path":"/reference/SampleClusterProbs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","text":"cluster Clustering cell labels predicted ICP (factor). probs Clustering probabilities predicted ICP (matrix). q.split Split (cell) batch principal component distribution  quantile (numeric). default 0.5, .e., median.","code":""},{"path":"/reference/SampleClusterProbs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cells based on cluster probabilities distribution — SampleClusterProbs","text":"factor cell cluster identities.","code":""},{"path":"/reference/SamplePCACells.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cells based on principal components distribution — SamplePCACells","title":"Sample cells based on principal components distribution — SamplePCACells","text":"Samples cells based distributions along one principal component","code":""},{"path":"/reference/SamplePCACells.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cells based on principal components distribution — SamplePCACells","text":"","code":"SamplePCACells(   data,   batch = NULL,   q.split = 0.5,   p = 30,   use.pc = \"PC1\",   center = TRUE,   scale. = TRUE )"},{"path":"/reference/SamplePCACells.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cells based on principal components distribution — SamplePCACells","text":"data Data compute PCA sample cells . Rows columns  represent cells features, respectively. batch Batch cell label identity (character) matching cells giving  data. Use NULL absence batches. batch given  cells sampled batch wise manner, otherwise cells sampled  without grouping factor. default NULL. q.split Split (cell) batch principal component distribution  quantile (numeric). default 0.5, .e., median. p Number principal components compute (integer). default  30. use.pc principal component used sampling cells per batch. default \"PC1\", .e., first principal component used. center features given data centered performing PCA (logical). default TRUE. scale. features given data scaled performing PCA (logical). default TRUE.","code":""},{"path":"/reference/SamplePCACells.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cells based on principal components distribution — SamplePCACells","text":"factor cell cluster identities (two clusters).","code":""},{"path":"/reference/Scale.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale a sparse matrix by row or column — Scale","title":"Scale a sparse matrix by row or column — Scale","text":"Faster implementation scale function. diverges  scale function performing root-mean-square  scale=TRUE center=FALSE. case divides values standard deviation column row used (depending scale.).","code":""},{"path":"/reference/Scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale a sparse matrix by row or column — Scale","text":"","code":"Scale(x, center = TRUE, scale = TRUE, scale.by = \"col\")"},{"path":"/reference/Scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale a sparse matrix by row or column — Scale","text":"x matrix class `dgCMatrix`. center logical. default TRUE. Subtract values  row column mean depending `scale.` parameter. scale logical. default TRUE. Divide values row  column standard deviation depending `scale.` parameter scale.Scale `row` `col` (=column), .e., use row  column mean /standard deviations center /scale data.  Default col.","code":""},{"path":"/reference/Scale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale a sparse matrix by row or column — Scale","text":"matrix class `dgCMatrix`.","code":""},{"path":"/reference/ScaleByBatch.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale sparse matrix by features (column) by batch — ScaleByBatch","title":"Scale sparse matrix by features (column) by batch — ScaleByBatch","text":"Scales features batch","code":""},{"path":"/reference/ScaleByBatch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale sparse matrix by features (column) by batch — ScaleByBatch","text":"","code":"ScaleByBatch(x, batch)"},{"path":"/reference/ScaleByBatch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale sparse matrix by features (column) by batch — ScaleByBatch","text":"x matrix class `dgCMatrix`. Cells features (rows x columns). batch character vector batch labels corresponding cells given x. character batch labels need named cells names given rows x.","code":""},{"path":"/reference/ScaleByBatch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale sparse matrix by features (column) by batch — ScaleByBatch","text":"scaled matrix class `dgCMatrix`.","code":""},{"path":"/reference/SummariseCellClusterProbability.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"Summarise ICP cell cluster probability table(s)","code":""},{"path":"/reference/SummariseCellClusterProbability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"","code":"SummariseCellClusterProbability.SingleCellExperiment(   object,   icp.run,   icp.round,   funs,   scale.funs,   save.in.sce )  # S4 method for SingleCellExperiment SummariseCellClusterProbability(   object,   icp.run = NULL,   icp.round = NULL,   funs = c(\"mean\", \"median\"),   scale.funs = TRUE,   save.in.sce = TRUE )"},{"path":"/reference/SummariseCellClusterProbability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"object object SingleCellExperiment class ICP cell  cluster probability tables saved metadata(object)$coralysis$joint.probability.  running RunParallelDivisiveICP. icp.run ICP run(s) retrieve metadata(object)$coralysis$joint.probability.  default NULL, .e., retrieved. Specify numeric vector  retrieve specific set tables. icp.round ICP round(s) retrieve metadata(object)$coralysis$joint.probability.  default NULL, .e., retrieved. funs Functions summarise ICP cell cluster probability: \"mean\"  /\"median\". default c(\"mean\", \"median\"), .e, mean median calculated. Set NULL estimate . scale.funs Scale range 0-1 summarised probability obtained  funs. default TRUE, .e., summarised probability scaled 0-1 range. save..sce Save data frame cell metadata  SingleCellExperiment object return data frame. default TRUE,  .e., summary probabilities retrieved save SCE object  colData(object).","code":""},{"path":"/reference/SummariseCellClusterProbability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"data frame SingleCellExperiment object ICP cell cluster probability summarised.","code":""},{"path":"/reference/SummariseCellClusterProbability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarise ICP cell cluster probability — SummariseCellClusterProbability","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Summarise cluster probability pbmc_10Xassays <- SummariseCellClusterProbability(object = pbmc_10Xassays, icp.round = 4, save.in.sce = TRUE) # save result in 'colData'  # Plot the clustering result for ICP run no. 3  PlotDimRed(object = pbmc_10Xassays, color.by = \"icp_run_round_3_4_clusters\")   # Plot Coralysis mean cell cluster probabilities  PlotExpression(object = pbmc_10Xassays, color.by = \"mean_probs\", color.scale = \"viridis\")"},{"path":"/reference/TabulateCellBinsByGroup.html","id":null,"dir":"Reference","previous_headings":"","what":"Tabulate cell bins by group — TabulateCellBinsByGroup","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"Frequency cells per cell cluster probability bin group label.  label specified beforehand function BinCellClusterProbability().","code":""},{"path":"/reference/TabulateCellBinsByGroup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"","code":"TabulateCellBinsByGroup.SingleCellExperiment(object, group, relative, margin)  # S4 method for SingleCellExperiment TabulateCellBinsByGroup(object, group, relative = FALSE, margin = 1)"},{"path":"/reference/TabulateCellBinsByGroup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"object object SingleCellExperiment class obtained  function BinCellClusterProbability(). group Character specifying colData variable SingleCellExperiment  object provided function BinCellClusterProbability() use  categorical group variable. relative Logical specifying relative proportions cell bins per  group returned. default FALSE, .e., absolute values returned. margin relative TRUE, proportions calculated  : rows (1, default); columns (2); overall (NULL).","code":""},{"path":"/reference/TabulateCellBinsByGroup.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"list tables frequency cells per bin cell cluster probability group label.","code":""},{"path":"/reference/TabulateCellBinsByGroup.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Tabulate cell bins by group — TabulateCellBinsByGroup","text":"","code":"# Packages library(\"SingleCellExperiment\")  # Prepare data pbmc_10Xassays <- PrepareData(object = pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1) #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Cell states SCE object for a given cell type annotation or clustering cellstate.sce <- BinCellClusterProbability(object = pbmc_10Xassays, label = \"cell_type\", icp.round = 4, bins = 20)  cellstate.sce #> class: SingleCellExperiment  #> dim: 2000 245  #> metadata(1): coralysis #> assays(1): logcounts #> rownames(2000): LYZ S100A9 ... IGSF8 KIR2DL1 #> rowData names(0): #> colnames(245): B mem_bin1 B mem_bin10 ... pDC_bin8 pDC_bin9 #> colData names(4): label probability_bins aggregated_probability_bins #>   aggregated_label_bins #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):  # Tabulate cell bins by group  # give an interesting variable to the \"group\" parameter instead \"batch\" - given for illustrative purposes only cellbins.tables <- TabulateCellBinsByGroup(object = cellstate.sce, group = \"batch\", relative = TRUE, margin = 1)"},{"path":"/reference/VlnPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualization of feature expression using violin plots — VlnPlot","title":"Visualization of feature expression using violin plots — VlnPlot","text":"VlnPlot function enables visualizing expression levels  feature(s), across clusters using violin plots.","code":""},{"path":"/reference/VlnPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualization of feature expression using violin plots — VlnPlot","text":"","code":"VlnPlot.SingleCellExperiment(   object,   clustering.label,   features,   return.plot,   rotate.x.axis.labels )  # S4 method for SingleCellExperiment VlnPlot(   object,   clustering.label,   features,   return.plot = FALSE,   rotate.x.axis.labels = FALSE )"},{"path":"/reference/VlnPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualization of feature expression using violin plots — VlnPlot","text":"object SingleCellExperiment class clustering.label variable name (class character) available  cell metadata colData(object) clustering labels  (character factor) use. features Feature names plot cluster (character) matching  row.names(object). return.plot return.plot whether return ggplot2 object.  Default FALSE. rotate.x.axis.labels logical denoting whether x-axis labels  rotated 90 degrees just draw . Default FALSE.","code":""},{"path":"/reference/VlnPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualization of feature expression using violin plots — VlnPlot","text":"ggplot2 object return.plot=TRUE.","code":""},{"path":"/reference/VlnPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualization of feature expression using violin plots — VlnPlot","text":"","code":"# Import package library(\"SingleCellExperiment\")  # Prepare SCE object for analysis pbmc_10Xassays <- PrepareData(pbmc_10Xassays) #> Data in `logcounts` slot already of `dgCMatrix` class... #> 2000/2000 features remain after filtering features with only zero values.  # Multi-level integration - 'L = 4' just for highlighting purposes; use 'L=50' or greater set.seed(123) pbmc_10Xassays <- RunParallelDivisiveICP(object = pbmc_10Xassays, batch.label = \"batch\", L = 4, threads = 1)  #>  #> Building training set... #> Training set successfully built. #>  #> Computing cluster seed. #> Warning: useNames = NA is deprecated. Instead, specify either useNames = TRUE or useNames = FALSE. #> Parallelism disabled, because threads = 1 #>  #> Initializing divisive ICP clustering... #> ICP run: 1 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 504 496 #> ARI=0.817032861432762 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 315 685 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 236 764 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 504 496 #> projected clustering = 235 765 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 253 251 249 247 #> projected clustering = 252 258 214 276 #> ARI=0.612959895656269 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 258 214 276 #> projected clustering = 175 240 257 328 #> ARI=0.633582674585235 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 175 240 257 328 #> projected clustering = 175 240 250 335 #> ARI=0.93915147185947 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 175 240 250 335 #> projected clustering = 176 239 251 334 #> ARI=0.982846180546881 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 238 244 343 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 173 236 247 344 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 172 238 219 371 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 237 205 383 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 176 239 251 334 #> projected clustering = 175 235 227 363 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 88 120 119 126 125 167 167 #> projected clustering = 86 91 104 133 123 134 130 199 #> ARI=0.52107767473474 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 91 104 133 123 134 130 199 #> projected clustering = 75 99 116 120 98 151 90 251 #> ARI=0.665094956696453 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 75 99 116 120 98 151 90 251 #> projected clustering = 72 102 155 84 102 141 48 296 #> ARI=0.784925821084872 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 72 102 155 84 102 141 48 296 #> projected clustering = 65 111 169 67 97 147 27 317 #> ARI=0.888318825561609 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 65 111 169 67 97 147 27 317 #> projected clustering = 63 112 177 58 100 146 18 326 #> ARI=0.929911669275714 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 63 112 177 58 100 146 18 326 #> projected clustering = 67 108 187 47 99 148 15 329 #> ARI=0.937168107666604 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 79 98 196 36 97 148 17 329 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 96 204 30 98 147 19 328 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 83 92 197 37 99 150 8 334 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 84 92 205 28 92 153 7 339 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 67 108 187 47 99 148 15 329 #> projected clustering = 78 99 199 34 95 147 1 347 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 34 33 54 54 94 93 24 23 50 49 75 73 8 7 165 164 #> projected clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> ARI=0.530891811684634 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 30 38 58 53 45 127 31 31 50 58 57 84 11 10 111 206 #> projected clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> ARI=0.689719641678256 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 14 47 60 55 23 154 20 36 33 75 41 95 3 9 75 260 #> projected clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> ARI=0.799214254762973 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 8 57 56 58 7 180 8 35 18 90 28 106 2 6 51 290 #> projected clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> ARI=0.870058771259734 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 9 56 57 55 1 190 2 38 8 107 23 105 2 4 23 320 #> projected clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> ARI=0.912399277935329 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 9 146 55 60 0 203 0 31 1 204 10 106 2 5 168 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 11 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 6 76 47 56 0 203 0 30 0 119 14 112 2 0 0 335 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 5 152 49 56 0 202 0 32 0 263 22 119 6 0 0 94 #> probability matrix dimensions = 1000 13 #> EPOCH: 6 #> current clustering = 11 56 57 54 0 200 1 32 6 109 21 105 2 3 11 332 #> projected clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> ARI=0.917016720085562 #> probability matrix dimensions = 1000 10 #> k 11 decreased to 9 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 253 54 68 0 208 0 27 0 236 8 140 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 80 47 54 0 204 0 32 2 198 0 0 0 1 1 377 #> probability matrix dimensions = 1000 12 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 93 49 59 0 202 0 31 0 452 4 106 0 0 0 0 #> probability matrix dimensions = 1000 13 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 6 68 48 55 0 205 0 28 0 97 12 124 0 3 0 354 #> probability matrix dimensions = 1000 10 #> EPOCH: 7 #> current clustering = 7 72 50 55 0 203 0 30 5 111 17 106 0 3 5 336 #> projected clustering = 4 90 46 64 0 205 0 29 0 459 4 99 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.917016720085562. #> ICP run: 2 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 490 510 #> ARI=0.838894798038157 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 261 739 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 255 745 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 234 766 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 490 510 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 245 245 255 255 #> projected clustering = 254 249 196 301 #> ARI=0.627824102856691 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 254 249 196 301 #> projected clustering = 184 237 251 328 #> ARI=0.651771358481327 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 184 237 251 328 #> projected clustering = 177 237 236 350 #> ARI=0.837830853182383 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 236 350 #> projected clustering = 177 237 239 347 #> ARI=0.888495331290284 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 177 237 239 347 #> projected clustering = 179 235 212 374 #> ARI=0.8982344333421 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 182 405 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 150 437 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 238 116 470 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 176 240 106 478 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 179 235 212 374 #> projected clustering = 175 238 104 483 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 90 89 118 117 106 106 187 187 #> projected clustering = 82 98 99 135 128 110 122 226 #> ARI=0.543718764274041 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 82 98 99 135 128 110 122 226 #> projected clustering = 72 105 103 131 141 98 110 240 #> ARI=0.731240313888522 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 72 105 103 131 141 98 110 240 #> projected clustering = 67 107 125 111 131 102 113 244 #> ARI=0.77509371094271 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 67 107 125 111 131 102 113 244 #> projected clustering = 64 108 141 95 142 95 115 240 #> ARI=0.84980304186415 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 64 108 141 95 142 95 115 240 #> projected clustering = 62 108 148 88 138 96 118 242 #> ARI=0.901240450266422 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 62 108 148 88 138 96 118 242 #> projected clustering = 83 89 160 78 136 93 117 244 #> ARI=0.906622227279462 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 92 87 187 47 139 92 108 248 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 85 91 198 34 135 100 110 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 91 198 34 141 99 107 247 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 89 201 34 142 102 99 250 #> probability matrix dimensions = 1000 8 #> EPOCH: 7 #> current clustering = 83 89 160 78 136 93 117 244 #> projected clustering = 83 92 179 55 135 107 96 253 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 42 41 45 44 80 80 40 38 68 68 47 46 59 58 123 121 #> projected clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> ARI=0.547969629976635 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 45 44 44 46 58 96 43 41 75 68 45 55 52 59 85 144 #> projected clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> ARI=0.66532108284227 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 41 36 49 52 52 103 43 39 77 68 27 68 51 48 69 177 #> projected clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> ARI=0.731743122866796 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 36 26 46 66 58 114 26 39 71 72 22 73 53 44 60 194 #> projected clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> ARI=0.81678840611056 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 44 9 55 66 60 129 16 31 58 70 17 79 87 32 18 229 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 46 4 49 72 49 142 16 30 60 71 16 81 93 25 7 239 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 3 46 72 46 148 16 28 62 73 9 85 86 21 31 222 #> probability matrix dimensions = 1000 16 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 52 0 48 76 44 149 17 28 63 60 9 90 101 19 13 231 #> probability matrix dimensions = 1000 16 #> EPOCH: 5 #> current clustering = 45 15 51 64 64 120 18 36 66 77 21 74 67 34 42 206 #> projected clustering = 54 0 48 74 46 146 16 29 55 71 6 90 106 17 45 197 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.81678840611056. #> ICP run: 3 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 508 492 #> ARI=0.79545930697637 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 393 607 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 252 748 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 239 761 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 233 767 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 508 492 #> projected clustering = 248 752 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 254 254 246 246 #> projected clustering = 239 267 221 273 #> ARI=0.59439529600851 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 239 267 221 273 #> projected clustering = 179 239 271 311 #> ARI=0.59677321566999 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 179 239 271 311 #> projected clustering = 179 237 237 347 #> ARI=0.802338683915751 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 179 237 237 347 #> projected clustering = 179 236 208 377 #> ARI=0.886054495571127 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 236 208 377 #> projected clustering = 175 237 207 381 #> ARI=0.94450609107274 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 174 238 175 413 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 177 239 177 407 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 238 143 443 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 236 144 444 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 175 237 207 381 #> projected clustering = 176 237 126 461 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 104 103 191 190 #> projected clustering = 69 107 98 138 117 113 106 252 #> ARI=0.61021790870628 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 69 107 98 138 117 113 106 252 #> projected clustering = 58 120 106 129 140 99 63 285 #> ARI=0.752853602937143 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 58 120 106 129 140 99 63 285 #> projected clustering = 60 116 118 116 136 99 42 313 #> ARI=0.874315416000235 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 60 116 118 116 136 99 42 313 #> projected clustering = 58 115 133 104 127 102 43 318 #> ARI=0.929947942104205 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 58 115 133 104 127 102 43 318 #> projected clustering = 60 115 141 95 117 98 53 321 #> ARI=0.938622760887126 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 59 114 151 84 103 111 56 322 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 115 157 80 101 108 65 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 58 116 159 78 100 101 72 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 57 117 164 73 100 102 71 316 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 60 115 141 95 117 98 53 321 #> projected clustering = 56 116 175 61 102 101 61 328 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 31 29 58 57 71 70 48 47 59 58 50 48 27 26 161 160 #> projected clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> ARI=0.515071769224918 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 32 32 54 63 50 81 48 55 32 73 48 46 42 37 110 197 #> projected clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> ARI=0.636821389190077 #> probability matrix dimensions = 1000 16 #> EPOCH: 3 #> current clustering = 30 23 70 56 20 105 53 59 17 85 56 32 40 36 118 200 #> projected clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> ARI=0.695464460444395 #> probability matrix dimensions = 1000 16 #> EPOCH: 4 #> current clustering = 34 13 94 37 5 124 53 55 8 91 70 23 43 31 158 161 #> projected clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> ARI=0.820255356993382 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 5 #> current clustering = 40 8 111 17 1 131 54 52 4 95 84 12 43 22 178 148 #> projected clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> ARI=0.86621600037987 #> probability matrix dimensions = 1000 13 #> k 15 decreased to 13 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 49 6 120 1 0 162 49 28 0 104 99 2 44 7 329 0 #> probability matrix dimensions = 1000 13 #> k 13 decreased to 10 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 111 0 126 0 0 143 42 50 0 298 98 2 114 16 0 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 66 0 113 0 0 145 46 45 0 108 106 2 32 12 130 195 #> probability matrix dimensions = 1000 14 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 57 1 118 0 0 142 63 33 0 105 101 2 35 3 340 0 #> probability matrix dimensions = 1000 12 #> EPOCH: 6 #> current clustering = 44 8 118 6 0 137 52 48 1 100 96 3 42 17 179 149 #> projected clustering = 68 0 121 0 0 168 11 58 0 380 93 1 62 38 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.86621600037987. #> ICP run: 4 #> probability matrix dimensions = 1000 2 #> EPOCH: 1 #> current clustering = 500 500 #> projected clustering = 503 497 #> ARI=0.806210023022484 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 327 673 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 240 760 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 254 746 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 396 604 #> probability matrix dimensions = 1000 2 #> EPOCH: 2 #> current clustering = 503 497 #> projected clustering = 238 762 #> probability matrix dimensions = 1000 4 #> EPOCH: 1 #> current clustering = 252 251 249 248 #> projected clustering = 252 252 216 280 #> ARI=0.612727130343084 #> probability matrix dimensions = 1000 4 #> EPOCH: 2 #> current clustering = 252 252 216 280 #> projected clustering = 217 240 247 296 #> ARI=0.677950701070172 #> probability matrix dimensions = 1000 4 #> EPOCH: 3 #> current clustering = 217 240 247 296 #> projected clustering = 177 237 271 315 #> ARI=0.76271638370893 #> probability matrix dimensions = 1000 4 #> EPOCH: 4 #> current clustering = 177 237 271 315 #> projected clustering = 179 235 263 323 #> ARI=0.948884585923085 #> probability matrix dimensions = 1000 4 #> EPOCH: 5 #> current clustering = 179 235 263 323 #> projected clustering = 177 237 255 331 #> ARI=0.971703976517056 #> probability matrix dimensions = 1000 4 #> EPOCH: 6 #> current clustering = 177 237 255 331 #> projected clustering = 175 237 252 336 #> ARI=0.979685765619752 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 244 346 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 235 352 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 174 236 232 358 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 177 236 219 368 #> probability matrix dimensions = 1000 4 #> EPOCH: 7 #> current clustering = 175 237 252 336 #> projected clustering = 176 237 200 387 #> probability matrix dimensions = 1000 8 #> EPOCH: 1 #> current clustering = 88 87 119 118 126 126 169 167 #> projected clustering = 86 94 109 125 113 141 104 228 #> ARI=0.572985424225472 #> probability matrix dimensions = 1000 8 #> EPOCH: 2 #> current clustering = 86 94 109 125 113 141 104 228 #> projected clustering = 52 126 72 162 116 138 55 279 #> ARI=0.665757581450377 #> probability matrix dimensions = 1000 8 #> EPOCH: 3 #> current clustering = 52 126 72 162 116 138 55 279 #> projected clustering = 39 140 42 191 111 143 27 307 #> ARI=0.808380472319223 #> probability matrix dimensions = 1000 8 #> EPOCH: 4 #> current clustering = 39 140 42 191 111 143 27 307 #> projected clustering = 24 154 32 200 99 151 24 316 #> ARI=0.901384588089836 #> probability matrix dimensions = 1000 8 #> EPOCH: 5 #> current clustering = 24 154 32 200 99 151 24 316 #> projected clustering = 20 159 31 201 95 152 21 321 #> ARI=0.961507085136455 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 14 164 27 206 92 155 16 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 11 168 27 206 101 146 15 326 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 9 171 27 206 101 146 13 327 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 173 27 206 98 149 3 336 #> probability matrix dimensions = 1000 8 #> EPOCH: 6 #> current clustering = 20 159 31 201 95 152 21 321 #> projected clustering = 8 170 27 206 97 149 2 341 #> probability matrix dimensions = 1000 16 #> EPOCH: 1 #> current clustering = 11 9 80 79 16 15 101 100 48 47 76 76 11 10 161 160 #> projected clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> ARI=0.532863788793046 #> probability matrix dimensions = 1000 16 #> EPOCH: 2 #> current clustering = 12 10 56 104 23 17 93 101 38 54 46 100 21 14 61 250 #> projected clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> ARI=0.741105755451945 #> probability matrix dimensions = 1000 15 #> k 16 decreased to 15 #> EPOCH: 3 #> current clustering = 2 7 54 117 27 11 113 83 24 59 26 125 11 12 33 296 #> projected clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> ARI=0.854082067949849 #> probability matrix dimensions = 1000 14 #> k 15 decreased to 13 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 8 61 123 35 0 156 41 2 111 6 170 26 8 253 0 #> probability matrix dimensions = 1000 15 #> EPOCH: 4 #> current clustering = 0 8 59 116 35 3 127 68 12 70 14 139 12 10 17 310 #> projected clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> ARI=0.863646179451956 #> probability matrix dimensions = 1000 11 #> k 13 decreased to 10 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 135 133 36 0 148 46 0 307 5 185 0 0 2 0 #> probability matrix dimensions = 1000 12 #> k 10 decreased to 8 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 5 0 173 59 0 120 70 0 162 46 0 0 0 0 365 #> probability matrix dimensions = 1000 9 #> k 8 decreased to 7 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 3 0 412 36 0 147 51 0 76 0 275 0 0 0 0 #> probability matrix dimensions = 1000 6 #> k 7 decreased to 5 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 8 0 0 82 0 124 72 0 0 0 0 0 0 0 714 #> probability matrix dimensions = 1000 7 #> k 5 decreased to 4 #> EPOCH: 5 #> current clustering = 0 5 59 119 37 0 124 67 3 81 14 144 1 5 2 339 #> projected clustering = 0 15 1 0 669 0 0 0 0 0 0 315 0 0 0 0 #> ICP converged at EPOCH 1. #> Maximum ARI reached: 0.863646179451956. #>  #> Divisive ICP clustering completed successfully. #>  #> Predicting cell cluster probabilities using ICP models... #> Prediction of cell cluster probabilities completed successfully. #>  #> Multi-level integration completed successfully.  # Run PCA  set.seed(125) # to ensure reproducibility for the default 'irlba' method pbmc_10Xassays <- RunPCA(pbmc_10Xassays, p = 10) #> Divisive ICP: selecting ICP tables multiple of 4  # Plot features by cell type (give a clustering instead) genes <- c(\"CD8A\", \"CCR7\", \"GZMA\", \"MS4A1\", \"CD27\") VlnPlot(pbmc_10Xassays, clustering.label = \"cell_type\", features = genes, rotate.x.axis.labels = TRUE)"},{"path":"/reference/pbmc_10Xassays.html","id":null,"dir":"Reference","previous_headings":"","what":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"Two 10X PBMCs 3' assays, V1 V2, downsampled 2K cells (1K per assay).   datasets downloaded 10X website (see source ).  PBMC dataset V1 corresponds sample pbmc6k V2 pbmc8k. Cells   annotated using annotations provided Korsunsky et al., 2019 (PMID:31740819;  Source Data Figure 4 file).","code":""},{"path":"/reference/pbmc_10Xassays.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"","code":"data(pbmc_10Xassays) pbmc_10Xassays"},{"path":"/reference/pbmc_10Xassays.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"SCE object","code":""},{"path":"/reference/pbmc_10Xassays.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.1.0/pbmc6k https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc8k","code":""},{"path":"/reference/pbmc_10Xassays.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A toy SCE dataset of two 10X PBMCs 3' assays downsampled to 2K cells. — pbmc_10Xassays","text":"","code":"data(pbmc_10Xassays) pbmc_10Xassays #> class: SingleCellExperiment  #> dim: 2000 2000  #> metadata(0): #> assays(2): counts logcounts #> rownames(2000): LYZ S100A9 ... IGSF8 KIR2DL1 #> rowData names(8): highly_variable mean ... FDR per.block #> colnames(2000): ACATACCTGTCAAC ATTGAAACTCGTAG ... AGAGTGGCAGGGTTAG #>   GACTGCGAGCGTTCCG #> colData names(3): barcode batch cell_type #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):"}]
